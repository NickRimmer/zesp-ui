{"version":3,"sources":["loader.js","i18n sync /^.*$","data/controls sync /^/.//.*$","services/zesp/enums/CloseEventCodes.tsx","services/zesp/common/ZespConnector.tsx","shared/top-menu/index.tsx","store/slices/spinnerSlice.tsx","shared/loading-spinner/index.tsx","shared/fadein-transition/index.tsx","pages/devices/item-image.tsx","pages/devices/item.tsx","services/devices.tsx","services/zesp/common/Constants.tsx","services/zesp/common/ZespDataEvent.tsx","services/single.tsx","store/slices/devicesSlice.tsx","pages/devices/index.tsx","store/slices/settingsSlice.tsx","services/zesp/common/ZespResponseValidators.tsx","services/zesp/service-settings.tsx","pages/setup/index.tsx","pages/device-info/header.tsx","services/deviceControls.tsx","device-controls/root/OnOffRoot.tsx","device-controls/root/LevelRoot.tsx","services/localStorage.tsx","device-controls/root/RgbRoot.tsx","shared/transition/index.tsx","shared/transition/HighlightOnUpdate.tsx","device-controls/unknown.tsx","device-controls/sensors/IlluminanceSensor.tsx","device-controls/controls/LevelControl.tsx","device-controls/root/PlayerSrcRoot.tsx","device-controls/sensors/OnOffBinarySensor.tsx","device-controls/sensors/ValueSensor.tsx","device-controls/controls/OnOffToggle.tsx","device-controls/index.tsx","device-controls/layouts/DefaultLayout.tsx","device-controls/layouts/binary-sensor/index.tsx","device-controls/layouts/index.tsx","device-controls/layouts/ble-beacon/index.tsx","device-controls/layouts/binary-sensor/auto.tsx","device-controls/layouts/ble-beacon/auto.tsx","pages/device-info/body.tsx","pages/device-info/not-found.tsx","pages/device-info/index.tsx","shared/form/react-form/logic.tsx","shared/form/react-form/index.tsx","pages/socket-test/index.tsx","shared/form/input-group-horizontal.tsx","shared/form/checkbox-group-inline.tsx","pages/setup/mqtt.tsx","pages/setup/not-implemented-yet.tsx","pages/setup/wifi.tsx","store/slices/zespSlice.tsx","Routes.tsx","pages/welcome/part-items.tsx","pages/welcome/part-edit.tsx","pages/welcome/index.tsx","services/zesp/service-devices.tsx","services/zesp/service-report-updates.tsx","services/zesp/service-root.tsx","shared/agents/ZespAgent.tsx","App.tsx","reportWebVitals.ts","store/configure.tsx","index.tsx","i18n/config.js"],"names":["window","$","jQuery","require","console","debug","log","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","CloseEventCodes","_ws","_server","Result","t","useTranslation","className","to","process","spinnerSlice","createSlice","name","initialState","spinnerShow","reducers","setSpinnerShow","state","action","payload","getSpinnerShow","spinner","actions","LoadingSpinner","useSelector","Spinner","animation","variant","FadeIn","props","useState","setClassName","setTimeout","children","device","image","setImage","useEffect","testImage","Image","onerror","src","style","backgroundImage","detailsLink","ieee","title","tags","length","x","i","Devices","customLayout","buildLayoutSettingsFromZesp","reduce","r","groupName","group","find","push","settings","reportKey","deviceType","warn","endpoint","clusterId","attributeId","substr","zespInfo","Report","key","reportKeyInfo","DevType","registeredCluster","DataHaClusterIds","result","roleParts","role","split","buildLayoutItemForRole","attributes","IEEE","getLayoutItem","filter","undefined","dataCluster","roleName","roleSettings","layoutItem","zespRoleSettings","JSON","parse","ConnectionStartTimeout","VerifyConnectionTimeout","DefaultRequestTimeoutSeconds","ZespDataEventType","ZespDataEvent","dataType","dataParts","response","Event","_reconnecter","onMessageEvent","EventTarget","ZespConnector","connectAsync","server","zespConnectedAction","Promise","reject","reconnectAsync","then","Single","catch","error","Constants","setInterval","disconnect","clearInterval","underlyingWebsocket","readyState","close","force","Restart","protocol","document","location","WebsocketBuilder","address","onOpen","onClose","onError","onConnectionError","onMessage","onMessageReceived","build","send","args","data","isBinary","getBinaryData","requestAsync","timeoutSeconds","responseReceived","validator","responseValidator","listener","event","isValid","removeEventListener","addEventListener","request","onSuccess","errorMessage","subscribe","handler","zespEvent","unsubscribe","getServerAddress","ws","messageParts","replace","messageType","shift","exec","unshift","resultEvent","dispatchEvent","message","dataHex","replaceAll","match","parseInt","Uint8Array","ZespConnectorImplementation","devicesSlice","devices","setDevices","updateReport","update","updateRootReports","ModelId","getDeviceByIee","getAllDevices","DevicesList","devicesSorting","a","b","buildListItem","Name","getImageUrl","getTagsFromReports","serverAddress","Img","modelId","reports","reportKeyDetails","clusterInfo","HomeAutoClusters","indexOf","sort","deviceItems","Card","Body","zespSettings","settingsSlice","setSettings","getSettings","TypedZespResponseValidator","AllMessagesZespResponseValidator","jsonString","json","assign","parseResponse","stringify","join","toLocaleLowerCase","SaveSettings","dispatch","updatedSettings","ZespSettingsService","toast","success","reason","finally","useDispatch","alert","Container","Nav","Item","exact","marginTop","headerClassName","groups","headerContent","type","activeGroupName","onClick","setActiveGroupName","Modal","Header","onDetailsClicked","onCloseClicked","DeviceControls","config","deviceInfo","layoutId","OnOffRoot","report","Row","ButtonGroup","Button","val","toString","arguments","commandOn","commandOff","LevelRoot","currentValue","Number","max","min","value","setValue","minMaxAttributes","inRange","Math","FormControl","width","onChange","command","inputChangeHandler","target","FormRange","onMouseUp","useLocalStorage","initialValue","readValue","item","localStorage","getItem","storedValue","setStoredValue","handleStorageChange","newValue","Function","setItem","RgbRoot","g","color","setColor","colorPicker","setColorPicker","colorChangeHandler","rgb","rgbToXY","y","colorPickerButton","onChangeComplete","triangle","red","pow","green","blue","X","Y","Z","isNaN","toFixed","Transition","onRefresh","classNameFrom","onLoad","classNameTo","timeOutMs","HighlightOnUpdate","UnknownControl","showDetails","setShowDetails","configData","reportData","label","parsed","trim","units","preventDefault","href","NoReport","IlluminanceSensor","LevelControl","sendValueToZesp","formatCommand","Device","PlayerSrcRoot","srcReport","playSettings","playReport","setSrc","play","setPlay","list","placeholder","icon","OnOffBinarySensor","payloadOn","ValueSensor","unit","OnOffToggle","commandToggle","DeviceControlCol1","Col","md","DeviceControlCol2","DefaultLayout","controls","unknown","forEach","element","controlProps","getControlForDevice","showUnknown","setShowUnknown","reportKeysValue","reportKeysBattery","deviceClasses","batteryValuesRange","getValueSettings","onOffReport","getReport","iconClassName","icons","onFalse","valueClassName","valueTitle","statusValue","status","deviceClass","valueSettings","onTrue","styles","titles","getBatterySettings","stateClassName","valuePercents","valueString","valueNumber","round","oneOfKeys","layoutsAvailable","default","binarySensorLayout","battery","bleBeacon","isInRange","signalLevel","lastUpdateMs","time","lastDate","Date","calculateRelative","now","relative","setRelative","timer","lastUpdateStyle","rangeStyle","toLocaleDateString","toLocaleTimeString","autoDetectors","valueReportKey","layoutTools","binarySensorValueKeys","batteryReportKey","binarySensorBatteryKeys","roleDeviceClassIs","class","rangeReport","signalReport","autoDetect","layout","autoDetector","expectedDeviceClasses","reportDeviceClass","layoutProps","layoutName","LayoutElements","history","useHistory","useParams","show","setShow","keysA","keysB","handleClose","onHide","onExited","handleSubmit","input","prop","attr","ReactForm","onSubmit","restProps","Form","predefinedMessages","predefinedBinary","messages","_setMessages","messageSendValue","setMessageSendValue","paused","_setPaused","messagesRef","useRef","pausedRef","addMessages","current","cutCount","splice","onSendPredefined","innerText","onSendBinary","messageToSend","Footer","togglePause","startsWith","i2","controlId","defaultValue","inputProps","Group","as","Label","column","lg","Control","defaultChecked","checkedValue","uncheckedValue","defaultCheckedBool","checked_value","unchecked_value","Check","allSettings","MQTT","mqttup","mqtt","mqttPort","mqttLogin","mqttPassw","mqttEnable","Home_Assistant","rel","Wifi","ssid","pass","ip","mask","gw","zespSlice","connectionStatus","initialized","setConnected","setDisconnected","setInitialized","getStatus","zesp","getInitialized","Routes","isInitialized","path","component","DevicesPage","DeviceInfoPage","SetupPage","SetupWifiPage","SetupMqttPage","NotImplementedYetPage","SocketTestPage","sortedServers","servers","index","openServerAction","activeClassName","openEditAction","openAddServer","deleteConfirmed","setDeleteConfirmed","popover","Popover","dangerouslySetInnerHTML","__html","editServer","updateAction","addAction","closeAction","InputGroup","Text","OverlayTrigger","trigger","placement","overlay","rootClose","onToggle","deleteAction","WelcomePage","currentPart","setCurrentPart","setEditServer","setServers","backToWelcomeAction","setServerIndex","ServiceDevices","getDevicesListAsync","onDevicesListReceived","zespDevices","buildDeviceInfo","getDeviceModelSettings","predefinedDevices","modelIds","findIndex","control","onReport","onUpdate","EndPoint","ClusterId","AttribId","Data","extractReports","reportOnOff","on","reportLevel","level","reportRgb","B","G","R","volumeLevel","sound","volume","srcRadio","current_path","playControl","ZespAgent","ServiceRoot","ServiceUpdates","Content","serverIndex","serversString","selectedServer","App","reportWebVitals","onPerfEntry","getCLS","getFID","getFCP","getLCP","getTTFB","store","configureStore","reducer","zespReducer","devicesReducer","spinnerReducer","ReactDOM","render","StrictMode","getElementById","languages","namespaces","i18n","use","initReactI18next","init","fallbackLng","lng","resources","lang","ns","loadResources","defaultNS"],"mappings":"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","file":"static/js/main.33e19590.chunk.js","sourcesContent":["window.$ = window.jQuery = require('jquery')\n\nif (process.env.NODE_ENV !== \"development\") console.debug = () => {\n    // show info for dev environment only\n    console.log(\"Debug logs are disabled\");\n};","var map = {\n\t\"./config\": 98,\n\t\"./config.js\": 98,\n\t\"./locales/en/common\": 124,\n\t\"./locales/en/common.json\": 124,\n\t\"./locales/en/nav\": 125,\n\t\"./locales/en/nav.json\": 125,\n\t\"./locales/en/pages/devices\": 126,\n\t\"./locales/en/pages/devices.json\": 126,\n\t\"./locales/en/pages/setup-mqtt\": 127,\n\t\"./locales/en/pages/setup-mqtt.json\": 127,\n\t\"./locales/en/pages/setup-wifi\": 128,\n\t\"./locales/en/pages/setup-wifi.json\": 128,\n\t\"./locales/en/pages/welcome\": 129,\n\t\"./locales/en/pages/welcome.json\": 129\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 202;","var map = {\n\t\"./root\": 156,\n\t\"./root.json\": 156\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 342;","// https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent#status_codes\nexport enum CloseEventCodes {\n  Restart = 1012\n}","import {Websocket, WebsocketBuilder} from \"websocket-ts\";\nimport Constants from \"./Constants\";\nimport {ZespDataEvent, ZespDataEventType} from \"./ZespDataEvent\";\nimport {IZespConnector, ZespConnectedAction, ZespConnectorHandler, ZespConnectorListener} from \"../interfaces/IZespConnector\";\nimport {Single} from \"../../single\";\nimport {CloseEventCodes} from \"../enums/CloseEventCodes\";\nimport {IZespResponseValidator} from \"../interfaces/IZespResponseValidator\";\nimport {IServerInfo} from \"../../../pages/welcome/interfaces\";\n\n// const zespHost = \"192.168.3.30\"; //TODO read host from config\n\nlet _ws: Websocket;\nlet _server: IServerInfo | null;\nconst onMessageEvent = new EventTarget();\nlet _reconnecter: NodeJS.Timeout | null | undefined;\n\nconst ZespConnector: IZespConnector = {\n  connectAsync: (\n    server,\n    zespConnectedAction: ZespConnectedAction\n  ) => new Promise<IZespConnector>((resolve, reject) => {\n    if (_server) {\n      console.warn(\"ZespConnector already initialized\");\n      return;\n    }\n\n    _server = server;\n\n    // start with delay\n    setTimeout(() => ZespConnector.reconnectAsync(true, zespConnectedAction)\n        .then(() => {\n          resolve(Single.ZespConnector)\n        })\n        .catch(error => {\n          zespConnectedAction(false);\n          reject(error);\n        }),\n      Constants.ConnectionStartTimeout);\n\n    // setup watchdog\n    _reconnecter = setInterval(() => ZespConnector.reconnectAsync(false, zespConnectedAction)\n        // .then(() => resolve(Single.ZespConnector))\n        .catch(error => {\n          console.warn(`Reconnection is failed: ${error}`);\n          zespConnectedAction(false);\n          // reject(error);\n        }),\n      Constants.VerifyConnectionTimeout);\n  }),\n\n  disconnect: () => {\n    if (_reconnecter) {\n      clearInterval(_reconnecter);\n      _reconnecter = null;\n    }\n    _server = null;\n\n    try {\n      if (_ws?.underlyingWebsocket?.readyState === 3 || _ws?.underlyingWebsocket?.readyState == null) {\n        console.debug(\"zesp connection already closed\");\n        return;\n      } else if (_ws?.underlyingWebsocket?.readyState === 1) {\n        console.debug(\"zesp connection closing...\");\n        _ws.close(1000); // closed normal\n        return;\n      } else {\n        _ws?.close(1000); // closed normal\n      }\n    } catch {\n      //it's ok (;\n    }\n  },\n\n  reconnectAsync: (force, zespConnectedAction) => new Promise<void>((resolve, reject) => {\n    if (!_server) {\n      reject(\"Server configuration missed\");\n      // throw new Error(\"ZespConnector is not initialized yet\")\n    }\n\n    if (_ws?.underlyingWebsocket?.readyState === 0) {\n      reject(\"Already connecting\");\n      return;\n    }\n\n    // check if already connected\n    if (_ws?.underlyingWebsocket?.readyState === 1 && !force) {\n      resolve();\n      return;\n    }\n\n    // create new connection\n    console.debug(\"Start ws connection...\");\n    try {\n      _ws.close(CloseEventCodes.Restart);\n    } catch {\n      // it's ok :P\n    }\n\n    if (zespConnectedAction) zespConnectedAction(false);\n    const protocol = document.location.protocol === \"https:\" ? \"wss\" : \"ws\";\n    _ws = new WebsocketBuilder(`${protocol}://${_server!.address}:81`)\n      .onOpen(() => {\n        if (zespConnectedAction) {\n          console.debug(\"ZESP connected\");\n          zespConnectedAction(true);\n        }\n        resolve();\n      })\n      .onClose(() => {\n        console.debug(\"ZESP connection closed\");\n        zespConnectedAction && zespConnectedAction(false)\n      })\n      .onError(() => {\n        onConnectionError();\n        reject(\"ZESP connection error\")\n      })\n      .onMessage(onMessageReceived)\n      .build();\n  }),\n\n  send: (args) => {\n    if (!_ws) {\n      console.error(\"ZespConnector.send: WebSocket client is not initialized yet\");\n      return;\n    }\n\n    const data = args.isBinary === true\n      ? getBinaryData(args.data)\n      : args.data;\n\n    _ws.send(data);\n  },\n\n  requestAsync: (args) => new Promise<ZespDataEvent>(((resolve, reject) => {\n    if (!args.timeoutSeconds || args.timeoutSeconds <= 0) args.timeoutSeconds = Constants.DefaultRequestTimeoutSeconds;\n    if (args.isBinary !== true) args.isBinary = false;\n\n    let responseReceived = false;\n    const validator = args.responseValidator;\n\n    // on response received from zesp\n    const listener = (event: Event) => {\n      const result = event as ZespDataEvent;\n      if (!validator.isValid(result)) return;\n\n      responseReceived = true;\n      onMessageEvent.removeEventListener(ZespDataEventType, listener);\n      resolve(result);\n    }\n\n    // if no response for a specific time (timeout)\n    const onTimeout = () => {\n      if (responseReceived) return;\n\n      onMessageEvent.removeEventListener(ZespDataEventType, listener);\n      console.warn(`zesp response did not received (timeout: ${args.timeoutSeconds} seconds)`);\n      reject(\"timeout\");\n    };\n\n    // send request\n    try {\n      onMessageEvent.addEventListener(ZespDataEventType, listener);\n      ZespConnector.send({data: args.data, isBinary: args.isBinary})\n      setTimeout(onTimeout, args.timeoutSeconds * 1000);\n    } catch (error) {\n      reject(`exception: ${error}`);\n    }\n  })),\n\n  request: (args) => new Promise<IZespConnector>((resolve, reject) => {\n    ZespConnector\n      .requestAsync(args)\n      .then(event => {\n        if (args.onSuccess) args.onSuccess(event);\n        else console.debug(`zesp request completed (${args.responseValidator.name})`);\n\n        resolve(Single.ZespConnector);\n      })\n      .catch(error => {\n        const errorMessage = `${error} (${args.responseValidator.name}; ${args.data})`;\n\n        if (args.onError) args.onError(errorMessage);\n        else console.warn(`zesp request failed: ${errorMessage}`);\n        reject(errorMessage);\n      });\n  }),\n\n  subscribe: (validator: IZespResponseValidator, handler: ZespConnectorHandler): ZespConnectorListener => {\n    const listener = (event: Event): void => {\n      const zespEvent = event as ZespDataEvent;\n      if (!validator.isValid(zespEvent)) return;\n\n      handler(zespEvent);\n    }\n\n    onMessageEvent.addEventListener(ZespDataEventType, listener)\n    return listener;\n  },\n\n  unsubscribe: (listener: ZespConnectorListener) => onMessageEvent.removeEventListener(ZespDataEventType, listener),\n\n  getServerAddress: () => _server?.address\n};\n\nconst onConnectionError = () => {\n  console.debug(\"Zesp connection error happened )=\");\n}\n\nconst onMessageReceived = (ws: Websocket, e: MessageEvent) => {\n  const messageParts = e.data\n    .replace(/\\|(?=([^\"]*\"[^\"]*\")*[^\"]*$)/ig, \"\\x00\")\n    .split(\"\\x00\");\n\n  if (messageParts.length == 0) {\n    console.warn(\"Received empty message from zesp\");\n    return;\n  }\n\n  let messageType = messageParts.shift();\n\n  const jsonMatch = /\\/(.+)\\.json/ig.exec(messageType);\n  if (jsonMatch) {\n    messageParts.unshift(messageType);\n    messageType = \"json\";\n  }\n\n  const resultEvent = new ZespDataEvent(messageType, messageParts, e.data);\n  // console.debug(resultEvent);\n  onMessageEvent.dispatchEvent(resultEvent);\n}\n\nconst getBinaryData = (message: string): Uint8Array => {\n  const data = message.replaceAll(\" \", \"\");\n  const dataHex = data.match(/[\\da-f]{2}/gi)?.map(group => parseInt(group, 16)) as ArrayLike<number>;\n  return new Uint8Array(dataHex);\n}\n\nexport default ZespConnector;\n","import React from 'react';\nimport {useTranslation} from \"react-i18next\";\nimport {NavLink} from \"react-router-dom\";\n\nimport './styles.scss'\n\nconst Result = () => {\n  const {t} = useTranslation(\"nav\");\n\n  return (\n    <nav className=\"nav nav-masthead justify-content-center\">\n      {/*<NavLink className=\"nav-link\" to=\"/\" exact={true}>{t('home')}</NavLink>*/}\n      <NavLink className=\"nav-link\" to=\"/devices\">{t('devices')}</NavLink>\n      {process.env.NODE_ENV === \"development\" && (\n        <NavLink className=\"nav-link\" to=\"/socket-test\" exact={true}>Test WS</NavLink>\n      )}\n      <NavLink className=\"nav-link\" to=\"/setup\">{t('setup')}</NavLink>\n    </nav>\n  );\n};\n\nexport default Result;","import {createSlice, PayloadAction} from \"@reduxjs/toolkit\";\nimport {RootState} from \"../configure\";\n\ninterface IState {\n  spinnerShow: boolean\n}\n\nconst initialState: IState = {\n  spinnerShow: false,\n}\n\nexport const spinnerSlice = createSlice({\n  name: \"spinner\",\n  initialState,\n  reducers: {\n    setSpinnerShow: (state, action: PayloadAction<boolean>): void => {\n      state.spinnerShow = action.payload;\n    }\n  }\n});\n\nconst getters = {\n  getSpinnerShow: (state: RootState) => state.spinner.spinnerShow\n}\n\nexport const {getSpinnerShow} = getters;\nexport const {setSpinnerShow} = spinnerSlice.actions;\nexport default spinnerSlice.reducer;\n","import React from \"react\";\nimport \"./styles.scss\"\nimport {Spinner} from \"react-bootstrap\";\nimport {useSelector} from \"react-redux\";\nimport {getSpinnerShow} from \"../../store/slices/spinnerSlice\";\n\nconst LoadingSpinner = () => {\n  const spinnerShow = useSelector(getSpinnerShow);\n  return (\n    <div className={`loading-overlay ${spinnerShow ? \"show\" : \"hidden\"}`}>\n      <Spinner animation=\"border\" variant=\"light\"/>\n    </div>\n  );\n}\n\nexport default LoadingSpinner;","import {FunctionComponent, useState} from \"react\";\nimport \"./styles.scss\";\n\nexport const FadeIn: FunctionComponent = (props) => {\n  const [className, setClassName] = useState(\"show-transition hidden\");\n  setTimeout(() => setClassName(\"show-transition\"), 0);\n\n  return (\n    <div className={className}>\n      {props.children}\n    </div>\n  )\n}","import React, {useEffect, useState} from \"react\";\nimport {DeviceListItem} from \"../../models/DeviceListItem\";\n\ninterface IProps {\n  device: DeviceListItem\n}\n\nconst defaultImage = \"/device-images/default.png\";\n\nexport default (props: IProps) => {\n  const [image, setImage] = useState(props.device.image);\n\n  useEffect(() => {\n    const testImage = new Image();\n    testImage.onerror = () => {\n      setImage(defaultImage);\n    }\n    testImage.src = image;\n  }, []);\n\n  return (<div className=\"item-image\" style={{backgroundImage: `url(${image})`}}/>);\n}","import React from \"react\";\nimport ItemImage from \"./item-image\";\nimport {NavLink} from \"react-router-dom\";\nimport {DeviceListItem} from \"../../models/DeviceListItem\";\n\ninterface IProps {\n  device: DeviceListItem\n}\n\nexport default (props: IProps) => {\n  const {device} = props;\n  const detailsLink = `/devices/${device.ieee}`;\n\n  return (\n    <NavLink className=\"item p-3 border rounded\" to={detailsLink}>\n      <div className=\"d-flex\">\n        <div><ItemImage device={props.device}/></div>\n        <div className=\"ps-2\">\n          <div className=\"title\">{device.title}</div>\n          <div className=\"ieee text-muted small\">{device.ieee}</div>\n          {device.tags.length > 0 && (\n            <div className=\"badges small\">\n              {device.tags.map((x, i) => (<span key={i} className=\"badge bg-secondary\">{x}</span>))}\n            </div>\n          )}\n        </div>\n      </div>\n    </NavLink>\n  );\n}","import {DataControlSettings, DataLayoutItemsGroup} from \"../models/DataControlSettings\";\nimport {DataReportInfo} from \"../models/DataReportInfo\";\nimport DataHaClusterIds from \"../data/reports.json\";\nimport {DeviceInfo} from \"../models/DeviceInfo\";\nimport {ReportKeyInfo} from \"../models/ReportKeyInfo\";\n\nconst defaultLayoutGroupName = \"main\";\n\nexport const Devices = {\n  getControlGroups: (device: DeviceInfo): DataLayoutItemsGroup[] => {\n    const layout = device.customLayout && device.customLayout.length > 0\n      ? device.customLayout\n      : buildLayoutSettingsFromZesp(device);\n\n    // group by group name (undefined groups will be saved as 'main')\n    return layout.reduce((r, x) => {\n      const groupName = x.group || defaultLayoutGroupName;\n      let group = r.find(x => x.name === groupName);\n      if (!group) {\n        group = {name: groupName} as DataLayoutItemsGroup;\n        r.push(group);\n      }\n\n      group.settings = [...group.settings || [], x];\n\n      return r;\n    }, [] as DataLayoutItemsGroup[]);\n  },\n\n  getReportKeyDetails: (reportKey: string, deviceType: string): ReportKeyInfo | undefined => {\n    if (!deviceType || deviceType === \"ZED\" || deviceType === \"ZR\") {\n      if (reportKey?.length !== 10) // 01 0000 0000\n      {\n        console.warn(`Unknown format of Zigbee report key: '${reportKey}'`);\n        return undefined;\n      }\n\n      return {\n        endpoint: reportKey.substr(0, 2),\n        clusterId: reportKey.substr(2, 4),\n        attributeId: reportKey.substr(6),\n      }\n    }\n\n    if (deviceType === \"BED\") {\n      if (reportKey?.length < 1) // a-ny-thing\n      {\n        console.warn(`Unknown format of BLE report key: '${reportKey}'`);\n        return undefined;\n      }\n\n      return {\n        endpoint: \"\",\n        clusterId: reportKey,\n        attributeId: \"\",\n      }\n    }\n\n    console.warn(`Unknown device type '${deviceType}'`);\n    return undefined;\n  },\n}\n\nconst buildLayoutSettingsFromZesp = (device: DeviceInfo): DataControlSettings[] => {\n  const getLayoutItem = (reportKey: string): DataControlSettings | undefined => {\n    const reportKeyInfo = Devices.getReportKeyDetails(reportKey, device.zespInfo.DevType);\n    if (!reportKeyInfo) {\n      console.warn(`Cannot get report key details for '${device.zespInfo.IEEE}' device`);\n      return undefined;\n    }\n\n    const registeredCluster = (DataHaClusterIds as DataReportInfo[]).find(x => x.clusterId == reportKeyInfo.clusterId);\n\n    const result = {\n      id: reportKeyInfo.clusterId,\n      reportKey: reportKeyInfo\n    } as DataControlSettings;\n\n    // if cluster information not found\n    if (!registeredCluster) {\n      console.debug(`Report key '${reportKey}' with unregistered cluster '${reportKeyInfo.clusterId}' received`);\n      return result;\n    }\n\n    // build layout based on role\n    const report = device.zespInfo.Report[reportKey];\n    const roleParts = report.role?.split(\"&\");\n    if (roleParts && roleParts.length > 0)\n      return {...result, ...buildLayoutItemForRole(roleParts, registeredCluster, reportKey, device.zespInfo.DevType)};\n\n    // otherwise build layout based on cluster\n    const attributeInfo = registeredCluster.attributes && registeredCluster.attributes[reportKeyInfo.attributeId];\n    if (!attributeInfo) return result;\n\n    return attributeInfo;\n  }\n\n  const reportKeys = Object.keys(device.zespInfo.Report);\n  return reportKeys.map(key => getLayoutItem(key)).filter(x => x !== undefined) as DataControlSettings[];\n}\n\nconst buildLayoutItemForRole = (roleParts: string[], dataCluster: DataReportInfo, reportKey: string, deviceType: string): DataControlSettings | undefined => {\n  // return undefined;\n  const reportKeyInfo = Devices.getReportKeyDetails(reportKey, deviceType);\n  if (!reportKeyInfo) return undefined;\n\n  const roleName = roleParts[0];\n  const roleSettings = roleParts.length > 1 ? roleParts[1] : null;\n  const layoutItem = !dataCluster.attributes\n    ? {id: roleName} as DataControlSettings // if no attributes at all\n    : dataCluster.attributes[`${reportKeyInfo.attributeId}:${roleName}`]\n    || dataCluster.attributes[roleName]\n    || {id: roleName} as DataControlSettings; // if required attribute not found\n\n  // add role configured settings\n  if (roleSettings)\n    layoutItem.zespRoleSettings = JSON.parse(roleSettings);\n\n  return layoutItem;\n}","const Result = {\n  // delay before connection start\n  ConnectionStartTimeout: 100,\n\n  // connection verify interval\n  VerifyConnectionTimeout: 5000,\n\n  // default timeout for requests in seconds \n  DefaultRequestTimeoutSeconds: 5,\n}\n\nexport default Result;","export const ZespDataEventType = \"zesp-data-received\";\n\nexport class ZespDataEvent extends Event {\n  readonly dataType: string;\n  readonly response: string;\n  readonly dataParts: string[];\n\n  constructor(dataType: string, dataParts: string[], response: string) {\n    super(ZespDataEventType);\n\n    this.dataType = dataType;\n    this.dataParts = dataParts;\n    this.response = response;\n  }\n}","import {IZespConnector} from \"./zesp/interfaces/IZespConnector\";\nimport ZespConnectorImplementation from \"./zesp/common/ZespConnector\";\n\nexport namespace Single {\n  export const ZespConnector: IZespConnector = ZespConnectorImplementation;\n  export const ZespConnectorPromise: Promise<IZespConnector> = new Promise<IZespConnector>(resolve => resolve(Single.ZespConnector));\n}","import {createSlice, PayloadAction} from \"@reduxjs/toolkit\";\nimport {DeviceInfo} from \"../../models/DeviceInfo\";\nimport {RootState} from \"../configure\";\nimport {ZespReportInfo} from \"../../services/zesp/models/ZespReportInfo\";\nimport {ZespReportUpdates} from \"../../services/zesp/service-root\";\n\nexport interface DevicesState {\n  devices: DeviceInfo[]\n}\n\nconst initialState: DevicesState = {\n  devices: []\n}\n\nexport const devicesSlice = createSlice({\n  name: \"devices\",\n  initialState,\n  reducers: {\n    setDevices: (state, action: PayloadAction<DeviceInfo[]>): void => {\n      state.devices = action.payload;\n    },\n    updateReport: (state, action: PayloadAction<{ ieee: string, reportKey: string, update: Partial<ZespReportInfo> }>): void => {\n      const device = state.devices.find(x => x.zespInfo.IEEE === action.payload.ieee);\n      if (!device) {\n        console.warn(`Device '${action.payload.ieee}' not found to update`);\n        return;\n      }\n\n      device.zespInfo.Report[action.payload.reportKey] = {...device.zespInfo.Report[action.payload.reportKey], ...action.payload.update};\n      console.debug(`Device '${action.payload.ieee}' with report '${action.payload.reportKey}' has been updated`);\n    },\n    updateRootReports: (state, action: PayloadAction<ZespReportUpdates>) => {\n      const device = state.devices.find(x => x.zespInfo.ModelId === \"ZESP_Root\");\n      if (!device) {\n        console.warn(`Root device not found to update`);\n        return;\n      }\n\n      device.zespInfo.Report = {...device.zespInfo.Report, ...action.payload} as { [reportId: string]: ZespReportInfo };\n    }\n  }\n})\n\nconst getters = {\n  getDeviceByIee: (state: RootState, ieee: string): DeviceInfo | undefined => state.devices.devices.find(x => x.zespInfo.IEEE === ieee),\n  getDevicesByModelId: (state: RootState, modelId: string): DeviceInfo[] => state.devices.devices.filter(x => x.zespInfo.ModelId === modelId),\n  getAllDevices: (state: RootState): DeviceInfo[] => state.devices.devices || [] as DeviceInfo[],\n}\n\nexport const {getDevicesByModelId, getDeviceByIee, getAllDevices} = getters;\nexport const {setDevices, updateReport, updateRootReports} = devicesSlice.actions;\nexport default devicesSlice.reducer;\n","import React from \"react\";\nimport \"./styles.scss\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {Card} from \"react-bootstrap\";\nimport Item from \"./item\";\nimport {useTranslation} from \"react-i18next\";\nimport {DeviceInfo} from \"../../models/DeviceInfo\";\nimport {DeviceListItem} from \"../../models/DeviceListItem\";\nimport HomeAutoClusters from \"../../data/reports.json\";\nimport {DataReportInfo} from \"../../models/DataReportInfo\";\nimport {Devices} from \"../../services/devices\";\nimport {ZespReportInfo} from \"../../services/zesp/models/ZespReportInfo\";\nimport {Single} from \"../../services/single\";\nimport {getAllDevices} from \"../../store/slices/devicesSlice\";\nimport {useSelector} from \"react-redux\";\n\nconst Result = () => {\n  const devices = useSelector(getAllDevices, (a: DeviceInfo[], b: DeviceInfo[]) => a.length === b.length);\n  if (devices.length == 0) return (\n    <div>No devices found...</div>\n  )\n\n  console.debug(\"Building list of devices to show...\");\n  const deviceItems = [...devices]\n    .sort(devicesSorting)\n    .map(buildListItem);\n\n  console.debug(\"devices page updated...\");\n  return (\n    <FadeIn>\n      <div className=\"devices\">\n        <Card>\n          <Card.Body>\n            <DevicesList devices={deviceItems}/>\n          </Card.Body>\n        </Card>\n      </div>\n    </FadeIn>\n  );\n}\n\nconst DevicesList = (props: { devices: DeviceListItem[] }) => {\n  const {t} = useTranslation(\"pages.devices\");\n  const {devices} = props;\n\n  return (\n    <div className=\"group border-top pt-4\">\n      <div className=\"title h5 pb-3\">\n        <span>{t(\"groups.all\")}</span>\n        {devices.length > 1 && (<span className=\"badge bg-secondary ms-2\">{devices.length}</span>)}\n      </div>\n      <div className=\"items d-flex flex-wrap\">\n        {devices.map((device, i) => (<Item device={device} key={i}/>))}\n      </div>\n    </div>\n  );\n}\n\nconst devicesSorting = (a: DeviceInfo, b: DeviceInfo): number => {\n  if (a.zespInfo.ModelId === \"ZESP_Root\") return -1;\n  if (b.zespInfo.ModelId === \"ZESP_Root\") return 1;\n\n  if (a.zespInfo.ModelId < b.zespInfo.ModelId) return -1;\n  if (a.zespInfo.ModelId > b.zespInfo.ModelId) return 1;\n\n  return 0;\n}\n\nconst buildListItem = (device: DeviceInfo): DeviceListItem => {\n  const title = device.zespInfo.Name && device.zespInfo.Name.length > 0 ? device.zespInfo.Name : device.zespInfo.ModelId;\n  const image = getImageUrl(device);\n  const tags = getTagsFromReports(device.zespInfo.Report, device.zespInfo.DevType);\n\n  return {\n    title,\n    ieee: device.zespInfo.IEEE,\n    image,\n    tags\n  };\n}\n\nconst getImageUrl = (device: DeviceInfo): string => {\n  // device.settings?.image || device.zespInfo.Img\n  if (device.settings?.image)\n    return `${process.env.PUBLIC_URL}/device-images/${device.settings.image}`;\n\n  const serverAddress = Single.ZespConnector.getServerAddress();\n  if (device.zespInfo.Img)\n    return `http://${serverAddress}:8081/${device.zespInfo.Img}`\n\n  const modelId = device.zespInfo.ModelId;\n  return `http://${serverAddress}:8081/img/${modelId}.jpg`;\n}\n\nconst getTagsFromReports = (reports: { [key: string]: ZespReportInfo }, deviceType: string): string[] => {\n  const result: string[] = [];\n\n  for (const key of Object.keys(reports)) {\n    const reportKeyDetails = Devices.getReportKeyDetails(key, deviceType);\n\n    if (!reportKeyDetails) {\n      console.warn(`Cannot read report '${key}' details for '${deviceType}' device type`);\n      continue;\n    }\n\n    const clusterInfo = HomeAutoClusters.find(x => x.clusterId === reportKeyDetails.clusterId) as DataReportInfo | undefined\n    result.push(clusterInfo?.name || reportKeyDetails.clusterId);\n  }\n\n  return result\n    .filter((x, i) => result.indexOf(x) == i)\n    .sort((a, b) => a > b ? 1 : -1);\n}\n\nexport default Result;\n","import {createSlice, PayloadAction} from \"@reduxjs/toolkit\";\nimport {RootState} from \"../configure\";\nimport {ZespSettings} from \"../../services/zesp/models/ZespSettings\";\n\ninterface IState {\n  zespSettings: ZespSettings | undefined\n}\n\nconst initialState: IState = {\n  zespSettings: undefined\n}\n\nexport const settingsSlice = createSlice({\n  name: \"settings\",\n  initialState,\n  reducers: {\n    setSettings: (state, action: PayloadAction<ZespSettings>): void => {\n      state.zespSettings = action.payload;\n    }\n  }\n});\n\nconst getters = {\n  getSettings: (state: RootState) => state.settings.zespSettings\n}\n\nexport const {getSettings} = getters;\nexport const {setSettings} = settingsSlice.actions;\nexport default settingsSlice.reducer;\n","import {ZespDataEvent} from \"./ZespDataEvent\";\nimport {IZespResponseValidator} from \"../interfaces/IZespResponseValidator\";\n\nexport const JsonZespResponseValidator = (fileName: string): IZespResponseValidator => ({\n  name: JsonZespResponseValidator.name,\n  isValid: (event: ZespDataEvent) => {\n    if (event.dataType !== \"json\") return false;\n    const responseFileName = event.dataParts[0];\n    const foundFileName = (/\\/(.+)\\.json/ig.exec(responseFileName) as string[])[1];\n\n    return foundFileName === fileName;\n  }\n});\n\nexport const TypedZespResponseValidator = (dataType: string): IZespResponseValidator => ({\n  name: TypedZespResponseValidator.name,\n  isValid: (event: ZespDataEvent) => event.dataType === dataType\n});\n\nexport const AllMessagesZespResponseValidator: IZespResponseValidator = ({\n  name: \"AllZespResponseValidator\",\n  isValid: (event => true)\n});","import {ZespSettings} from \"./models/ZespSettings\";\nimport {Single} from \"../single\";\nimport {TypedZespResponseValidator} from \"./common/ZespResponseValidators\";\n\nexport default {\n  getAsync: (): Promise<ZespSettings> => new Promise<ZespSettings>((resolve, reject) => {\n    Single.ZespConnector.requestAsync({data: \"loadConfig\", responseValidator: TypedZespResponseValidator(\"jsconfig\")})\n      .then(event => parseResponse(event.dataParts[0]))\n      .then(settings => resolve(settings))\n      .catch(error => reject(error));\n  }),\n\n  setAsync: (settings: ZespSettings): Promise<void> => {\n    const data = [\n      \"SaveJson\",\n      \"/jsconfig.txt\",\n      JSON.stringify(settings)\n    ].join(\"|\");\n\n    return new Promise((resolve, reject) => {\n      Single.ZespConnector.requestAsync({data: data, responseValidator: TypedZespResponseValidator(\"ZD_RSP\")})\n        .then(event => {\n          // console.log(event);\n          if (event.dataParts[1].toLocaleLowerCase() === \"ok\") resolve();\n          else reject(`Settings was not saved: ${event.response}`)\n        })\n        .catch(error => reject(error));\n    })\n  }\n}\n\nfunction parseResponse(jsonString: string): ZespSettings {\n  const json = JSON.parse(jsonString);\n  const result = {} as ZespSettings;\n  Object.assign(result, json);\n\n  return result;\n}\n","import React, {Fragment, useEffect} from \"react\";\nimport {Container, Nav} from \"react-bootstrap\";\nimport {NavLink} from \"react-router-dom\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {ZespSettings} from \"../../services/zesp/models/ZespSettings\";\nimport toast from \"react-hot-toast\";\nimport {BsGearFill} from \"react-icons/bs\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {setSpinnerShow} from \"../../store/slices/spinnerSlice\"\nimport {setSettings, getSettings} from \"../../store/slices/settingsSlice\"\nimport ZespSettingsService from \"../../services/zesp/service-settings\";\nimport {Dispatch} from \"@reduxjs/toolkit\";\n\nconst Result = () => {\n  const dispatch = useDispatch();\n  const settings = useSelector(getSettings);\n\n  useEffect(() => {\n    dispatch(setSpinnerShow(true));\n\n    ZespSettingsService.getAsync()\n      .then(data => {\n        dispatch(setSettings(data));\n      })\n      .catch(error => {\n        //TODO show error window\n        alert(error);\n      })\n      .finally(() => dispatch(setSpinnerShow(false)));\n  }, []);\n\n  if (!settings) return (<Fragment/>);\n\n  return (\n    <FadeIn>\n      <div className=\"aaa\">...</div>\n      <Container className=\"p-0\">\n        <Nav variant=\"pills\">\n          <Nav.Item><NavLink className=\"nav-link\" to=\"/setup\" exact>Wifi client</NavLink></Nav.Item>\n          <Nav.Item><NavLink className=\"nav-link\" to=\"/setup/zigbee\">Zigbee</NavLink></Nav.Item>\n          <Nav.Item><NavLink className=\"nav-link\" to=\"/setup/mqtt\">MQTT client</NavLink></Nav.Item>\n          <Nav.Item><NavLink className=\"nav-link\" to=\"/setup/telegram\">Telegram bot</NavLink></Nav.Item>\n          <Nav.Item><NavLink className=\"nav-link\" to=\"/setup/z2m\">Z2M client</NavLink></Nav.Item>\n          <Nav.Item className=\"ms-auto\"><NavLink className=\"nav-link\" to=\"/setup/zesp-ui\"><BsGearFill style={{marginTop: \"-3px\"}}/> ZESP:UI</NavLink></Nav.Item>\n        </Nav>\n      </Container>\n    </FadeIn>\n  );\n}\n\nexport const SaveSettings = (data: Partial<ZespSettings>, settings: ZespSettings | undefined, dispatch: Dispatch) => new Promise<void>((resolve, reject) => {\n  if (!settings) reject(\"Settings not loaded\");\n  dispatch(setSpinnerShow(true));\n\n  const updatedSettings: ZespSettings = ({...settings, ...data}) as ZespSettings;\n  ZespSettingsService\n    .setAsync(updatedSettings)\n    .then(() => {\n      dispatch(setSettings(updatedSettings));\n      resolve();\n      toast.success(\"Settings updated\");\n    })\n    .catch(reason => {\n      toast.error(`Cannot save: ${reason}`);\n      reject(reason);\n    })\n    .finally(() => dispatch(setSpinnerShow(false)));\n})\n\nexport default Result;\n","import {DataLayoutItemsGroup} from \"../../models/DataControlSettings\";\nimport {Modal} from \"react-bootstrap\";\nimport React from \"react\";\nimport {DeviceInfo} from \"../../models/DeviceInfo\";\n\nexport default (props: {\n  device: DeviceInfo,\n  groups: DataLayoutItemsGroup[],\n  activeGroupName: string,\n  setActiveGroupName: (group: string) => void,\n  onCloseClicked: () => void,\n  onDetailsClicked?: () => void,\n}) => {\n  const title = props.device.zespInfo.Name || props.device.zespInfo.ModelId;\n\n  const buildMultiply = () => (\n    <ul className=\"nav nav-tabs\">\n      {props.groups.map((group, i) =>\n        (\n          <li className=\"nav-item\" key={i}>\n            <button\n              type=\"button\"\n              className={`btn btn-light nav-link ${props.activeGroupName === group.name ? \"active\" : \"\"}`}\n              onClick={() => props.setActiveGroupName(group.name)}>\n              {group.name === \"main\" ? title : group.name}\n            </button>\n          </li>\n        )\n      )}\n    </ul>\n  )\n\n  const buildSingle = () => (<div>{title}</div>);\n\n  const headerClassName = props.groups.length > 1 ? \"with-tabs\" : \"\";\n  const headerContent = props.groups.length > 1 ? buildMultiply() : buildSingle();\n\n  return (\n    <Modal.Header className={headerClassName}>\n      <div>{headerContent}</div>\n      <div className=\"text-end modal-right-buttons\">\n        {props.onDetailsClicked && (<button type=\"button\" className=\"btn\" onClick={props.onDetailsClicked}><i className=\"bi bi-three-dots-vertical\"/></button>)}\n        <span className=\"border-end ms-2 me-3\"/>\n        <button type=\"button\" className=\"btn-close me-1\" aria-label=\"Close\" onClick={props.onCloseClicked}/>\n      </div>\n    </Modal.Header>\n  )\n}","import {IDeviceControlProps} from \"../interfaces/IDeviceControlProps\";\nimport {DataControlSettings} from \"../models/DataControlSettings\";\nimport {ZespReportInfo} from \"./zesp/models/ZespReportInfo\";\n\nexport const DeviceControls = {\n  getControlReport: (props: IDeviceControlProps<DataControlSettings>): ZespReportInfo | null => {\n    if (!props.config.reportKey) {\n      console.debug(`No report key in config found for ${props.deviceInfo.zespInfo.IEEE} device and ${props.config.id} control`);\n      return null;\n    }\n    const reportKey = props.config.reportKey.endpoint + props.config.reportKey.clusterId + props.config.reportKey.attributeId;\n    return props.deviceInfo.zespInfo.Report[reportKey];\n  },\n\n  getControlSettings: function <T extends DataControlSettings>(props: IDeviceControlProps<DataControlSettings>, layoutId: string): [T | undefined, ZespReportInfo | undefined] {\n    const settings = props.deviceInfo.customLayout?.find(x => x.id === layoutId) as T;\n    const report = settings && settings.reportKey\n      ? props.deviceInfo.zespInfo.Report[settings.reportKey.endpoint + settings.reportKey.clusterId + settings.reportKey.attributeId]\n      : undefined;\n\n    return [settings, report];\n  },\n}\n","import React from \"react\";\nimport {Button, ButtonGroup, Row} from \"react-bootstrap\";\nimport {LayoutSettingsOnOff} from \"../settings\";\nimport {IDeviceControlProps} from \"../../interfaces/IDeviceControlProps\";\nimport {Single} from \"../../services/single\";\nimport {DeviceControls} from \"../../services/deviceControls\";\nimport {DeviceControlCol1, DeviceControlCol2} from \"../index\";\n\nexport const OnOffRoot = (props: IDeviceControlProps<LayoutSettingsOnOff>) => {\n  const report = DeviceControls.getControlReport(props);\n\n  const onHandler = () => {\n    Single.ZespConnector.send({data: props.config.arguments.commandOn, isBinary: true});\n  };\n\n  const offHandler = () => {\n    Single.ZespConnector.send({data: props.config.arguments.commandOff, isBinary: true});\n  };\n\n  return (\n    <Row>\n      <DeviceControlCol1>Light power:</DeviceControlCol1>\n      <DeviceControlCol2>\n        <ButtonGroup>\n          <Button variant={report?.val.toString() === \"1\" ? \"primary\" : \"secondary\"} onClick={onHandler}>ON</Button>\n          <Button variant={report?.val.toString() === \"1\" ? \"secondary\" : \"primary\"} onClick={offHandler}>OFF</Button>\n        </ButtonGroup>\n      </DeviceControlCol2>\n    </Row>\n  )\n}\n","import React, {useState} from \"react\";\nimport {FormControl, Row} from \"react-bootstrap\";\nimport FormRange from \"react-bootstrap/FormRange\";\nimport {LayoutSettingsLevel} from \"../settings\";\nimport {IDeviceControlProps} from \"../../interfaces/IDeviceControlProps\";\nimport {Single} from \"../../services/single\";\nimport {DeviceControls} from \"../../services/deviceControls\";\nimport {DeviceControlCol1, DeviceControlCol2} from \"../index\";\n\n// TODO add localization\nexport const LevelRoot = (props: IDeviceControlProps<LayoutSettingsLevel>) => {\n  const report = DeviceControls.getControlReport(props);\n  const currentValue = report?.val ? Number(report.val) : ((props.config.arguments.max - props.config.arguments.min) / 2 + props.config.arguments.min);\n  const [value, setValue] = useState(currentValue);\n\n  const minMaxAttributes = {\n    min: props.config.arguments.min,\n    max: props.config.arguments.max\n  };\n\n  const inRange = (value: number) => Math.max(Math.min(props.config.arguments.max, value), props.config.arguments.min);\n\n  // const setCurrentValue = (value: number) => DeviceControls.setControlReport(globalState, props, value.toString());\n\n  const sliderChangeHandler = () => {\n    const result = inRange(value);\n    const data = props.config.arguments.command.replace(\"{value}\", result.toString(16));\n    Single.ZespConnector.send({data: data});\n    // setCurrentValue(result);\n  }\n\n  const inputChangeHandler = (value: number) => {\n    const result = inRange(value);\n    setValue(result);\n    const data = props.config.arguments.command.replace(\"{value}\", result.toString(16));\n    Single.ZespConnector.send({data: data});\n    // setCurrentValue(result);\n  }\n\n  return (\n    <Row>\n      <DeviceControlCol1>Level:</DeviceControlCol1>\n      <DeviceControlCol2>\n        <FormControl\n          style={{width: \"80px\"}}\n          className=\"me-2\"\n          type=\"number\"\n          value={value}\n          onChange={event => inputChangeHandler(Number(event.target.value))}\n          {...minMaxAttributes}\n        />\n\n        <FormRange\n          value={value}\n          onChange={event => setValue(Number(event.target.value))}\n          onMouseUp={sliderChangeHandler}\n          {...minMaxAttributes}\n        />\n      </DeviceControlCol2>\n    </Row>\n  )\n}\n","// Copy-pasted from here: https://usehooks-typescript.com/react-hook/use-local-storage\n\nimport {Dispatch, SetStateAction, useEffect, useState} from 'react'\n\ntype SetValue<T> = Dispatch<SetStateAction<T>>\n\nexport function useLocalStorage<T>(key: string, initialValue: T): [T, SetValue<T>] {\n  // Get from local storage then\n  // parse stored json or return initialValue\n  const readValue = (): T => {\n    // Prevent build error \"window is undefined\" but keep keep working\n    if (typeof window === 'undefined') {\n      return initialValue\n    }\n\n    try {\n      const item = window.localStorage.getItem(key)\n      return item ? (JSON.parse(item) as T) : initialValue\n    } catch (error) {\n      console.warn(`Error reading localStorage key “${key}”:`, error)\n      return initialValue\n    }\n  }\n\n  // State to store our value\n  // Pass initial state function to useState so logic is only executed once\n  const [storedValue, setStoredValue] = useState<T>(readValue)\n\n  // Return a wrapped version of useState's setter function that ...\n  // ... persists the new value to localStorage.\n  const setValue: SetValue<T> = value => {\n    // Prevent build error \"window is undefined\" but keeps working\n    if (typeof window == 'undefined') {\n      console.warn(\n        `Tried setting localStorage key “${key}” even though environment is not a client`,\n      )\n    }\n\n    try {\n      // Allow value to be a function so we have the same API as useState\n      const newValue = value instanceof Function ? value(storedValue) : value\n\n      // Save to local storage\n      window.localStorage.setItem(key, JSON.stringify(newValue))\n\n      // Save state\n      setStoredValue(newValue)\n\n      // We dispatch a custom event so every useLocalStorage hook are notified\n      window.dispatchEvent(new Event('local-storage'))\n    } catch (error) {\n      console.warn(`Error setting localStorage key “${key}”:`, error)\n    }\n  }\n\n  useEffect(() => {\n    setStoredValue(readValue())\n  }, [])\n\n  useEffect(() => {\n    const handleStorageChange = () => {\n      setStoredValue(readValue())\n    }\n\n    // this only works for other documents, not the current one\n    window.addEventListener('storage', handleStorageChange)\n\n    // this is a custom event, triggered in writeValueToLocalStorage\n    window.addEventListener('local-storage', handleStorageChange)\n\n    return () => {\n      window.removeEventListener('storage', handleStorageChange)\n      window.removeEventListener('local-storage', handleStorageChange)\n    }\n  }, [])\n\n  return [storedValue, setValue]\n}\n","import React, {useState} from \"react\";\nimport {IDeviceControlProps} from \"../../interfaces/IDeviceControlProps\";\nimport {LayoutSettingsCommand} from \"../settings\";\nimport {HuePicker, GithubPicker, CompactPicker, RGBColor} from \"react-color\";\nimport {Row} from \"react-bootstrap\";\nimport {Single} from \"../../services/single\";\nimport {useLocalStorage} from \"../../services/localStorage\";\nimport {DeviceControls} from \"../../services/deviceControls\";\nimport {DeviceControlCol1, DeviceControlCol2} from \"../index\";\n\n//TODO localize\nexport const RgbRoot = (props: IDeviceControlProps<LayoutSettingsCommand>) => {\n  const report = DeviceControls.getControlReport(props);\n  let currentValue: number[] = report?.val ? report?.val.split(\":\").map(x => Number(x)) : [255, 255, 255];\n  if (currentValue.length !== 3) {\n    console.warn(`Incorrect RGB value stored to reportd: ${report?.val}`);\n    currentValue = [255, 255, 255];\n  }\n\n  const [color, setColor] = useState<RGBColor>({r: currentValue[0], g: currentValue[1], b: currentValue[2]});\n  const [colorPicker, setColorPicker] = useLocalStorage(\"colorPicker\", 1);\n\n  // const setCurrentValue = (rgb: RGBColor) => DeviceControls.setControlReport(globalState, props, `${rgb.r}:${rgb.g}:${rgb.b}`);\n  const colorChangeHandler = (rgb: RGBColor) => {\n    setColor(rgb);\n\n    const [x, y] = rgbToXY(rgb);\n    let command = props.config.arguments.command.replace(\"{x}\", x.toString(16));\n    command = command.replace(\"{y}\", y.toString(16));\n    Single.ZespConnector.send({data: command});\n    // setCurrentValue(rgb);\n  }\n\n  const sendColorHandler = () => {\n    const [x, y] = rgbToXY(color);\n\n    let command = props.config.arguments.command.replace(\"{x}\", x.toString(16));\n    command = command.replace(\"{y}\", y.toString(16));\n\n    Single.ZespConnector.send({data: command});\n    // setCurrentValue(color);\n  }\n\n  const colorPickerButton = (id: number) =>\n    (<button className={`btn btn-outline-secondary me-1 btn-xs ${colorPicker == id ? \"active\" : \"\"}`} type=\"button\" onClick={() => setColorPicker(id)}>{id}</button>)\n\n  return (\n    <Row>\n      <DeviceControlCol1 className=\"user-select-none\">\n        <div>\n          <div>Light color:</div>\n          <div>\n            {colorPickerButton(1)}\n            {colorPickerButton(2)}\n            {colorPickerButton(3)}\n          </div>\n        </div>\n      </DeviceControlCol1>\n      <DeviceControlCol2>\n        <div className=\"flex-grow-1\">\n          {colorPicker === 1 && (<HuePicker color={color} onChange={event => setColor(event.rgb)} onChangeComplete={sendColorHandler} width=\"270px\"/>)}\n          {colorPicker === 2 && (<GithubPicker color={color} onChange={event => colorChangeHandler(event.rgb)} triangle=\"hide\" width=\"214px\"/>)}\n          {colorPicker === 3 && (<CompactPicker color={color} onChange={event => colorChangeHandler(event.rgb)}/>)}\n        </div>\n      </DeviceControlCol2>\n    </Row>\n  );\n}\n\nconst rgbToXY = (rgb: RGBColor) => {\n  // Apply a gamma correction to the RGB values, which makes the color more vivid and more the like the color displayed on the screen of your device\n  // const red = (rgb.r > 0.04045) ? Math.pow((rgb.r + 0.055) / (1.0 + 0.055), 2.4) : (rgb.r / 12.92);\n  const red = (rgb.b > 0.04045) ? Math.pow((rgb.b + 0.055) / (1.0 + 0.055), 2.4) : (rgb.b / 12.92);\n  const green = (rgb.g > 0.04045) ? Math.pow((rgb.g + 0.055) / (1.0 + 0.055), 2.4) : (rgb.g / 12.92);\n  // const blue = (rgb.b > 0.04045) ? Math.pow((rgb.b + 0.055) / (1.0 + 0.055), 2.4) : (rgb.b / 12.92);\n  const blue = (rgb.r > 0.04045) ? Math.pow((rgb.r + 0.055) / (1.0 + 0.055), 2.4) : (rgb.r / 12.92);\n\n\n  // RGB values to XYZ using the Wide RGB D65 conversion formula\n  const X = red * 0.664511 + green * 0.154324 + blue * 0.162028;\n  const Y = red * 0.283881 + green * 0.668433 + blue * 0.047685;\n  const Z = red * 0.000088 + green * 0.072310 + blue * 0.986039;\n\n  // Calculate the xy values from the XYZ values\n  // let x = (X / (X + Y + Z)).toFixed(4);\n  // let y = (Y / (X + Y + Z)).toFixed(4)\n  let x = (X / (X + Y + Z));\n  let y = (Y / (X + Y + Z));\n\n  if (isNaN(x)) x = 0;\n  if (isNaN(y)) y = 0;\n\n  return [Number((x * 65279).toFixed(0)), Number((y * 65279).toFixed(0))];\n}","import React, {ReactNode, useEffect, useState} from \"react\";\n\ninterface IProps {\n  children?: ReactNode | undefined,\n  classNameFrom: string,\n  classNameTo: string,\n  timeOutMs?: number,\n  onRefresh?: boolean,\n  onLoad?: boolean\n}\n\nexport const Transition = (props: IProps) => {\n  const [className, setClassName] = useState<string>();\n  if (props.onRefresh === true) useEffect(\n    () => setClassName(props.classNameFrom),\n    [props.children?.toString()]);\n\n  if (props.onLoad === false) useEffect(() => setClassName(props.classNameTo), []);\n\n  setTimeout(() => setClassName(props.classNameTo), props.timeOutMs || 100);\n  return (<span className={className}>{props.children}</span>)\n}\n","import React, {FunctionComponent} from \"react\";\nimport {Transition} from \"./index\";\n\nexport const HighlightOnUpdate: FunctionComponent = (props) => {\n  return (\n    <Transition classNameFrom=\"highlight-value just-added\" classNameTo=\"highlight-value\" onRefresh={true} onLoad={false}>\n      {props.children}\n    </Transition>\n  )\n}","import React, {useState} from \"react\";\nimport {IDeviceControlProps} from \"../interfaces/IDeviceControlProps\";\nimport {DataControlSettings} from \"../models/DataControlSettings\";\nimport {DeviceControls} from \"../services/deviceControls\";\nimport {DeviceControlCol1, DeviceControlCol2} from \"./index\";\nimport {HighlightOnUpdate} from \"../shared/transition/HighlightOnUpdate\";\nimport {Row} from \"react-bootstrap\";\n\nexport const UnknownControl = (props: IDeviceControlProps<DataControlSettings>) => {\n  const [showDetails, setShowDetails] = useState(false);\n  const configData = JSON.stringify(props.config)\n  const reportData = JSON.stringify(DeviceControls.getControlReport(props));\n\n  const report = DeviceControls.getControlReport(props);\n  if (!report) return (<NoReport id={props.config.id} reportData={reportData} configData={configData}/>)\n\n  const label = report.label || props.config.label || props.config.id || \"Unknown data\";\n  const value =\n    (report.parsed && report.parsed.toString().trim() === report.val.toString().trim() && report.parsed)\n    || (report.parsed && report.val && `${report.parsed} (${report.val})`)\n    || report.val\n    || \"No data\";\n\n  const roleParts = report.role?.split(\"&\");\n  const roleSettings = roleParts && roleParts.length > 1 && JSON.parse(roleParts[1]);\n  const units = (roleSettings && roleSettings[\"unit_of_measurement\"]) || \"\";\n\n  const showDetailsClicked = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    setShowDetails(!showDetails);\n  }\n\n  return (\n    <Row>\n      <DeviceControlCol1>{label}:</DeviceControlCol1>\n      <DeviceControlCol2>\n        <HighlightOnUpdate>{value} {units}</HighlightOnUpdate>\n        <a onClick={showDetailsClicked} href=\"#\" className=\"value-info\" title=\"Unrecognized data, click to show details\">\n          <i className=\"bi bi-info-circle-fill ms-2 text-secondary\"/>\n        </a>\n      </DeviceControlCol2>\n      <div className={`alert alert-info flex-column col-12 ${showDetails ? \"\" : \"d-none\"}`}>\n        <div>{configData}</div>\n        {reportData && (<div className=\"mt-2\">{reportData}</div>)}\n      </div>\n    </Row>\n  )\n\n  // return \n}\n\nconst NoReport = (props: { id: string, configData: string, reportData: string }) => (\n  <Row>\n    <DeviceControlCol1>{props.id}</DeviceControlCol1>\n    <DeviceControlCol2>\n      <div className=\"alert alert-info\">\n        <div>{props.configData}</div>\n        {props.reportData && (<div className=\"mt-2\">{props.reportData}</div>)}\n      </div>\n    </DeviceControlCol2>\n  </Row>\n)\n","import React from \"react\";\nimport {Row} from \"react-bootstrap\";\nimport {LayoutSettingsSensor} from \"../settings\";\nimport {IDeviceControlProps} from \"../../interfaces/IDeviceControlProps\";\nimport {DeviceControls} from \"../../services/deviceControls\";\nimport {HighlightOnUpdate} from \"../../shared/transition/HighlightOnUpdate\";\nimport {DeviceControlCol1, DeviceControlCol2} from \"../index\";\n\n//TODO localization\nexport const IlluminanceSensor = (props: IDeviceControlProps<LayoutSettingsSensor>) => {\n  const report = DeviceControls.getControlReport(props);\n  const value = report?.val ? parseInt(report.val, 16).toString() : null;\n\n  return (\n    <Row>\n      <DeviceControlCol1>Illuminance:</DeviceControlCol1>\n      <DeviceControlCol2>\n        {value && (<HighlightOnUpdate>{value}</HighlightOnUpdate>)}\n        {!value && (<span className=\"alert alert-warning small py-2 m-0\">No data</span>)}\n      </DeviceControlCol2>\n    </Row>\n  )\n}\n","import React, {useState} from \"react\";\nimport {FormControl, Row} from \"react-bootstrap\";\nimport FormRange from \"react-bootstrap/FormRange\";\nimport {LayoutSettingsLevel} from \"../settings\";\nimport {IDeviceControlProps} from \"../../interfaces/IDeviceControlProps\";\nimport {Single} from \"../../services/single\";\nimport {DeviceControls} from \"../../services/deviceControls\";\nimport {DeviceControlCol1, DeviceControlCol2} from \"../index\";\n\nexport const LevelControl = (props: IDeviceControlProps<LayoutSettingsLevel>) => {\n  const minMaxAttributes = {\n    min: props.config.arguments.min,\n    max: props.config.arguments.max\n  };\n\n  const report = DeviceControls.getControlReport(props);\n  const currentValue = report?.parsed ? Number(report.parsed) : ((minMaxAttributes.max - minMaxAttributes.min) / 2 + minMaxAttributes.min);\n  const [value, setValue] = useState(currentValue);\n\n  const inRange = (value: number) => Math.max(Math.min(props.config.arguments.max, value), props.config.arguments.min);\n\n  const sliderChangeHandler = () => {\n    const result = inRange(value);\n    sendValueToZesp(result);\n  }\n\n  const inputChangeHandler = (value: number) => {\n    const result = inRange(value);\n    setValue(result);\n    sendValueToZesp(result);\n  }\n\n  const sendValueToZesp = (value: number) => {\n    const data = formatCommand(props.config.arguments.command, value, props);\n    Single.ZespConnector.send({data: data});\n  }\n\n  const label = report?.label || props.config.label || \"Level\";\n\n  return (\n    <Row>\n      <DeviceControlCol1>{label}:</DeviceControlCol1>\n      <DeviceControlCol2>\n        <FormControl\n          style={{width: \"100px\"}}\n          className=\"me-2 text-center\"\n          type=\"number\"\n          value={value}\n          onChange={event => inputChangeHandler(Number(event.target.value))}\n          {...minMaxAttributes}\n        />\n\n        <FormRange\n          value={value}\n          onChange={event => setValue(Number(event.target.value))}\n          onMouseUp={sliderChangeHandler}\n          {...minMaxAttributes}\n        />\n      </DeviceControlCol2>\n    </Row>\n  )\n}\n\nconst formatCommand = (command: string, value: number, props: IDeviceControlProps<LayoutSettingsLevel>): string => command\n  .replace(\"{device}\", props.deviceInfo.zespInfo.Device)\n  .replace(\"{value}\", value.toString(16))\n  .replace(\"{value:dec}\", value.toString());","import React, {ChangeEvent, useEffect, useState} from \"react\";\nimport {Row} from \"react-bootstrap\";\nimport {IDeviceControlProps} from \"../../interfaces/IDeviceControlProps\";\nimport {DataControlSettings} from \"../../models/DataControlSettings\";\nimport {DeviceControls} from \"../../services/deviceControls\";\nimport toast from \"react-hot-toast\";\nimport {LayoutSettingsOnOff} from \"../settings\";\nimport {Single} from \"../../services/single\";\nimport {DeviceControlCol1, DeviceControlCol2} from \"../index\";\n\n// TODO add localization\nexport const PlayerSrcRoot = (props: IDeviceControlProps<DataControlSettings>) => {\n  const srcReport = DeviceControls.getControlReport(props);\n  const [playSettings, playReport] = DeviceControls.getControlSettings<LayoutSettingsOnOff>(props, \"player_control_root\");\n\n  if (!srcReport) {\n    useEffect(() => {\n      toast.error(`'${props.config.id}' layout settings not found`);\n    }, []);\n    return (<></>);\n  }\n\n  if (!playReport) {\n    useEffect(() => {\n      toast.error(\"'player_control_root' layout settings not found\");\n    }, []);\n    return (<></>);\n  }\n\n  const [src, setSrc] = useState(srcReport.val || \"\");\n  const [play, setPlay] = useState(playReport!.val || \"OFF\");\n\n  const srcs: string[] = [\n    \"http://chanson.hostingradio.ru:8041/chanson128.mp3\",\n    \"http://dorognoe.hostingradio.ru:8000/radio?type=.mp3\",\n    \"http://stream3.radiostyle.ru:8001/biker-fm\",\n    \"http://air.radiorecord.ru:8102/sd90_320\",\n    \"http://stream.hitroe.com/stream\",\n    \"http://air.radiorecord.ru:8102/tm_320\",\n    \"http://eu.radioboss.fm:8024/stream\",\n    \"http://listen.181fm.com/181-thebox_128k.mp3?\",\n    \"http://stream.live.vc.bbcmedia.co.uk/bbc_radio_one\"\n  ];\n\n  const handleChange = (event: ChangeEvent) => {\n    const value = (event.target as HTMLInputElement).value\n    setSrc(value);\n\n    // DeviceControls.setControlReport(globalState, props, value);\n  }\n\n  const handleStop = () => {\n    setPlay(\"OFF\");\n    // DeviceControls.setControlReport(globalState, props, \"OFF\", playSettings!.reportKey);\n\n    setSrc(\"\");\n    // DeviceControls.setControlReport(globalState, props, \"\");\n\n    if (playSettings) Single.ZespConnector.send({data: playSettings.arguments.commandOff});\n    else console.warn(\"No configured OFF command for 'player_control_root' operation found in layout\");\n  }\n\n  const handlePlay = () => {\n    if (!src || src.length === 0) {\n      toast.error(\"Please select source first\", {icon: \"🎵\"});\n      return;\n    }\n\n    setPlay(\"ON\");\n    // DeviceControls.setControlReport(globalState, props, \"ON\", playSettings!.reportKey);\n    if (playSettings) Single.ZespConnector.send({data: playSettings.arguments.commandOn.replace(\"{value}\", src)});\n    else console.warn(\"No configured ON command for 'player_control_root' operation found in layout\");\n  }\n\n  return (\n    <Row>\n      <DeviceControlCol1>Radio stream:</DeviceControlCol1>\n      <DeviceControlCol2>\n        <div className=\"input-group\">\n          <input className=\"form-control\" list=\"datalistOptions\" placeholder=\"Click to see dropdown suggestions\" value={src} onChange={handleChange}/>\n          <button className={`btn btn-outline-secondary ${play !== \"ON\" ? \"active\" : \"\"}`} type=\"button\" onClick={handleStop}><i className=\"bi-stop\"/></button>\n          <button className={`btn btn-outline-secondary rounded-end ${play === \"ON\" ? \"active\" : \"\"}`} type=\"button\" onClick={handlePlay}><i className=\"bi-play\"/></button>\n          <datalist id=\"datalistOptions\">\n            {srcs.map((src, i) => (<option key={i} value={src}/>))}\n          </datalist>\n        </div>\n      </DeviceControlCol2>\n    </Row>\n  )\n}\n","import React from \"react\";\nimport {Row} from \"react-bootstrap\";\nimport {IDeviceControlProps} from \"../../interfaces/IDeviceControlProps\";\nimport {DeviceControls} from \"../../services/deviceControls\";\nimport {HighlightOnUpdate} from \"../../shared/transition/HighlightOnUpdate\";\nimport {DataControlSettings} from \"../../models/DataControlSettings\";\nimport {DeviceControlCol1, DeviceControlCol2} from \"../index\";\n\nexport const OnOffBinarySensor = (props: IDeviceControlProps<DataControlSettings>) => {\n  const report = DeviceControls.getControlReport(props);\n  if (!report) return (<div className=\"alert alert-warning\">Report missed</div>);\n  const payloadOn = Number(props.config.zespRoleSettings[\"payload_on\"]?.toString() || \"0\");\n  const value = Number(report.parsed?.toString() || report.val?.toString() || \"1\");\n  const result = value === payloadOn;\n\n  return (\n    <Row>\n      <DeviceControlCol1>{report.label || \"State\"}:</DeviceControlCol1>\n      <DeviceControlCol2>\n        <HighlightOnUpdate>{result ? \"ON\" : \"OFF\"}</HighlightOnUpdate>\n      </DeviceControlCol2>\n    </Row>\n  )\n}","import React from \"react\";\nimport {Row} from \"react-bootstrap\";\nimport {IDeviceControlProps} from \"../../interfaces/IDeviceControlProps\";\nimport {DeviceControls} from \"../../services/deviceControls\";\nimport {HighlightOnUpdate} from \"../../shared/transition/HighlightOnUpdate\";\nimport {DataControlSettings} from \"../../models/DataControlSettings\";\nimport {DeviceControlCol1, DeviceControlCol2} from \"../index\";\n\nexport const ValueSensor = (props: IDeviceControlProps<DataControlSettings>) => {\n  const report = DeviceControls.getControlReport(props);\n  if (!report) return (<div className=\"alert alert-warning\">Report missed</div>);\n\n  const value = report.parsed || report.val;\n  const unit = props.config.zespRoleSettings[\"unit_of_measurement\"] || \"\";\n\n  return (\n    <Row>\n      <DeviceControlCol1>{report.label || \"Value\"}:</DeviceControlCol1>\n      <DeviceControlCol2>\n        <HighlightOnUpdate>{value ? `${value} ${unit}` : \"No data\"}</HighlightOnUpdate>\n      </DeviceControlCol2>\n    </Row>\n  )\n}\n","import React from \"react\";\nimport {Button, ButtonGroup, Row} from \"react-bootstrap\";\nimport {LayoutSettingsOnOffToggle} from \"../settings\";\nimport {IDeviceControlProps} from \"../../interfaces/IDeviceControlProps\";\nimport {Single} from \"../../services/single\";\nimport {DeviceControls} from \"../../services/deviceControls\";\nimport {DeviceControlCol1, DeviceControlCol2} from \"../index\";\n\nexport const OnOffToggle = (props: IDeviceControlProps<LayoutSettingsOnOffToggle>) => {\n  const report = DeviceControls.getControlReport(props);\n\n  const onHandler = () => {\n    const command = props.config.arguments.commandOn.replace(\"{device}\", props.deviceInfo.zespInfo.Device)\n    Single.ZespConnector.send({data: command, isBinary: true});\n  };\n\n  const offHandler = () => {\n    const command = props.config.arguments.commandOff.replace(\"{device}\", props.deviceInfo.zespInfo.Device)\n    Single.ZespConnector.send({data: command, isBinary: true});\n  };\n\n  const toggleHandler = () => {\n    const command = props.config.arguments.commandToggle.replace(\"{device}\", props.deviceInfo.zespInfo.Device)\n    Single.ZespConnector.send({data: command, isBinary: true});\n  }\n\n  const label = report?.label || props.config.label || \"Power\";\n\n  return (\n    <Row>\n      <DeviceControlCol1>{label}:</DeviceControlCol1>\n      <DeviceControlCol2>\n        <ButtonGroup>\n          <Button variant={report?.parsed.toString() === \"1\" ? \"primary\" : \"secondary\"} onClick={onHandler}>ON</Button>\n          <Button variant=\"secondary\" onClick={toggleHandler}>Toggle</Button>\n          <Button variant={report?.parsed.toString() === \"0\" ? \"primary\" : \"secondary\"} onClick={offHandler}>OFF</Button>\n        </ButtonGroup>\n      </DeviceControlCol2>\n    </Row>\n  )\n}\n","import React, {FunctionComponent} from \"react\";\nimport {LayoutSettingsCommand, LayoutSettingsLevel, LayoutSettingsOnOff, LayoutSettingsOnOffToggle, LayoutSettingsSensor} from \"./settings\";\nimport {IDeviceControlProps} from \"../interfaces/IDeviceControlProps\";\nimport {OnOffRoot} from \"./root/OnOffRoot\";\nimport {LevelRoot} from \"./root/LevelRoot\";\nimport {RgbRoot} from \"./root/RgbRoot\";\nimport {UnknownControl} from \"./unknown\";\nimport {IlluminanceSensor} from \"./sensors/IlluminanceSensor\";\n\nimport {DataControlSettings} from \"../models/DataControlSettings\";\nimport {LevelControl} from \"./controls/LevelControl\";\nimport {DeviceInfo} from \"../models/DeviceInfo\";\nimport {PlayerSrcRoot} from \"./root/PlayerSrcRoot\";\nimport {OnOffBinarySensor} from \"./sensors/OnOffBinarySensor\";\nimport {ValueSensor} from \"./sensors/ValueSensor\";\nimport {Col} from \"react-bootstrap\";\nimport {OnOffToggle} from \"./controls/OnOffToggle\";\n\nexport const getControlForDevice = (config: DataControlSettings, deviceInfo: DeviceInfo): JSX.Element | undefined => {\n  const controlProps: IDeviceControlProps<DataControlSettings> = {\n    config,\n    deviceInfo,\n  }\n\n  switch (config.id) {\n    case \"on_off_root\" :\n      return (<OnOffRoot {...controlProps} config={controlProps.config as LayoutSettingsOnOff}/>);\n    case \"level_root\" :\n      return (<LevelRoot {...controlProps} config={controlProps.config as LayoutSettingsLevel}/>);\n    case \"rgb_root\" :\n      return (<RgbRoot {...controlProps} config={controlProps.config as LayoutSettingsCommand}/>);\n    case \"player_src_root\" :\n      return (<PlayerSrcRoot {...controlProps} config={controlProps.config as DataControlSettings}/>);\n    case \"player_control_root\":\n      return undefined;\n\n    case \"level_control\" :\n      return (<LevelControl {...controlProps} config={controlProps.config as LayoutSettingsLevel}/>);\n\n    case \"illuminance_sensor\" :\n      return (<IlluminanceSensor {...controlProps} config={controlProps.config as LayoutSettingsSensor}/>);\n    case \"binary_sensor\" :\n      return (<OnOffBinarySensor {...controlProps} config={controlProps.config as DataControlSettings}/>);\n    case \"sensor\" :\n      return (<ValueSensor {...controlProps} config={controlProps.config as DataControlSettings}/>);\n\n    case \"on_off_toggle\":\n      return (<OnOffToggle {...controlProps} config={controlProps.config as LayoutSettingsOnOffToggle}/>);\n\n    default:\n      return (<UnknownControl {...controlProps}/>)\n  }\n}\n\nexport const DeviceControlCol1: FunctionComponent<React.HTMLProps<HTMLButtonElement>> = (props) => {\n  return (<Col md=\"4\">{props.children}</Col>)\n}\n\nexport const DeviceControlCol2: FunctionComponent<React.HTMLProps<HTMLButtonElement>> = (props) => {\n  return (<Col>{props.children}</Col>)\n}","import {getControlForDevice} from \"../index\";\nimport React, {FunctionComponent, useState} from \"react\";\nimport {LayoutProps} from \"../../models/LayoutProps\";\n\nexport const DefaultLayout: FunctionComponent<LayoutProps> = (props: LayoutProps) => {\n  const controls: React.ReactElement[] = [];\n  const unknown: React.ReactElement[] = [];\n\n  props.settings.forEach(settings => {\n    const element = getControlForDevice(settings, props.device);\n    if (!element) return;\n\n    if (element?.type.name === \"UnknownControl\") unknown.push(element);\n    else controls.push(element);\n  });\n\n  // show by default if now identified controls found\n  const [showUnknown, setShowUnknown] = useState(controls.length === 0);\n\n  const onToggleUnknownHandler = () => {\n    setShowUnknown(!showUnknown);\n  }\n\n  return (\n    <div className=\"default-layout\">\n      {controls.length > 0 && (\n        <div className=\"elements\">\n          {controls.map((element, i) => {\n            return (<div key={i} className=\"device-control-group\">{element}</div>);\n          })}\n        </div>\n      )}\n\n      {unknown.length > 0 && (\n        <>\n          <button onClick={onToggleUnknownHandler} className=\"show-unknown-btn btn btn-outline-info\">Unknown reports ({unknown.length})</button>\n          <div className={`elements unknown ${showUnknown ? \"show\" : \"hide\"}`}>\n            {unknown.map((element, i) => {\n              return (<div key={i} className=\"device-control-group\">{element}</div>);\n            })}\n          </div>\n        </>\n      )}\n    </div>\n  )\n}","import React, {FunctionComponent} from \"react\";\nimport \"./styles.scss\";\nimport {LayoutProps} from \"../../../models/LayoutProps\";\nimport {ZespReportInfo} from \"../../../services/zesp/models/ZespReportInfo\";\nimport {IDeviceClassSettings} from \"./IDeviceClassSettings\";\n\nexport const reportKeysValue = [\"0100060000\", \"0104060000\"];\nexport const reportKeysBattery = [\"010000FF02\"];\n\nconst deviceClasses: { [deviceClass: string]: IDeviceClassSettings } = require(\"./device-classes.json\");\nconst batteryWarningLevelPercents = 50;\nconst batteryValuesRange = [2.7, 3.1]; // battery values to calculate percents from 0 to 100%\n\nexport const BinarySensorLayout: FunctionComponent<LayoutProps> = (props: LayoutProps) => {\n  const value = getValueSettings(props);\n  const battery = getBatterySettings(props);\n\n  return (\n    <div className=\"row custom-binary-layout\">\n      <div className=\"col col-5 left\">\n        <i className={`bi ${value.iconClassName}`}/>\n      </div>\n      <div className=\"col right flex-column justify-content-center\">\n        <div className=\"text-center\">\n          <div>Current status:</div>\n          <div className={value.valueClassName}>{value.valueTitle}</div>\n        </div>\n\n        <div className=\"text-center mt-3 w-100\">\n          <div>Battery Level: <span className={`status ${battery.stateClassName}`}>{battery.valueTitle}</span></div>\n          <div className=\"progress mt-3\">\n            <div\n              className={`progress-bar ${battery.stateClassName}`}\n              role=\"progressbar\"\n              style={{width: `${battery.valuePercents}%`}}/>\n          </div>\n          <div className=\"battery-icon\">\n            <i className={`bi bi-battery-half ${battery.stateClassName}`}/>\n          </div>\n        </div>\n\n      </div>\n    </div>\n  );\n}\n\n// region getValueSettings \nconst getValueSettings = (props: LayoutProps): {\n  iconClassName: string,\n  valueClassName: string,\n  valueTitle: string\n} => {\n  const onOffReport = getReport(reportKeysValue, props);\n  if (!onOffReport) return {\n    iconClassName: deviceClasses[\"default\"].icons!.onFalse,\n    valueClassName: \"status-unknown\",\n    valueTitle: \"Unknown\"\n  }\n\n  // try to get status of binary sensor\n  const statusValue = onOffReport.parsed || onOffReport.val;\n  const roleParts = onOffReport.role && onOffReport.role.split(\"&\");\n  const roleSettings = roleParts && roleParts.length > 1 ? JSON.parse(roleParts[1]) : undefined;\n  const status: boolean = roleSettings && roleSettings[\"payload_on\"]\n    ? statusValue === roleSettings[\"payload_on\"] // compare with role settings\n    : (statusValue === \"1\" || statusValue === \"01\") // compare with default expected\n\n  // views configuration\n  const deviceClass: string = roleSettings && roleSettings[\"device_class\"] || \"default\";\n  const valueSettings: IDeviceClassSettings = {...deviceClasses[\"default\"], ...deviceClasses[deviceClass]};\n\n  const iconClassName = status ? `${valueSettings.icons!.onTrue} ${valueSettings.styles!.onTrue}` : `${valueSettings.icons!.onFalse} ${valueSettings.styles!.onFalse}`;\n  const valueClassName = status ? `status ${valueSettings.styles!.onTrue}` : `status ${valueSettings.styles!.onFalse}`;\n  const valueTitle = status ? valueSettings.titles.onTrue : valueSettings.titles.onFalse;\n\n  return {iconClassName, valueClassName, valueTitle};\n}\n// endregion\n\n// region getBatterySettings\nconst getBatterySettings = (props: LayoutProps): {\n  stateClassName: string,\n  valueTitle: string,\n  valuePercents: number\n} => {\n  const report = getReport(reportKeysBattery, props);\n\n  // return default for unknown\n  if (!report) return {stateClassName: \"??\", valueTitle: \"-\", valuePercents: 0};\n\n  const roleParts = report.role?.split(\"&\");\n  const roleSettings = roleParts && roleParts.length > 1 ? JSON.parse(roleParts[1]) : undefined;\n  const units = roleSettings && roleSettings[\"unit_of_measurement\"] || \"\";\n  const valueString = Number(report.parsed || report.val) || undefined;\n  let valuePercents: number | undefined = undefined;\n\n  // get percents\n  if (!valueString) valuePercents = undefined\n  else if (units === \"%\") valuePercents = Number(valueString);\n  else {\n    let valueNumber = Number(valueString) || undefined;\n    if (valueNumber) {\n      valueNumber = Math.min(batteryValuesRange[1], Math.max(batteryValuesRange[0], valueNumber));\n      valuePercents = Math.round((1 - (batteryValuesRange[1] - valueNumber) / (batteryValuesRange[1] - batteryValuesRange[0])) * 100);\n    }\n  }\n\n  // views configuration\n  const deviceClass: string = roleSettings && roleSettings[\"device_class\"] || \"default\";\n  const valueSettings: IDeviceClassSettings = {...deviceClasses[\"default\"], ...deviceClasses[deviceClass]};\n\n  const valueTitle = `${valueString || \"??\"} ${units}`;\n  const stateClassName = !valuePercents\n    ? \"status-unknown\"\n    : valuePercents <= batteryWarningLevelPercents\n      ? valueSettings.styles!.onFalse\n      : valueSettings.styles!.onTrue;\n\n  return {\n    stateClassName,\n    valuePercents: valuePercents || 0,\n    valueTitle\n  };\n}\n// endregion\n\nconst getReport = (oneOfKeys: string[], props: LayoutProps): ZespReportInfo | undefined => {\n  for (const key of oneOfKeys) {\n    const report = props.device.zespInfo.Report[key];\n    if (report) return report;\n  }\n}","import {DefaultLayout} from \"./DefaultLayout\";\nimport {BinarySensorLayout} from \"./binary-sensor\";\nimport {FunctionComponent} from \"react\";\nimport {LayoutProps} from \"../../models/LayoutProps\";\nimport {ZespReportInfo} from \"../../services/zesp/models/ZespReportInfo\";\nimport {ZespDeviceInfo} from \"../../services/zesp/models/ZespDeviceInfo\";\nimport AutoDetectionBinarySensor from \"./binary-sensor/auto\";\nimport AutoDetectionBleBeacon from \"./ble-beacon/auto\";\nimport BleBeaconLayout from \"./ble-beacon\";\n\n// list of available layouts with names\nexport const layoutsAvailable = {\n  default: DefaultLayout,\n  binarySensorLayout: BinarySensorLayout,\n  bleBeacon: BleBeaconLayout,\n} as { [name: string]: FunctionComponent<LayoutProps> };\n\n// list of layout auto detection functions, which return layout name\nconst autoDetectors: { (zespInfo: ZespDeviceInfo): string | undefined }[] = [\n  AutoDetectionBinarySensor,\n  AutoDetectionBleBeacon,\n];\n\n// region help methods\nexport const layoutTools = {\n  autoDetect: (zespInfo: ZespDeviceInfo): string | undefined => {\n    for (const autoDetector of autoDetectors) {\n      const layout = autoDetector(zespInfo);\n      if (layout) return layout;\n    }\n\n    return undefined;\n  },\n\n  roleDeviceClassIs: (expectedDeviceClasses: string[], report: ZespReportInfo): boolean => {\n    const roleParts = report.role && report.role.split(\"&\");\n    if (roleParts.length < 2) return false;\n\n    const roleSettings = JSON.parse(roleParts[1]);\n    const reportDeviceClass = roleSettings[\"device_class\"];\n    if (!reportDeviceClass) return false;\n\n    return expectedDeviceClasses.indexOf(reportDeviceClass) >= 0;\n  },\n  getReport: (oneOfKeys: string[], zespInfo: ZespDeviceInfo): ZespReportInfo | undefined => {\n    for (const key of oneOfKeys) {\n      const report = zespInfo.Report[key];\n      if (report) return report;\n    }\n  }\n}\n// endregion","import React, {FunctionComponent, useEffect, useState} from \"react\";\nimport {LayoutProps} from \"../../../models/LayoutProps\";\nimport {HighlightOnUpdate} from \"../../../shared/transition/HighlightOnUpdate\";\n\nconst lastUpdateTresholdSeconds = 60 * 5;\n\nexport const BleBeacon: FunctionComponent<LayoutProps> = (props) => {\n  const isInRange = props.device.zespInfo.Report[\"ble_InRange\"]?.parsed === \"1\";\n  const signalLevel = props.device.zespInfo.Report[\"ble_signal_level\"]?.parsed;\n\n  const lastUpdateMs = Math.max(props.device.zespInfo.Report[\"ble_InRange\"].time, props.device.zespInfo.Report[\"ble_signal_level\"].time);\n  const lastDate = new Date(lastUpdateMs);\n  const calculateRelative = () => Math.round((Date.now() - lastUpdateMs) / 1000);\n  const [relative, setRelative] = useState(calculateRelative());\n\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setRelative(calculateRelative());\n    }, 1000);\n    return () => {\n      clearInterval(timer);\n    }\n  }, [lastUpdateMs]);\n\n  const lastUpdateStyle = relative < lastUpdateTresholdSeconds\n    ? \"status-primary\"\n    : \"status-unknown\";\n\n  const rangeStyle = isInRange\n    ? \"status-primary\"\n    : \"status-unknown\";\n\n  return (\n    <div className=\"row custom-layout\">\n      <div className=\"col col-5 left flex-column position-relative\">\n        <i className={`bi bi-wifi ${rangeStyle}`}/>\n        <div className={`icon-description ${rangeStyle}`}>{isInRange ? \"In range\" : \"Out of range\"}</div>\n      </div>\n      <div className=\"col right flex-column justify-content-center\">\n        <div className=\"text-center\">\n          <div>Signal level:</div>\n          <div className={`status ${rangeStyle}`}><HighlightOnUpdate>{signalLevel}</HighlightOnUpdate></div>\n        </div>\n        <div className=\"text-center mt-3\">\n          <div>Last update:</div>\n          <div className={`status ${lastUpdateStyle}`}>{lastDate.toLocaleDateString()} {lastDate.toLocaleTimeString()}</div>\n          <div className=\"small text-muted opacity-50\">{\n            relative < 60 ? `${relative} seconds ago` :\n              relative / 60 < 60 ? `${Math.round(relative / 60)} minutes ago` :\n                `${Math.round(relative / 60 / 60)} hours ago`\n          }</div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default BleBeacon;","import {ZespDeviceInfo} from \"../../../services/zesp/models/ZespDeviceInfo\";\nimport {reportKeysBattery as binarySensorBatteryKeys, reportKeysValue as binarySensorValueKeys} from \"./index\";\nimport {layoutTools} from \"../index\";\n\nexport const AutoDetectionBinarySensor = (zespInfo: ZespDeviceInfo): string | undefined => {\n  const valueReportKey = layoutTools.getReport(binarySensorValueKeys, zespInfo);\n  const batteryReportKey = layoutTools.getReport(binarySensorBatteryKeys, zespInfo);\n\n  if (!valueReportKey || !batteryReportKey) return undefined; // these two guys required\n  if (!layoutTools.roleDeviceClassIs([\"battery\"], batteryReportKey)) return undefined;\n  if (!layoutTools.roleDeviceClassIs([\"door\", \"motion\"], valueReportKey)) return undefined;\n\n  console.debug(`Auto detected layout 'binarySensorLayout' for '${zespInfo.IEEE}'`);\n  return \"binarySensorLayout\";\n}\n\nexport default AutoDetectionBinarySensor;","import {ZespDeviceInfo} from \"../../../services/zesp/models/ZespDeviceInfo\";\nimport {layoutTools} from \"../index\";\n\nexport const AutoDetectionBleBeacon = (zespInfo: ZespDeviceInfo): string | undefined => {\n  if (zespInfo.DevType !== \"BED\" || zespInfo.class !== \"beacon\") return undefined;\n\n  const rangeReport = layoutTools.getReport([\"ble_InRange\"], zespInfo);\n  const signalReport = layoutTools.getReport([\"ble_signal_level\"], zespInfo);\n  if (!rangeReport || !signalReport) return undefined;\n\n  return \"bleBeacon\";\n}\n\nexport default AutoDetectionBleBeacon;","import {DataLayoutItemsGroup} from \"../../models/DataControlSettings\";\nimport {Modal} from \"react-bootstrap\";\nimport React, {FunctionComponent} from \"react\";\nimport {DeviceInfo} from \"../../models/DeviceInfo\";\nimport {LayoutProps} from \"../../models/LayoutProps\";\nimport {DefaultLayout} from \"../../device-controls/layouts/DefaultLayout\";\nimport {layoutsAvailable} from \"../../device-controls/layouts\";\n\nexport default (props: {\n  device: DeviceInfo,\n  groups: DataLayoutItemsGroup[],\n  activeGroupName: string\n}) => {\n  const group = props.groups.find(x => x.name === props.activeGroupName);\n  if (!group) return (<div>Group '{props.activeGroupName}' not found.</div>)\n\n  const layoutProps: LayoutProps = {\n    device: props.device,\n    settings: group.settings\n  };\n\n  const layoutName = props.device.settings?.layout || \"default\";\n  const LayoutElements: FunctionComponent<LayoutProps> = layoutsAvailable[layoutName] || DefaultLayout;\n\n  return (\n    <Modal.Body className=\"text-start device-dialog p-4\">\n      <LayoutElements {...layoutProps}/>\n    </Modal.Body>\n  )\n}","import {useHistory} from \"react-router-dom\";\nimport React, {useEffect} from \"react\";\nimport toast from \"react-hot-toast\";\n\nexport default () => {\n  const history = useHistory();\n  useEffect(() => {\n    history.push(\"/devices\");\n    toast.error(\"Device information not found\");\n  }, []);\n  return (<></>);\n}","import React, {useState} from \"react\";\nimport \"./styles.scss\";\nimport {useHistory, useParams} from \"react-router-dom\";\nimport {Modal} from \"react-bootstrap\";\nimport {Devices} from \"../../services/devices\";\nimport CustomHeader from \"./header\";\nimport CustomBody from \"./body\";\nimport CustomDeviceNotFound from \"./not-found\";\nimport toast from \"react-hot-toast\";\nimport {getDeviceByIee} from \"../../store/slices/devicesSlice\";\nimport {useSelector} from \"react-redux\";\nimport {RootState} from \"../../store/configure\";\nimport {DeviceInfo} from \"../../models/DeviceInfo\";\n\nexport default () => {\n  const {ieee} = useParams<{ ieee: string }>();\n  const [show, setShow] = useState(true);\n  const history = useHistory();\n  const deviceInfo = useSelector((state: RootState) => getDeviceByIee(state, ieee), (a: DeviceInfo | undefined, b: DeviceInfo | undefined) => {\n    if (!a || !b) return false;\n    const keysA = Object.keys(a.zespInfo.Report);\n    const keysB = Object.keys(b.zespInfo.Report);\n\n    if (keysA.length != keysB.length) return false;\n    for (const key of keysA)\n      if (a.zespInfo.Report[key] !== b.zespInfo.Report[key]) return false;\n\n    return true;\n  });\n\n  if (!deviceInfo) return (<CustomDeviceNotFound/>);\n\n  const groups = Devices.getControlGroups(deviceInfo);\n  if (!groups || groups.length === 0) {\n    console.warn(`No controls found for '${deviceInfo.zespInfo.IEEE}' device`);\n    return (<CustomDeviceNotFound/>);\n  }\n\n  const [activeGroupName, setActiveGroupName] = useState(groups[0].name);\n\n  const handleClose = () => setShow(false);\n  const handleExit = () => setTimeout(() => history.push(\"/devices\"), 100);\n  const handleDetails = () => {\n    console.log(deviceInfo);\n    toast.success(\"Check console for logs\", {icon: \"👽\"});\n  }\n\n  return (\n    <Modal show={show} onHide={handleClose} onExited={handleExit}>\n      <CustomHeader\n        groups={groups}\n        device={deviceInfo}\n        activeGroupName={activeGroupName}\n        setActiveGroupName={setActiveGroupName}\n        onCloseClicked={handleClose}\n        onDetailsClicked={handleDetails}\n      />\n\n      <CustomBody\n        groups={groups}\n        device={deviceInfo}\n        activeGroupName={activeGroupName}/>\n    </Modal>\n  )\n}\n","import {FormEvent} from \"react\";\nimport $ from \"jquery\";\n\n// we need this 'any' type to provide general solution\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype IAction = (arg: any) => void;\n\nconst Result = {\n  handleSubmit: function handleSubmit(e: FormEvent, action: IAction) {\n    e.preventDefault();\n\n    // we need this 'any' type to provide general solution\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const data: any = {};\n\n    for (const input of $(e.target).find(\"input\")) {\n      const id = $(input).prop(\"id\");\n      if (id == null) return;\n\n      if ($(input).prop(\"type\") === \"checkbox\") {\n        if ($(input).prop(\"checked\") === true) data[id] = $(input).attr(\"checked_value\") || \"true\";\n        else data[id] = $(input).attr(\"unchecked_value\") || \"false\";\n      } else {\n        data[id] = $(input).val();\n      }\n    }\n    // console.log(data);\n    action(data)\n  }\n};\n\nexport default Result;","import React, {FormEvent} from \"react\";\nimport {Form} from \"react-bootstrap\";\n\nimport {IProps} from \"./interfaces\";\nimport $ from \"./logic\";\n\nconst ReactForm = (props: IProps) => {\n  const {onSubmit, ...restProps} = props;\n  const onSubmitForm = (event: FormEvent) => $.handleSubmit(event, onSubmit);\n\n  return (\n    <Form onSubmit={onSubmitForm} {...restProps}>\n      {props.children}\n    </Form>\n  );\n}\n\nexport {ReactForm};","import React, {useEffect, useRef, useState} from \"react\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {Button, Card} from \"react-bootstrap\";\nimport {ReactForm} from \"../../shared/form/react-form\";\nimport {Single} from \"../../services/single\";\nimport {AllMessagesZespResponseValidator} from \"../../services/zesp/common/ZespResponseValidators\";\n\nconst maxMessagesCount = 15;\nconst predefinedMessages = [\"getDeviceList\", \"get_Mi_lamp\", \"LoadJson|/location.json\", \"LoadJson|/groups.json\", \"LoadJson|/zesp_ui.json\"];\nconst predefinedBinary = [\"01 0000 01 0100\", \"01 0000 01 0000\"];\n\ninterface IFormData {\n  messageToSend?: string,\n}\n\nexport default () => {\n  const [messages, _setMessages] = useState<string[]>([]);\n  const [messageSendValue, setMessageSendValue] = useState<string>(\"\");\n  const [paused, _setPaused] = useState<boolean>(false);\n\n  const messagesRef = useRef(messages);\n  const pausedRef = useRef(paused);\n\n  const addMessages = (message: string) => {\n    if (pausedRef.current) return;\n\n    const data: string[] = [message.substr(0, 250), ...messagesRef.current];\n    const cutCount = data.length - maxMessagesCount;\n    if (cutCount > 0) data.splice(data.length - cutCount, cutCount)\n\n    messagesRef.current = data;\n    _setMessages(data);\n  }\n\n  const togglePause = () => {\n    const data = !pausedRef.current;\n    pausedRef.current = data;\n    _setPaused(data);\n  }\n\n  const onSend = (data: IFormData) => {\n    if (!data.messageToSend) return;\n    addMessages(`>${data.messageToSend}`);\n    Single.ZespConnector.send({data: data.messageToSend});\n  }\n\n  const onSendPredefined = (event: React.MouseEvent): void => {\n    const el = event.target as HTMLButtonElement;\n    const data = el.innerText;\n    setMessageSendValue(data);\n  }\n\n  const onSendBinary = (message?: string | null): void => {\n    const data = message || messageSendValue;\n    Single.ZespConnector.send({data: data, isBinary: true});\n\n    // const dataHex = data.match(/[\\da-f]{2}/gi)?.map(group => parseInt(group, 16)) as ArrayLike<number>;\n    // const dataToSend = new Uint8Array(dataHex);\n    //\n    // addMessages(`>bin: ${data} (${dataToSend})`);\n    // Single.ZespConnector.send(dataToSend);\n  }\n\n  const onClearLog = () => {\n    messagesRef.current = [];\n    _setMessages([]);\n  }\n\n  useEffect(() => {\n    const listener = Single.ZespConnector.subscribe(AllMessagesZespResponseValidator, (event) => {\n      const message = event.response;\n      addMessages(message);\n    });\n    return () => Single.ZespConnector.unsubscribe(listener);\n  }, []);\n\n  return (\n\n    <FadeIn>\n      <ReactForm onSubmit={onSend}>\n        <Card>\n          <Card.Header>WebSocket tester (FOR DEVELOPMENT ONLY)</Card.Header>\n          <Card.Body>\n            <div className=\"row mb-2\">\n              <label className=\"col-md-3 col-lg-2\">Message to send</label>\n              <div className=\"col\">\n                <input type=\"text\" className=\"form-control\" id=\"messageToSend\" value={messageSendValue} onChange={event => setMessageSendValue(event.target.value)}/>\n              </div>\n            </div>\n            <div className=\"row\">\n              <div className=\"col-md-3 col-lg-2\"/>\n              <div className=\"col\">\n                <div>\n                  {predefinedMessages.map((x, i) => (\n                    <button key={i} type=\"submit\" className=\"btn btn-sm btn-outline-primary me-1\" onClick={onSendPredefined}>{x}</button>\n                  ))}\n                </div>\n                <div className=\"mt-1\">\n                  {predefinedBinary.map((x, i) => (\n                    <button key={i} type=\"button\" className=\"btn btn-sm btn-outline-secondary me-1\" onClick={() => {\n                      setMessageSendValue(x);\n                      onSendBinary(x);\n                    }}>{x}</button>\n                  ))}\n                </div>\n              </div>\n            </div>\n          </Card.Body>\n          <Card.Footer>\n            <Button variant=\"primary\" type=\"submit\">Send message</Button>\n            <Button variant=\"secondary\" type=\"button\" onClick={() => onSendBinary()} className=\"ms-2\">Send binary</Button>\n          </Card.Footer>\n        </Card>\n      </ReactForm>\n\n      <Card className=\"mt-4\">\n        <Card.Header>\n          <span>Communication log <span className=\"badge bg-secondary small\">{messages.length}</span></span>\n          <button className=\"btn btn-outline-secondary ms-3 btn-sm\" onClick={onClearLog}>Clear log</button>\n          <button className=\"btn btn-outline-secondary ms-3 btn-sm\" onClick={() => togglePause()}>{paused ? \"Start logs\" : \"Pause logs\"}</button>\n        </Card.Header>\n        <Card.Body>\n          {messages.map((message, i) => message.startsWith(\">\")\n            ? (<div key={i} className=\"px-2 mb-3 py-1 m-1 bg-success bg-opacity-25 rounded\">{message.substr(1)}</div>)\n            : (<div key={i} className=\"border-start mb-3 border-3 border-warning p-0 d-flex flex-wrap\">{message.split(\"|\").map((x, i2) => (\n              <span key={i2} className=\"bg-warning bg-opacity-25 m-1 px-2 rounded\">{x}</span>\n            ))}</div>))}\n        </Card.Body>\n      </Card>\n    </FadeIn>\n  );\n}","import React from \"react\";\nimport {Col, Form, Row} from \"react-bootstrap\";\n\ntype Props = {\n  defaultValue?: string | number | boolean | undefined;\n  controlId: string;\n  label: string;\n  placeholder?: string;\n  type?: \"text\" | \"password\";\n};\n\nconst Result = ({controlId, label, placeholder, defaultValue, type = \"text\"}: Props) => {\n  let inputProps = ({\n    placeholder,\n    type\n  });\n\n  if (defaultValue) inputProps = ({...inputProps, ...{defaultValue: defaultValue.toString()}});\n\n  return (\n    <Form.Group as={Row} className=\"mb-3\" controlId={controlId}>\n      <Form.Label column md=\"3\" lg=\"2\">{label}</Form.Label>\n      <Col>\n        <Form.Control {...inputProps} />\n      </Col>\n    </Form.Group>\n  );\n}\n\nexport default Result;\n","import React from \"react\";\nimport {Form} from \"react-bootstrap\";\n\ntype IProps = {\n  defaultChecked?: boolean | number | string;\n  controlId: string;\n  label: string;\n  checkedValue?: string | number | boolean | undefined;\n  uncheckedValue?: string | number | boolean | undefined;\n};\n\nconst Result = ({controlId, label, defaultChecked, checkedValue = \"true\", uncheckedValue = \"false\"}: IProps) => {\n  const defaultCheckedBool =\n    defaultChecked === \"true\" ||\n    defaultChecked === \"1\" ||\n    defaultChecked === 1 ||\n    defaultChecked === true ||\n    false;\n\n  let props = {checked_value: checkedValue, unchecked_value: uncheckedValue};\n  if (defaultChecked) props = ({...props, ...{defaultChecked: defaultCheckedBool}});\n\n  return (\n    <Form.Group controlId={controlId} className=\"d-inline-block\">\n      <Form.Label className=\"d-flex\">\n        <Form.Check className=\"pe-2\" {...props}/><span>{label}</span>\n      </Form.Label>\n    </Form.Group>\n  );\n}\n\nexport default Result;","import React from \"react\";\nimport {useTranslation} from \"react-i18next\";\nimport {Button, Card, Col, Row} from \"react-bootstrap\";\nimport {CheckGroupInline, InputGroupHorizontal} from \"../../shared/form\";\nimport {ReactForm} from \"../../shared/form/react-form\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {ZespMqttSettings} from \"../../services/zesp/models/ZespSettings\";\nimport {SaveSettings} from \"./index\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {getSettings} from \"../../store/slices/settingsSlice\";\n\nconst Result = () => {\n  const dispatch = useDispatch();\n  const allSettings = useSelector(getSettings);\n  const {t} = useTranslation([\"pages.setup-mqtt\", \"common\"]);\n\n  if (!allSettings) return (<div>No settings found...</div>);\n  const settings = allSettings.MQTT;\n\n  const onSubmit = (data: ZespMqttSettings) => SaveSettings({MQTT: data}, allSettings, dispatch);\n\n  return (\n    <FadeIn>\n      <Card>\n        <ReactForm onSubmit={onSubmit}>\n          <Card.Body>\n            <InputGroupHorizontal controlId=\"mqttup\" defaultValue={settings.mqttup} label={t(\"topic.label\")} placeholder={t(\"topic.placeholder\")}/>\n            <InputGroupHorizontal controlId=\"mqtt\" defaultValue={settings.mqtt} label={t(\"server.label\")} placeholder={t(\"server.placeholder\")}/>\n            <InputGroupHorizontal controlId=\"mqttPort\" defaultValue={(settings.mqttPort)?.toString()} label={t(\"port.label\")} placeholder={t(\"port.placeholder\")}/>\n            <InputGroupHorizontal controlId=\"mqttLogin\" defaultValue={settings.mqttLogin} label={t(\"login.label\")} placeholder={t(\"login.placeholder\")}/>\n            <InputGroupHorizontal type=\"password\" controlId=\"mqttPassw\" defaultValue={settings.mqttPassw} label={t(\"password.label\")} placeholder={t(\"password.placeholder\")}/>\n            <Row>\n              <Col md=\"3\" lg=\"2\"/>\n              <Col className=\"space-between-4\">\n                <CheckGroupInline controlId=\"mqttEnable\" defaultChecked={settings.mqttEnable} label={t(\"is_enabled.label\")} checkedValue={1} uncheckedValue={0}/>\n                <CheckGroupInline controlId=\"Home_Assistant\" defaultChecked={settings.Home_Assistant} label={t(\"is_ha_enabled.label\")} checkedValue={1} uncheckedValue={0}/>\n              </Col>\n            </Row>\n\n          </Card.Body>\n          <Card.Footer><Button variant=\"primary\" type=\"submit\">{t(\"common:save_button\")}</Button></Card.Footer>\n        </ReactForm>\n      </Card>\n    </FadeIn>\n  );\n}\n\nexport default Result;","import React from \"react\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\n\nconst Result = () => (\n  <FadeIn>\n    <div className=\"px-4 py-5 bg-light rounded-3\">\n      <div className=\"container-fluid\">\n        <h1 className=\"display-5 fw-bold\">Not implemented yet!</h1>\n        <p className=\"col-md-8 fs-4\">\n          Hello, my dear friend! Just imagine how awesome this feature can be and share it with developers ~_~ <br/><br/>\n          Or you can even implement it yourself, everything you need is just to jump to source codes, made some magic, test it and that's it!\n        </p>\n        <hr className=\"my-4\"/>\n        <p>This feature is under contruction. You can find latest verion on <a href=\"#\">github project page</a> or just click this big blue button bellow.</p>\n        <a href=\"#\" target={\"_blank\"} rel=\"noreferrer\" className=\"btn btn-primary btn-lg\" type=\"button\">Learn more</a>\n      </div>\n    </div>\n    {/*<div className=\"jumbotron\">*/}\n    {/*  <h1 className=\"display-4\">Not implemented yet!</h1>*/}\n    {/*  <p className=\"lead\">*/}\n    {/*    Hello, my dear friend! Just imagine how awesome this feature can be and share it with developers ~_~ <br/>*/}\n    {/*    Or you can even implement it yourself, everything you need is just to jump to source codes, made some magic, test it and that's it!*/}\n    {/*  </p>*/}\n    {/*  <hr className=\"my-4\"/>*/}\n    {/*  <p>This feature is under contruction. You can find latest verion on <a href=\"#\">github project page</a> or just click this big blue button bellow.</p>*/}\n    {/*  <a className=\"btn btn-primary btn-lg\" href=\"#\" target={\"_blank\"} rel=\"noreferrer\" role=\"button\">Learn more</a>*/}\n    {/*</div>*/}\n  </FadeIn>\n);\n\nexport default Result;","import React, {Fragment} from \"react\";\nimport {Button, Card} from \"react-bootstrap\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {useTranslation} from \"react-i18next\";\nimport {ReactForm} from \"../../shared/form/react-form\";\nimport {InputGroupHorizontal} from \"../../shared/form\";\nimport {ZespWifiSettings} from \"../../services/zesp/models/ZespSettings\";\nimport {SaveSettings} from \"./index\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {getSettings} from \"../../store/slices/settingsSlice\";\n\nconst Result = () => {\n  const dispatch = useDispatch();\n  const allSettings = useSelector(getSettings);\n  const {t} = useTranslation([\"pages.setup-wifi\", \"common\"]);\n\n  if (!allSettings) return (<div>No settings found...</div>);\n  const settings = allSettings.Wifi;\n\n  const onSubmit = (data: ZespWifiSettings): Promise<void> => SaveSettings({Wifi: data}, allSettings, dispatch);\n\n  return (\n    <Fragment>\n      <FadeIn>\n        <ReactForm onSubmit={onSubmit}>\n          <Card>\n            <Card.Body>\n              <InputGroupHorizontal controlId=\"ssid\" defaultValue={settings?.ssid} label={t(\"ssid.label\")} placeholder={t(\"ssid.placeholder\")}/>\n              <InputGroupHorizontal type=\"password\" controlId=\"pass\" defaultValue={settings?.pass} label={t(\"pass.label\")} placeholder={t(\"pass.placeholder\")}/>\n              <InputGroupHorizontal controlId=\"ip\" defaultValue={settings?.ip} label={t(\"ip.label\")} placeholder={t(\"ip.placeholder\")}/>\n              <InputGroupHorizontal controlId=\"mask\" defaultValue={settings?.mask} label={t(\"mask.label\")} placeholder={t(\"mask.placeholder\")}/>\n              <InputGroupHorizontal controlId=\"gw\" defaultValue={settings?.gw} label={t(\"gw.label\")} placeholder={t(\"gw.placeholder\")}/>\n            </Card.Body>\n            <Card.Footer><Button variant=\"primary\" type=\"submit\">{t(\"common:save_button\")}</Button></Card.Footer>\n          </Card>\n        </ReactForm>\n      </FadeIn>\n    </Fragment>\n  )\n};\n\nexport default Result;","import {createSlice, PayloadAction} from \"@reduxjs/toolkit\";\nimport {RootState} from \"../configure\";\n\nexport interface ZespState {\n  connectionStatus: \"disconnected\" | \"connected\",\n  initialized: boolean,\n}\n\nconst initialState: ZespState = {\n  connectionStatus: \"disconnected\",\n  initialized: false\n}\n\nexport const zespSlice = createSlice({\n  name: \"zesp\",\n  initialState,\n  reducers: {\n    setConnected: (state) => {\n      state.connectionStatus = \"connected\";\n    },\n\n    setDisconnected: (state) => {\n      state.connectionStatus = \"disconnected\"\n    },\n\n    setInitialized: (state, action: PayloadAction<boolean>) => {\n      state.initialized = action.payload;\n    }\n  }\n})\n\nconst getters = {\n  getStatus: (state: RootState) => state.zesp.connectionStatus,\n  getInitialized: (state: RootState) => state.zesp.initialized\n}\n\nexport const {getStatus, getInitialized} = getters;\nexport const {setConnected, setDisconnected, setInitialized} = zespSlice.actions;\nexport default zespSlice.reducer;","import React, {Fragment} from \"react\";\nimport {Redirect, Route} from \"react-router-dom\";\nimport {DeviceInfoPage, DevicesPage, SetupPage, SocketTestPage} from \"./pages\";\nimport {NotImplementedYetPage, SetupMqttPage, SetupWifiPage} from \"./pages/setup/setup-pages\";\nimport {getInitialized} from \"./store/slices/zespSlice\"\nimport {setSpinnerShow} from \"./store/slices/spinnerSlice\"\nimport {useDispatch, useSelector} from \"react-redux\";\n\nexport const Routes = () => {\n  const isInitialized = useSelector(getInitialized);\n  const dispatch = useDispatch();\n\n  if (!isInitialized) {\n    // return (<div>Initialization...</div>);\n    setTimeout(() => dispatch(setSpinnerShow(true)), 0);\n    return (<Fragment/>);\n  }\n\n  setTimeout(() => dispatch(setSpinnerShow(false)), 300);\n\n  return (\n    <Fragment>\n      {/*<Route exact path=\"/\" component={MainPage}/>*/}\n      <Route exact path=\"/\"><Redirect to=\"/devices\"/></Route>\n      <Route path=\"/devices\" component={DevicesPage}/>\n      <Route path=\"/devices/:ieee\" component={DeviceInfoPage}/>\n      <Route path=\"/setup\" component={SetupPage}/>\n      <Route exact path=\"/setup\" component={SetupWifiPage}/>\n      <Route path=\"/setup/mqtt\" component={SetupMqttPage}/>\n      <Route path=\"/setup/zigbee\" component={NotImplementedYetPage}/>\n      <Route path=\"/setup/telegram\" component={NotImplementedYetPage}/>\n      <Route path=\"/setup/z2m\" component={NotImplementedYetPage}/>\n      <Route path=\"/setup/zesp-ui\" component={NotImplementedYetPage}/>\n      <Route path=\"/socket-test\" component={SocketTestPage}/>\n    </Fragment>\n  )\n}","import React from \"react\";\nimport \"./styles.scss\";\nimport {Card} from \"react-bootstrap\";\nimport {NavLink} from \"react-router-dom\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {IServerInfo} from \"./interfaces\";\nimport {useTranslation} from \"react-i18next\";\n\ninterface IProps {\n  openAddServer: () => void,\n  openEditAction: (server: IServerInfo) => void,\n  openServerAction: (index: number) => void,\n  servers: IServerInfo[]\n}\n\nexport default (props: IProps) => {\n  const {t} = useTranslation(\"pages.welcome\");\n  const sortedServers = props.servers\n    .map((server, index) => ({server, index}))\n    .sort((a, b) => a.server.name > b.server.name ? 1 : -1);\n\n  return (\n    <div className=\"container welcome-page h-100\">\n      <FadeIn>\n        <Card className=\"text-start\">\n          <Card.Header>{t(\"list.title\")}</Card.Header>\n          <Card.Body>\n            {props.servers.length == 0 && (\n              <div>{t(\"list.add_message\")}</div>\n            )}\n            {props.servers.length > 0 && (\n              <nav className=\"servers-list\">\n                {sortedServers.map((data, i) => (\n                  <div className=\"item\" key={`item-${i}`}>\n                    <NavLink\n                      className=\"server-button\"\n                      to=\"/\"\n                      onClick={(e) => {\n                        props.openServerAction(data.index);\n                        e.preventDefault();\n                      }}\n                      activeClassName=\"none\"><i className=\"bi bi-caret-right-fill\"/> {data.server.name}</NavLink>\n                    <button type=\"button\" onClick={() => props.openEditAction(data.server)} className=\"edit-button\"><i className=\"bi bi-pencil-fill\"/></button>\n                  </div>\n                ))}\n              </nav>\n            )}\n          </Card.Body>\n          <Card.Footer className=\"text-right\">\n            <button type=\"button\" onClick={props.openAddServer} className=\"btn btn-primary\">{t(\"list.add_button\")}</button>\n          </Card.Footer>\n        </Card>\n      </FadeIn>\n    </div>\n  )\n}","import React, {useState} from \"react\";\nimport \"./styles.scss\";\nimport {Card, FormControl, InputGroup, OverlayTrigger, Popover} from \"react-bootstrap\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {IServerInfo} from \"./interfaces\";\nimport {ReactForm} from \"../../shared/form/react-form\";\nimport {useTranslation} from \"react-i18next\";\n\ninterface IProps {\n  closeAction: () => void;\n  deleteAction: () => void;\n  addAction: (data: IServerInfo) => void;\n  updateAction: (data: IServerInfo) => void;\n  editServer?: IServerInfo;\n}\n\nexport default (props: IProps) => {\n  const {t} = useTranslation(\"pages.welcome\");\n  const [deleteConfirmed, setDeleteConfirmed] = useState(false);\n\n  const onSubmit = (data: IServerInfo): Promise<void> => {\n    if (props.editServer) props.updateAction(data);\n    else props.addAction(data);\n\n    return Promise.resolve();\n  }\n\n  const onDeleteClicked = () => {\n    if (!deleteConfirmed) return;\n    props.deleteAction();\n  }\n\n  const popover = (\n    <Popover id=\"popover-basic\">\n      <Popover.Header as=\"h3\">{t(\"edit.delete_title\")}</Popover.Header>\n      <Popover.Body><span dangerouslySetInnerHTML={{__html: t(\"edit.delete_message\")}}/></Popover.Body>\n    </Popover>\n  );\n\n  return (\n    <div className=\"container welcome-page h-100\">\n      <FadeIn>\n        <ReactForm onSubmit={onSubmit}>\n          <Card className=\"text-start\">\n            <Card.Header className=\"d-flex justify-content-between\">\n              <span className=\"modal-title\">{t(\"edit.title\")}</span>\n              <button type=\"button\" className=\"btn-close\" aria-label=\"Close\" onClick={props.closeAction}/>\n            </Card.Header>\n            <Card.Body>\n              <FormControl className=\"mb-2\" id=\"name\" defaultValue={props.editServer?.name} placeholder={t(\"edit.name_input_placeholder\")}/>\n              <InputGroup>\n                <InputGroup.Text id=\"basic-addon3\">{document.location.protocol === \"https:\" ? \"wss\" : \"ws\"}://</InputGroup.Text>\n                <FormControl id=\"address\" defaultValue={props.editServer?.address} aria-describedby=\"basic-addon3\" placeholder={t(\"edit.address_input_placeholder\")}/>\n              </InputGroup>\n            </Card.Body>\n\n            {props.editServer && (\n              <Card.Footer className=\"d-flex justify-content-between\">\n                {/*<button type=\"button\" onClick={props.deleteAction} className=\"btn btn-outline-danger\">Delete</button>*/}\n                <div>\n                  <OverlayTrigger trigger=\"click\" placement=\"top\" overlay={popover} rootClose={true} onToggle={setDeleteConfirmed}>\n                    <button onClick={onDeleteClicked} type=\"button\" className=\"btn btn-outline-danger\">{t(\"edit.delete_button\")}</button>\n                  </OverlayTrigger>\n                </div>\n                <button type=\"submit\" className=\"btn btn-primary\">{t(\"edit.save_button\")}</button>\n              </Card.Footer>\n            )}\n\n            {!props.editServer && (\n              <Card.Footer className=\"text-right\">\n                <button type=\"submit\" className=\"btn btn-primary\">{t(\"edit.add_button\")}</button>\n              </Card.Footer>\n            )}\n          </Card>\n        </ReactForm>\n      </FadeIn>\n    </div>\n  )\n}","import React, {FunctionComponent, useState} from \"react\";\nimport \"./styles.scss\";\nimport {IServerInfo, WelcomePageParts} from \"./interfaces\";\nimport PartItems from \"./part-items\";\nimport PartEdit from \"./part-edit\";\nimport {useLocalStorage} from \"../../services/localStorage\";\n\ninterface IProps {\n  setServerIndex: (index: number) => void\n}\n\nexport const WelcomePage: FunctionComponent<IProps> = (props: IProps) => {\n  const [currentPart, setCurrentPart] = useState<WelcomePageParts>(\"welcome\");\n  const [editServer, setEditServer] = useState<IServerInfo>();\n  const [servers, setServers] = useLocalStorage<IServerInfo[]>(\"servers\", []);\n\n  // const servers: IServerInfo[] = [];\n\n  const backToWelcomeAction = () => {\n    setEditServer(undefined);\n    setCurrentPart(\"welcome\");\n  }\n\n  const openAddAction = () => {\n    setEditServer(undefined);\n    setCurrentPart(\"edit\");\n  }\n\n  const openEditAction = (server: IServerInfo) => {\n    setEditServer(server);\n    setCurrentPart(\"edit\");\n  }\n\n  const addAction = (server: IServerInfo) => {\n    servers.push(server)\n    setServers(servers);\n    backToWelcomeAction();\n  }\n\n  const updateAction = (server: IServerInfo) => {\n    const index = servers.indexOf(editServer!);\n    servers[index] = server;\n    setServers(servers);\n\n    console.log(servers);\n    backToWelcomeAction();\n  }\n\n  const deleteAction = () => {\n    setServers(servers.filter(server => server !== editServer));\n    backToWelcomeAction();\n  };\n\n  const openServerAction = (index: number) => props.setServerIndex(index);\n\n  if (currentPart === \"edit\") return (\n    <PartEdit editServer={editServer} addAction={addAction} updateAction={updateAction} closeAction={backToWelcomeAction} deleteAction={deleteAction}/>);\n  return (<PartItems servers={servers} openAddServer={openAddAction} openEditAction={openEditAction} openServerAction={openServerAction}/>);\n}","import {ZespDataEvent} from \"./common/ZespDataEvent\";\nimport {ZespDeviceInfo} from \"./models/ZespDeviceInfo\";\nimport {IZespConnector} from \"./interfaces/IZespConnector\";\nimport {TypedZespResponseValidator} from \"./common/ZespResponseValidators\";\nimport predefinedDevices from \"../../data/devices.json\";\nimport {DataControlSettings} from \"../../models/DataControlSettings\";\nimport {DeviceInfo} from \"../../models/DeviceInfo\";\nimport {DataDeviceSettings} from \"../../models/DataDeviceSettings\";\nimport {ZespReportInfo} from \"./models/ZespReportInfo\";\nimport {layoutTools} from \"../../device-controls/layouts\";\n\nconst ServiceDevices = {\n  getDevicesListAsync: (zesp: IZespConnector) => new Promise<DeviceInfo[]>((resolve, reject) => {\n    zesp.requestAsync({\n      data: \"getDeviceList\",\n      responseValidator: TypedZespResponseValidator(\"alldev\")\n    })\n      .then(event => {\n        const result = onDevicesListReceived(event);\n        resolve(result);\n      })\n      .catch(reason => reject(reason));\n  })\n}\n\n// when list of devices received from ZESP\nconst onDevicesListReceived = (event: ZespDataEvent): DeviceInfo[] => {\n  const jsonString: string = event.dataParts[0];\n  const zespDevices: ZespDeviceInfo[] = [];\n  Object.assign(zespDevices, JSON.parse(jsonString))\n\n  return zespDevices.map(buildDeviceInfo);\n}\n\nexport const getDeviceModelSettings = (modelId: string): { settings: DataDeviceSettings, controls: DataControlSettings[] } => {\n  const settings: DataDeviceSettings = predefinedDevices.find(x => x.modelIds.findIndex(y => y === modelId) >= 0) || {} as DataDeviceSettings;\n  const controls = settings?.controls && require(`../../data/controls/${settings.controls}`) as DataControlSettings[] || [];\n\n  return {settings, controls};\n}\n\nconst buildDeviceInfo = (zespInfo: ZespDeviceInfo): DeviceInfo => {\n  const {settings, controls} = getDeviceModelSettings(zespInfo.ModelId);\n  controls.forEach(control => {\n    if (!control.reportKey) return;\n    const reportKey = control.reportKey.endpoint + control.reportKey.clusterId + control.reportKey.attributeId;\n    if (!zespInfo.Report[reportKey]) zespInfo.Report[reportKey] = {} as ZespReportInfo;\n  });\n\n  // try to autodetect layout by reports\n  const layout = settings.layout || layoutTools.autoDetect(zespInfo);\n\n  return {\n    zespInfo: zespInfo,\n    settings: {...settings, ...{layout: layout}},\n    customLayout: controls\n  };\n}\n\nexport default ServiceDevices;\n","import {IZespConnector} from \"./interfaces/IZespConnector\";\nimport {TypedZespResponseValidator} from \"./common/ZespResponseValidators\";\nimport {ZespDataEvent} from \"./common/ZespDataEvent\";\nimport {ZespDeviceUpdate} from \"./models/ZespDeviceUpdate\";\nimport {ZespReportInfo} from \"./models/ZespReportInfo\";\n\nexport default {\n  subscribeToEvents: (zesp: IZespConnector, onReport: (ieee: string, reportKey: string, updates: Partial<ZespReportInfo>) => void) => {\n    zesp.subscribe(TypedZespResponseValidator(\"rep\"), event => onUpdate(event, onReport))\n  }\n}\n\nconst onUpdate = (event: ZespDataEvent, onReport: (ieee: string, reportKey: string, updates: Partial<ZespReportInfo>) => void): void => {\n  // we are expecting 'rep|{...}' string\n  if (event.dataParts.length < 2) {\n    console.warn(\"Unknown format of updated received\");\n    console.warn(event.response);\n    return;\n  }\n\n  const ieee = event.dataParts[1];\n  const data = JSON.parse(event.dataParts[0]) as ZespDeviceUpdate;\n  const reportKey = data.EndPoint + data.ClusterId + data.AttribId;\n  const report = {\n    parsed: data.parsed,\n    val: data.Data,\n    time: data.time,\n  } as Partial<ZespReportInfo>\n\n  onReport(ieee, reportKey, report);\n}","import {IZespConnector} from \"./interfaces/IZespConnector\";\nimport {TypedZespResponseValidator} from \"./common/ZespResponseValidators\";\nimport {ZespDataEvent} from \"./common/ZespDataEvent\";\nimport {ZespRootData} from \"./models/ZespRootData\";\nimport {ZespReportInfo} from \"./models/ZespReportInfo\";\nimport {getDeviceModelSettings} from \"./service-devices\";\n\nexport default {\n  getRootDataAsync: (zesp: IZespConnector) => new Promise<ZespReportUpdates>((resolve, reject) => {\n    zesp.requestAsync({\n      data: \"get_Mi_lamp\",\n      responseValidator: TypedZespResponseValidator(\"Mi_lamp\"),\n    })\n      .then(event => {\n        const result = extractReports(event);\n\n        if (result) resolve(result);\n        else reject(\"Cannot update root device information\");\n      })\n      .catch(reason => reject(reason));\n  }),\n}\n\nexport type ZespReportUpdates = {\n  [key: string]: Partial<ZespReportInfo>\n}\n\nconst extractReports = (event: ZespDataEvent): ZespReportUpdates => {\n  const {controls} = getDeviceModelSettings(\"ZESP_Root\");\n  if (controls.length == 0) return {};\n\n  const data = JSON.parse(event.dataParts[0]) as ZespRootData;\n  const result: ZespReportUpdates = {};\n\n  const reportOnOff = controls.find(x => x.id === \"on_off_root\")?.reportKey;\n  if (reportOnOff) result[reportOnOff.endpoint + reportOnOff.clusterId + reportOnOff.attributeId] = {val: data.on.toString()};\n  else console.warn(\"Root device report 'on_off_root' not found\");\n\n  const reportLevel = controls.find(x => x.id === \"level_root\")?.reportKey;\n  if (reportLevel) result[reportLevel.endpoint + reportLevel.clusterId + reportLevel.attributeId] = {val: data.level.toString()};\n  else console.warn(\"Root device report 'level_root' not found\");\n\n  // ZESP returns wrong colors red and blue swapped\n  const reportRgb = controls.find(x => x.id === \"rgb_root\")?.reportKey;\n  if (reportRgb) result[reportRgb.endpoint + reportRgb.clusterId + reportRgb.attributeId] = {val: `${data.B}:${data.G}:${data.R}`};\n  else console.warn(\"Root device report 'rgb_root' not found\");\n\n  const volumeLevel = controls.find(x => x.id === \"level_control\")?.reportKey;\n  if (volumeLevel) result[volumeLevel.endpoint + volumeLevel.clusterId + volumeLevel.attributeId] = {val: data.sound.volume.toString()};\n  else console.warn(\"Root device report 'level_control' not found\");\n\n  const srcRadio = controls.find(x => x.id === \"player_src_root\")?.reportKey;\n  if (srcRadio) result[srcRadio.endpoint + srcRadio.clusterId + srcRadio.attributeId] = {val: data.sound.current_path?.toString()};\n  else console.warn(\"Root device report 'player_src_root' not found\");\n\n  const playControl = controls.find(x => x.id === \"player_control_root\")?.reportKey;\n  if (playControl) result[playControl.endpoint + playControl.clusterId + playControl.attributeId] = {val: data.sound.play.toString()};\n  else console.warn(\"Root device report 'player_control_root' not found\");\n\n  return result;\n}\n\n","import React, {Fragment} from \"react\";\nimport {Single} from \"../../services/single\";\nimport ServiceDevices from \"../../services/zesp/service-devices\";\nimport ServiceUpdates from \"../../services/zesp/service-report-updates\";\nimport ServiceRoot from \"../../services/zesp/service-root\";\nimport {IServerInfo} from \"../../pages/welcome/interfaces\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {setConnected, setDisconnected, getStatus, setInitialized} from \"store/slices/zespSlice\";\nimport {setDevices, updateReport, updateRootReports} from \"store/slices/devicesSlice\";\nimport {IZespConnector} from \"../../services/zesp/interfaces/IZespConnector\";\nimport {ZespReportInfo} from \"../../services/zesp/models/ZespReportInfo\";\n\ninterface IProps {\n  server: IServerInfo\n}\n\nexport const ZespAgent = (props: IProps) => {\n  const dispatch = useDispatch();\n  const zespStatus = useSelector(getStatus);\n\n  if (zespStatus === \"connected\") {\n    return (<Fragment/>);\n  }\n\n  Single.ZespConnector\n    .connectAsync(props.server, (status) => dispatch(status ? setConnected() : setDisconnected()))\n\n    .then(zesp => new Promise<IZespConnector>((resolve, reject) => {\n      ServiceDevices.getDevicesListAsync(zesp)\n        .then(devices => {\n          dispatch(setDevices(devices));\n          resolve(zesp);\n        })\n        .catch(reason => reject(reason));\n    }))\n\n    .then(zesp => new Promise<IZespConnector>((resolve, reject) => {\n      ServiceRoot\n        .getRootDataAsync(zesp)\n        .then(reports => {\n          dispatch(updateRootReports(reports))\n          resolve(zesp);\n          console.debug(\"Root device reports updated\");\n        })\n        .catch(reason => reject(reason));\n    }))\n\n    .then(zesp => {\n      const onReport = (ieee: string, reportKey: string, update: Partial<ZespReportInfo>) => {\n        dispatch(updateReport({ieee, reportKey, update}));\n      };\n\n      ServiceUpdates.subscribeToEvents(zesp, onReport);\n    })\n    .then(() => dispatch(setInitialized(true)))\n    .catch(reason => console.error(reason))\n    .finally(() => console.debug(\"ZESP initialization completed\"));\n\n  return (<Fragment/>);\n}\n","import React, {useState} from 'react';\nimport {BrowserRouter as Router, Switch} from \"react-router-dom\";\nimport './bootstrap-updates.scss';\nimport './App.scss';\nimport TopMenu from \"./shared/top-menu\";\nimport LoadingSpinner from \"./shared/loading-spinner\";\nimport {Toaster} from \"react-hot-toast\";\nimport {Routes} from \"./Routes\";\nimport {WelcomePage} from \"./pages/welcome\";\nimport {IServerInfo} from \"./pages/welcome/interfaces\";\nimport {ZespAgent} from \"./shared/agents/ZespAgent\";\n\nconst Content = () => {\n  const [serverIndex, setServerIndex] = useState<number | null>(null);\n  const serversString = window.localStorage.getItem(\"servers\");\n  const servers = (serversString && JSON.parse(serversString)) || [];\n  const selectedServer = (serverIndex === null || servers.length <= serverIndex!)\n    ? null\n    : servers[serverIndex!];\n\n\n  return selectedServer ? (<App server={selectedServer}/>) : (<WelcomePage setServerIndex={setServerIndex}/>);\n}\n\nconst App = (props: { server: IServerInfo }) => {\n  return (\n    <>\n      <ZespAgent server={props.server}/>\n      <div className=\"container-md d-flex w-100 h-100 p-3 mx-auto flex-column\">\n        <header className=\"masthead\">\n          <a href=\"/\"><h3 className=\"masthead-brand\">ZESP:UI</h3></a>\n          <TopMenu/>\n        </header>\n        <main role=\"main\" className=\"text-start d-flex flex-grow-1 flex-column\">\n          <Routes/>\n        </main>\n        <footer className=\"mastfoot mt-3\">\n          <p>ZESP UI application, by <a href=\"https://t.me/NickRimmer\" target={\"_blank\"} rel=\"noreferrer\">@NickRimmer</a>. (0.0.0 version, <span>dev build</span>)\n          </p>\n        </footer>\n      </div>\n    </>\n  )\n}\n\nconst Result = () => {\n  return (\n    <>\n      <Router>\n        <Switch>\n          <Content/>\n        </Switch>\n      </Router>\n\n      <LoadingSpinner/>\n      <Toaster/>\n    </>\n  );\n}\n\nexport default Result;\n","import {ReportHandler} from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({getCLS, getFID, getFCP, getLCP, getTTFB}) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import {configureStore} from '@reduxjs/toolkit'\nimport zespReducer from \"./slices/zespSlice\";\nimport devicesReducer from \"./slices/devicesSlice\";\nimport spinnerReducer from \"./slices/spinnerSlice\";\nimport settingsSlice from \"./slices/settingsSlice\";\n\nexport const store = configureStore({\n  reducer: {\n    zesp: zespReducer,\n    devices: devicesReducer,\n    spinner: spinnerReducer,\n    settings: settingsSlice,\n  }\n})\n\nexport type RootState = ReturnType<typeof store.getState>\nexport type AppDispatch = typeof store.dispatch;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport './loader.js';\nimport \"bootstrap/dist/js/bootstrap.bundle\";\nimport './i18n/config';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport {Provider} from \"react-redux\";\nimport {store} from \"./store/configure\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App/>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import i18n from \"i18next\";\nimport {initReactI18next} from \"react-i18next\";\n\nconst languages = [\"en\"];\nconst namespaces = [\n    \"common\",\n    \"nav\",\n    \"pages.setup-mqtt\",\n    \"pages.setup-wifi\",\n    \"pages.welcome\",\n    \"pages.devices\",\n];\n\nconst i18next = i18n.use(initReactI18next);\ni18next.init({\n    fallbackLng: languages[0],\n    lng: languages[0],\n    resources: loadResources(),\n    ns: namespaces,\n    defaultNS: 'common'\n});\ni18n.languages = languages;\n\nfunction loadResources() {\n    const result = {};\n\n    for (let lang of languages) {\n        result[lang] = {};\n\n        for (let ns of namespaces) {\n            const path = `./locales/${lang}/${ns.replace(\".\", \"/\")}.json`;\n            try {\n                // eslint-disable-next-line \n                result[lang][ns] = require('' + path); // wtf with JS???\n                console.debug(`${path} (ok)`);\n            } catch (error) {\n                // it's ok\n                console.debug(`${path} (error)`);\n            }\n        }\n    }\n\n    return result;\n}\n\nexport default i18n;"],"sourceRoot":""}