{"version":3,"sources":["loader.js","i18n sync /^.*$","services/zesp/enums/CloseEventCodes.tsx","services/zesp/common/ZespConnector.tsx","shared/top-menu/index.tsx","shared/global-state-provider/state-logic.tsx","global-state.tsx","shared/loading-spinner/index.tsx","services/zesp/common/Constants.tsx","services/zesp/common/ZespDataEvent.tsx","shared/loading-spinner/service.tsx","services/single.tsx","services/zesp/common/ZespResponseValidators.tsx","services/zesp/service-devices.tsx","services/zesp/service-general.tsx","services/zesp/index.tsx","services/zesp/service-settings.tsx","shared/cover/index.tsx","shared/fadein-transition/index.tsx","pages/main/index.tsx","pages/devices/item-image.tsx","pages/devices/item.tsx","pages/devices/index.tsx","pages/setup/index.tsx","pages/device-info/index.tsx","shared/form/react-form/logic.tsx","shared/form/react-form/index.tsx","pages/socket-test/index.tsx","shared/form/input-group-horizontal.tsx","shared/form/checkbox-group-inline.tsx","pages/setup/mqtt.tsx","pages/setup/not-implemented-yet.tsx","pages/setup/wifi.tsx","Routes.tsx","pages/welcome/part-items.tsx","pages/welcome/part-edit.tsx","services/localStorage.tsx","pages/welcome/index.tsx","App.tsx","reportWebVitals.ts","index.tsx","i18n/config.js"],"names":["window","$","jQuery","require","console","debug","log","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","CloseEventCodes","_ws","_globalState","_server","Result","t","useTranslation","className","to","exact","process","GlobalStateContext","createContext","state","setState","GlobalStateProvider","children","value","assign","spinnerLoadingShow","zespConnected","appInitialized","zespSettings","undefined","selectedServerIndex","devices","useState","Provider","useGlobalState","context","useContext","setTimeout","removeClass","animation","variant","ConnectionStartTimeout","VerifyConnectionTimeout","DefaultRequestTimeoutSeconds","ZespDataEventType","ZespDataEvent","dataType","dataParts","response","Event","_reconnecter","onMessageEvent","EventTarget","ZespConnector","connectAsync","globalState","server","Promise","reject","warn","Single","reconnectAsync","then","catch","error","prev","Constants","setInterval","disconnect","clearInterval","underlyingWebsocket","readyState","close","force","Restart","prevState","protocol","document","location","WebsocketBuilder","address","onOpen","onConnectionOpen","onClose","onConnectionClosed","onError","onConnectionError","onMessage","onMessageReceived","build","send","data","requestAsync","responseValidator","timeoutSeconds","responseReceived","validator","listener","event","result","isValid","removeEventListener","addEventListener","request","args","onSuccess","name","errorMessage","subscribe","handler","zespEvent","unsubscribe","getGlobalState","ws","messageParts","replace","split","length","messageType","shift","exec","unshift","resultEvent","dispatchEvent","init","show","setVisible","hide","isVisible","ZespConnectorImplementation","LoadingSpinnerImplementation","JsonZespResponseValidator","fileName","responseFileName","TypedZespResponseValidator","AllMessagesZespResponseValidator","ServiceDevices","requestData","zesp","onDevicesListReceived","jsonString","JSON","parse","device","templateInfo","templates","find","x","modelIds","findIndex","y","ModelId","Report","key","reportIdInfo","p1","substr","deviceId","command","getReportName","reportType","DataHaClusterIds","isInitialized","onGroupsReceived","onLocationsReceived","onMiLampDataReceived","onDevicesUpdate","ZespService","initAsync","ZespConnectorPromise","ping","getAsync","json","parseResponse","settings","setAsync","stringify","join","toLocaleLowerCase","props","FadeIn","setClassName","href","target","rel","deviceImage","image","src","style","backgroundImage","title","Name","detailsLink","IEEE","Device","tags","push","filter","i","indexOf","sort","a","b","DevicesGroup","rootDeviceIndex","rootDevice","lightDevices","group","sensorDevices","switchDevices","otherDevices","includes","Card","Body","SaveSettings","updatedSettings","promise","toast","loading","success","useEffect","Spinner","alert","Container","Nav","Item","marginTop","useParams","ieee","setShow","history","useHistory","handleClose","Modal","onHide","onExited","Header","closeButton","onClick","preventDefault","handleSubmit","action","input","prop","attr","val","ReactForm","onSubmit","restProps","Form","predefinedMessages","predefinedBinary","messages","_setMessages","messageSendValue","setMessageSendValue","messagesRef","useRef","addMessages","message","current","cutCount","splice","onSendPredefined","innerText","onSendBinary","replaceAll","dataHex","match","parseInt","dataToSend","Uint8Array","messageToSend","type","onChange","Footer","Button","startsWith","i2","controlId","label","placeholder","defaultValue","inputProps","toString","Group","as","Row","Label","column","md","lg","Col","Control","defaultChecked","checkedValue","uncheckedValue","defaultCheckedBool","checked_value","unchecked_value","Check","MQTT","mqttup","mqtt","mqttPort","mqttLogin","mqttPassw","mqttEnable","Home_Assistant","Wifi","ssid","pass","ip","mask","gw","Routes","path","component","MainPage","DevicesPage","DeviceInfoPage","SetupPage","SetupWifiPage","SetupMqttPage","NotImplementedYetPage","SocketTestPage","sortedServers","servers","index","openServerAction","activeClassName","openEditAction","openAddServer","deleteConfirmed","setDeleteConfirmed","popover","Popover","dangerouslySetInnerHTML","__html","editServer","updateAction","addAction","closeAction","FormControl","InputGroup","Text","OverlayTrigger","trigger","placement","overlay","rootClose","onToggle","deleteAction","useLocalStorage","initialValue","readValue","item","localStorage","getItem","storedValue","setStoredValue","handleStorageChange","newValue","Function","setItem","WelcomePage","currentPart","setCurrentPart","setEditServer","setServers","backToWelcomeAction","Content","selectedServer","App","role","reportWebVitals","onPerfEntry","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById","languages","namespaces","i18n","use","initReactI18next","fallbackLng","lng","resources","lang","ns","loadResources","defaultNS"],"mappings":"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","file":"static/js/main.5513973e.chunk.js","sourcesContent":["window.$ = window.jQuery = require('jquery')\n\nif (process.env.NODE_ENV !== \"development\") console.debug = () => {\n    // show info for dev environment only\n    console.log(\"Debug logs are disabled\");\n};","var map = {\n\t\"./config\": 69,\n\t\"./config.js\": 69,\n\t\"./locales/en/common\": 76,\n\t\"./locales/en/common.json\": 76,\n\t\"./locales/en/nav\": 77,\n\t\"./locales/en/nav.json\": 77,\n\t\"./locales/en/pages/devices\": 78,\n\t\"./locales/en/pages/devices.json\": 78,\n\t\"./locales/en/pages/setup-mqtt\": 79,\n\t\"./locales/en/pages/setup-mqtt.json\": 79,\n\t\"./locales/en/pages/setup-wifi\": 80,\n\t\"./locales/en/pages/setup-wifi.json\": 80,\n\t\"./locales/en/pages/welcome\": 81,\n\t\"./locales/en/pages/welcome.json\": 81\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 126;","// https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent#status_codes\nexport enum CloseEventCodes {\n  Restart = 1012\n}","import {Websocket, WebsocketBuilder} from \"websocket-ts\";\nimport Constants from \"./Constants\";\nimport {ZespDataEvent, ZespDataEventType} from \"./ZespDataEvent\";\nimport {IGlobalState} from \"../../../global-state\";\nimport {IZespConnector, ZespConnectorHandler, ZespConnectorListener} from \"../interfaces/IZespConnector\";\nimport {Single} from \"../../single\";\nimport {CloseEventCodes} from \"../enums/CloseEventCodes\";\nimport {IZespResponseValidator} from \"../interfaces/IZespResponseValidator\";\nimport {IServerInfo} from \"../../../pages/welcome/interfaces\";\n\n// const zespHost = \"192.168.3.30\"; //TODO read host from config\n\nlet _ws: Websocket;\nlet _globalState: IGlobalState;\nlet _server: IServerInfo | null;\nconst onMessageEvent = new EventTarget();\nlet _reconnecter: NodeJS.Timeout | null | undefined;\n\nconst ZespConnector: IZespConnector = {\n  connectAsync: (globalState, server) => new Promise<IZespConnector>((resolve, reject) => {\n    if (_globalState && _server) {\n      console.warn(\"ZespConnector already initialized\");\n      resolve(Single.ZespConnector);\n      return;\n    }\n\n    _globalState = globalState;\n    _server = server;\n\n    // start with delay\n    setTimeout(() => ZespConnector.reconnectAsync(true)\n        .then(() => resolve(Single.ZespConnector))\n        .catch(error => {\n          _globalState.setState(prev => ({...prev, ...{zespConnected: false}}));\n          reject(error);\n        }),\n      Constants.ConnectionStartTimeout);\n\n    // setup watchdog\n    _reconnecter = setInterval(() => ZespConnector.reconnectAsync(false)\n        .then(() => resolve(Single.ZespConnector))\n        .catch(error => {\n          console.warn(`Reconnection is failed: ${error}`);\n          _globalState.setState(prev => ({...prev, ...{zespConnected: false}}));\n          reject(error);\n        }),\n      Constants.VerifyConnectionTimeout);\n\n    return ZespConnector;\n  }),\n\n  disconnect: () => {\n    if (_reconnecter) {\n      clearInterval(_reconnecter);\n      _reconnecter = null;\n    }\n    _server = null;\n    _globalState.setState(prev => ({...prev, ...{zespConnected: false}}));\n\n    try {\n      if (_ws?.underlyingWebsocket?.readyState === 3 || _ws?.underlyingWebsocket?.readyState == null) {\n        console.debug(\"zesp connection already closed\");\n        return;\n      } else if (_ws?.underlyingWebsocket?.readyState === 1) {\n        console.debug(\"zesp connection closing...\");\n        _ws.close(1000); // closed normal\n        return;\n      } else {\n        _ws?.close(1000); // closed normal\n      }\n    } catch {\n      //it's ok (;\n    }\n  },\n\n  reconnectAsync: (force) => new Promise<void>((resolve, reject) => {\n    if (!_globalState) {\n      reject(\"ZespConnector is not initialized yet\");\n      // throw new Error(\"ZespConnector is not initialized yet\")\n    }\n\n    if (!_server) {\n      reject(\"Server configuration missed\");\n      // throw new Error(\"ZespConnector is not initialized yet\")\n    }\n\n    if (_ws?.underlyingWebsocket?.readyState === 0) {\n      reject(\"Already connecting\");\n      return;\n    }\n\n    // check if already connected\n    if (_ws?.underlyingWebsocket?.readyState === 1 && !force) {\n      resolve();\n      return;\n    }\n\n    // create new connection\n    console.debug(\"Start ws connection...\");\n    try {\n      _ws.close(CloseEventCodes.Restart);\n    } catch {\n      // it's ok :P\n    }\n\n    _globalState.setState(prevState => ({...prevState, ...{zespConnected: false}}))\n    const protocol = document.location.protocol === \"https:\" ? \"wss\" : \"ws\";\n    _ws = new WebsocketBuilder(`${protocol}://${_server!.address}:81`)\n      .onOpen(() => {\n        onConnectionOpen();\n        resolve();\n      })\n      .onClose(onConnectionClosed)\n      .onError(() => {\n        onConnectionError();\n        reject(\"zesp connection error\")\n      })\n      .onMessage(onMessageReceived)\n      .build();\n  }),\n\n  send: (data) => {\n    if (!_globalState) throw new Error(\"ZespConnector is not initialized yet\");\n    _ws.send(data);\n  },\n\n  requestAsync: ({data, responseValidator, timeoutSeconds}) => new Promise<ZespDataEvent>(((resolve, reject) => {\n    if (!timeoutSeconds || timeoutSeconds <= 0) timeoutSeconds = Constants.DefaultRequestTimeoutSeconds;\n    let responseReceived = false;\n\n    const validator = responseValidator;\n\n    // on response received from zesp\n    const listener = (event: Event) => {\n      const result = event as ZespDataEvent;\n      if (!validator.isValid(result)) return;\n\n      responseReceived = true;\n      onMessageEvent.removeEventListener(ZespDataEventType, listener);\n      resolve(result);\n    }\n\n    // if no response for a specific time (timeout)\n    const onTimeout = () => {\n      if (responseReceived) return;\n\n      onMessageEvent.removeEventListener(ZespDataEventType, listener);\n      console.warn(`zesp response did not received (timeout: ${timeoutSeconds} seconds)`);\n      reject(\"timeout\");\n    };\n\n    // send request\n    try {\n      onMessageEvent.addEventListener(ZespDataEventType, listener);\n      ZespConnector.send(data)\n      setTimeout(onTimeout, timeoutSeconds * 1000);\n    } catch (error) {\n      reject(`exception: ${error}`);\n    }\n  })),\n\n  request: (args) => new Promise<IZespConnector>((resolve, reject) => {\n    ZespConnector\n      .requestAsync(args)\n      .then(event => {\n        if (args.onSuccess) args.onSuccess(event);\n        else console.debug(`zesp request completed (${args.responseValidator.name})`);\n\n        resolve(Single.ZespConnector);\n      })\n      .catch(error => {\n        const errorMessage = `${error} (${args.responseValidator.name}; ${args.data})`;\n\n        if (args.onError) args.onError(errorMessage);\n        else console.warn(`zesp request failed: ${errorMessage}`);\n        reject(errorMessage);\n      });\n  }),\n\n  subscribe: (validator: IZespResponseValidator, handler: ZespConnectorHandler): ZespConnectorListener => {\n    const listener = (event: Event): void => {\n      const zespEvent = event as ZespDataEvent;\n      if (!validator.isValid(zespEvent)) return;\n\n      handler(zespEvent);\n    }\n\n    onMessageEvent.addEventListener(ZespDataEventType, listener)\n    return listener;\n  },\n\n  unsubscribe: (listener: ZespConnectorListener) => onMessageEvent.removeEventListener(ZespDataEventType, listener),\n\n  getGlobalState: () => _globalState\n};\n\nconst onConnectionOpen = () => {\n  console.debug(\"Zesp connection opened\");\n  _globalState.setState(prevState => ({...prevState, ...{zespConnected: true}}));\n}\n\nconst onConnectionClosed = () => {\n  console.debug(\"Zesp connection closed\");\n  _globalState.setState(prevState => ({...prevState, ...{zespConnected: false}}));\n}\n\nconst onConnectionError = () => {\n  console.debug(\"Zesp connection error happened )=\");\n}\n\nconst onMessageReceived = (ws: Websocket, e: MessageEvent) => {\n  const messageParts = e.data\n    .replace(/\\|(?=([^\"]*\"[^\"]*\")*[^\"]*$)/ig, \"\\x00\")\n    .split(\"\\x00\");\n\n  if (messageParts.length == 0) {\n    console.warn(\"Received empty message from zesp\");\n    return;\n  }\n\n  let messageType = messageParts.shift();\n\n  const jsonMatch = /\\/(.+)\\.json/ig.exec(messageType);\n  if (jsonMatch) {\n    messageParts.unshift(messageType);\n    messageType = \"json\";\n  }\n\n  const resultEvent = new ZespDataEvent(messageType, messageParts, e.data);\n  // console.debug(resultEvent);\n  onMessageEvent.dispatchEvent(resultEvent);\n}\n\nexport default ZespConnector;\n","import React from 'react';\nimport {useTranslation} from \"react-i18next\";\nimport {NavLink} from \"react-router-dom\";\n\nimport './styles.scss'\n\nconst Result = () => {\n  const {t} = useTranslation(\"nav\");\n\n  return (\n    <nav className=\"nav nav-masthead justify-content-center\">\n      <NavLink className=\"nav-link\" to=\"/\" exact={true}>{t('home')}</NavLink>\n      <NavLink className=\"nav-link\" to=\"/devices\">{t('devices')}</NavLink>\n      {process.env.NODE_ENV === \"development\" && (\n        <NavLink className=\"nav-link\" to=\"/socket-test\" exact={true}>Test WS</NavLink>\n      )}\n      <NavLink className=\"nav-link\" to=\"/setup\">{t('setup')}</NavLink>\n    </nav>\n  );\n};\n\nexport default Result;","// https://jamiehaywood.medium.com/typesafe-global-state-with-typescript-react-react-context-c2df743f3ce\n\nimport React, {createContext, useState, useContext, Dispatch, SetStateAction} from \"react\";\nimport {GetDefaultGlobalStateValues, GlobalStateInterface} from \"../../global-state\";\n\nconst GlobalStateContext = createContext({\n  state: {} as Partial<GlobalStateInterface>,\n  setState: {} as Dispatch<SetStateAction<Partial<GlobalStateInterface>>>,\n});\n\nconst GlobalStateProvider = (\n  {\n    children,\n    value = {} as GlobalStateInterface,\n  }: {\n    children: React.ReactNode;\n    value?: Partial<GlobalStateInterface>;\n  }) => {\n\n  Object.assign(value, GetDefaultGlobalStateValues(useGlobalState));\n  const [state, setState] = useState(value);\n\n  return (\n    <GlobalStateContext.Provider value={{state, setState}}>\n      {children}\n    </GlobalStateContext.Provider>\n  );\n};\n\nconst useGlobalState = () => {\n  const context = useContext(GlobalStateContext);\n  if (!context) {\n    throw new Error(\"useGlobalState must be used within a GlobalStateContext\");\n  }\n\n  return context;\n};\n\nconst DebugState = () => {\n  const {state} = useGlobalState();\n  return <pre>{JSON.stringify(state || {}, null, \"\\t\")}</pre>;\n};\n\nexport {GlobalStateProvider, DebugState, useGlobalState};","import {Dispatch, SetStateAction} from \"react\";\nimport {ZespSettings} from \"./services/zesp/models/ZespSettings\";\nimport {DeviceInfo} from \"./services/zesp/models/DeviceInfo\";\n\ninterface GlobalStateInterface {\n  spinnerLoadingShow: boolean,\n  zespConnected: boolean,\n  appInitialized: boolean,\n  zespSettings?: ZespSettings,\n  selectedServerIndex: number | null,\n  devices: DeviceInfo[],\n}\n\nexport interface IGlobalState {\n  state: Partial<GlobalStateInterface>,\n  setState: Dispatch<SetStateAction<Partial<GlobalStateInterface>>>\n}\n\n// eslint-disable-next-line\nconst GetDefaultGlobalStateValues = (useGlobalState: () => IGlobalState): GlobalStateInterface => {\n  return ({\n    spinnerLoadingShow: false,\n    zespConnected: false,\n    appInitialized: false,\n    zespSettings: undefined,\n    selectedServerIndex: null,\n    devices: []\n  });\n};\n\nexport {GetDefaultGlobalStateValues};\nexport type {GlobalStateInterface};","import React, {Fragment} from \"react\";\nimport $ from \"jquery\";\nimport \"./styles.scss\"\nimport {Spinner} from \"react-bootstrap\";\nimport {useGlobalState} from \"../global-state-provider\";\n\nconst Result = () => {\n  const {state} = useGlobalState();\n\n  if (state.spinnerLoadingShow) {\n    setTimeout(() => $(\".loading-overlay\").removeClass(\"hidden\"), 0);\n    return (\n      <div className={\"loading-overlay hidden\"}>\n        <Spinner animation=\"border\" variant=\"light\"/>\n      </div>\n    );\n  }\n\n  return <Fragment/>;\n}\n\nexport default Result;","const Result = {\n  // delay before connection start\n  ConnectionStartTimeout: 500,\n\n  // connection verify interval\n  VerifyConnectionTimeout: 5000,\n\n  // default timeout for requests in seconds \n  DefaultRequestTimeoutSeconds: 5,\n}\n\nexport default Result;","export const ZespDataEventType = \"zesp-data-received\";\n\nexport class ZespDataEvent extends Event {\n  readonly dataType: string;\n  readonly response: string;\n  readonly dataParts: string[];\n\n  constructor(dataType: string, dataParts: string[], response: string) {\n    super(ZespDataEventType);\n\n    this.dataType = dataType;\n    this.dataParts = dataParts;\n    this.response = response;\n  }\n}","import {IGlobalState} from \"../../global-state\";\n\nlet _globalState: IGlobalState;\n\nexport interface ILoadingSpinner {\n  init(globalState: IGlobalState): void;\n\n  show(): void;\n\n  hide(): void;\n}\n\nexport default {\n  init: (globalState: IGlobalState) => {\n    if (_globalState) {\n      console.warn(\"Loader spinner already initialized\");\n      return;\n    }\n\n    _globalState = globalState;\n  },\n\n  show: () => setVisible(true),\n  hide: () => setVisible(false),\n} as ILoadingSpinner\n\nconst setVisible = (isVisible: boolean): void => _globalState.setState(prev => ({...prev, ...{spinnerLoadingShow: isVisible}}));","import {IZespConnector} from \"./zesp/interfaces/IZespConnector\";\nimport ZespConnectorImplementation from \"./zesp/common/ZespConnector\";\nimport LoadingSpinnerImplementation, {ILoadingSpinner} from \"../shared/loading-spinner/service\";\n\nexport namespace Single {\n  export const ZespConnector: IZespConnector = ZespConnectorImplementation;\n  export const ZespConnectorPromise: Promise<IZespConnector> = new Promise<IZespConnector>(resolve => resolve(Single.ZespConnector));\n  export const Spinner: ILoadingSpinner = LoadingSpinnerImplementation;\n}","import {ZespDataEvent} from \"./ZespDataEvent\";\nimport {IZespResponseValidator} from \"../interfaces/IZespResponseValidator\";\n\nexport const JsonZespResponseValidator = (fileName: string): IZespResponseValidator => ({\n  name: JsonZespResponseValidator.name,\n  isValid: (event: ZespDataEvent) => {\n    if (event.dataType !== \"json\") return false;\n    const responseFileName = event.dataParts[0];\n    const foundFileName = (/\\/(.+)\\.json/ig.exec(responseFileName) as string[])[1];\n\n    return foundFileName === fileName;\n  }\n});\n\nexport const TypedZespResponseValidator = (dataType: string): IZespResponseValidator => ({\n  name: TypedZespResponseValidator.name,\n  isValid: (event: ZespDataEvent) => event.dataType === dataType\n});\n\nexport const AllMessagesZespResponseValidator: IZespResponseValidator = ({\n  name: \"AllZespResponseValidator\",\n  isValid: (event => true)\n});","import {ZespDataEvent} from \"./common/ZespDataEvent\";\nimport {DeviceInfo} from \"./models/DeviceInfo\";\nimport DataHaClusterIds from \"../../data/zigbee/ha-cluster-ids.json\";\nimport {IGlobalState} from \"../../global-state\";\nimport {IZespConnector} from \"./interfaces/IZespConnector\";\nimport {TypedZespResponseValidator} from \"./common/ZespResponseValidators\";\nimport templates from \"../../data/templates.json\";\nimport {TemplateInfo} from \"./models/TemplateInfo\";\n\nconst ServiceDevices = {\n  requestData: (zesp: IZespConnector) => {\n    return zesp.request({\n      data: \"getDeviceList\",\n      responseValidator: TypedZespResponseValidator(\"alldev\"),\n      onSuccess: (event) => onDevicesListReceived(event, zesp.getGlobalState())\n    })\n  }\n}\n\nconst onDevicesListReceived = (event: ZespDataEvent, globalState: IGlobalState): void => {\n  const jsonString: string = event.dataParts[0];\n  const devices: DeviceInfo[] = [];\n  Object.assign(devices, JSON.parse(jsonString))\n\n  // additional device data extraction\n  for (const device of devices) {\n    // read template information\n    device.templateInfo = templates.find(x => x.modelIds.findIndex(y => y === device.ModelId) >= 0) as TemplateInfo | null;\n\n    // read report information\n    for (const key of Object.keys(device.Report)) {\n      const report = device.Report[key];\n      report.reportIdInfo = {\n        p1: key.substr(0, 2),\n        deviceId: key.substr(2, 4),\n        command: key.substr(6),\n        name: getReportName(key.substr(2, 4))\n      };\n    }\n  }\n\n  globalState.setState(x => ({...x, ...{devices: devices}}));\n}\n\nconst getReportName = (deviceId: string): string => {\n  const reportType = (DataHaClusterIds as { [deviceId: string]: string })[deviceId];\n  return reportType ?? \"unknown\";\n}\n\nexport default ServiceDevices;","import {Single} from \"../single\";\nimport {JsonZespResponseValidator, TypedZespResponseValidator} from \"./common/ZespResponseValidators\";\nimport {ZespDataEvent} from \"./common/ZespDataEvent\";\nimport {IGlobalState} from \"../../global-state\";\nimport ServiceDevices from \"./service-devices\";\n\nconst send = (data: string | ArrayBufferLike | Blob | ArrayBufferView) => Single.ZespConnector.send(data);\nlet isInitialized = false;\n// let _globalState: IGlobalState;\n\nexport default {\n  initAsync: (globalState: IGlobalState): Promise<void> => new Promise<void>((resolve, reject) => {\n    if (isInitialized) {\n      console.warn(\"zesp service already initialized\");\n      resolve();\n      return;\n    }\n\n    isInitialized = true;\n    // _globalState = globalState\n    console.debug(\"Load initial data from zesp...\");\n\n    //TODO move each promise to fn\n    Single.ZespConnectorPromise\n      .then(zesp => zesp.request({data: \"LoadJson|/groups.json\", responseValidator: JsonZespResponseValidator(\"groups\"), onSuccess: onGroupsReceived}))\n      .then(zesp => zesp.request({data: \"LoadJson|/location.json\", responseValidator: JsonZespResponseValidator(\"location\"), onSuccess: onLocationsReceived}))\n      .then(zesp => zesp.request({data: \"get_Mi_lamp\", responseValidator: TypedZespResponseValidator(\"Mi_lamp\"), onSuccess: onMiLampDataReceived}))\n      .then(ServiceDevices.requestData)\n      .then(zesp => zesp.subscribe(TypedZespResponseValidator(\"rep\"), onDevicesUpdate))\n      .then(() => resolve())\n      .catch(error => {\n        console.error(`Cannot complete zesp service initialization: ${error}`);\n        reject(error);\n      });\n  }),\n\n  ping: () => send(\"ping\"),\n  // loadConfigAsync: () => Single.ZespConnector.requestAsync({data: \"loadConfig\", responseValidator: TypedZespResponseValidator(\"jsconfig\")})\n}\n\nfunction onGroupsReceived(event: ZespDataEvent) {\n  console.log(\"groups received\");\n}\n\nfunction onLocationsReceived(event: ZespDataEvent) {\n  console.log(\"locations received\");\n}\n\nfunction onMiLampDataReceived(event: ZespDataEvent) {\n  console.log(\"MI Lamp data received\");\n}\n\nfunction onDevicesUpdate(event: ZespDataEvent) {\n  console.log(`Device update received: ${event.dataParts[1]}`);\n}","import GeneralService from \"./service-general\";\nimport SettingsService from \"./service-settings\";\n\n\nexport const ZespService = ({\n  general: GeneralService,\n  settings: SettingsService\n});","import {ZespSettings} from \"./models/ZespSettings\";\nimport {Single} from \"../single\";\nimport {TypedZespResponseValidator} from \"./common/ZespResponseValidators\";\n\nexport default {\n  getAsync: (): Promise<ZespSettings> => new Promise<ZespSettings>((resolve, reject) => {\n    Single.ZespConnector.requestAsync({data: \"loadConfig\", responseValidator: TypedZespResponseValidator(\"jsconfig\")})\n      .then(event => parseResponse(event.dataParts[0]))\n      .then(settings => resolve(settings))\n      .catch(error => reject(error));\n  }),\n\n  setAsync: (settings: ZespSettings): Promise<void> => {\n    const data = [\n      \"SaveJson\",\n      \"/jsconfig.txt\",\n      JSON.stringify(settings)\n    ].join(\"|\");\n\n    return new Promise((resolve, reject) => {\n      Single.ZespConnector.requestAsync({data: data, responseValidator: TypedZespResponseValidator(\"ZD_RSP\")})\n        .then(event => {\n          // console.log(event);\n          if (event.dataParts[1].toLocaleLowerCase() === \"ok\") resolve();\n          else reject(`Settings was not saved: ${event.response}`)\n        })\n        .catch(error => reject(error));\n    })\n  }\n}\n\nfunction parseResponse(jsonString: string): ZespSettings {\n  const json = JSON.parse(jsonString);\n  const result = {} as ZespSettings;\n  Object.assign(result, json);\n\n  return result;\n}\n","import React, {FunctionComponent} from \"react\";\n\nconst Result: FunctionComponent = (props) => {\n  return (\n    <div className=\"cover text-center d-flex content-light align-self-center flex-grow-1 align-items-center\">\n      <div className=\"\">\n        {props.children}\n      </div>\n    </div>\n  );\n}\n\nexport default Result;","import {FunctionComponent, useState} from \"react\";\nimport \"./styles.scss\";\n\nexport const FadeIn: FunctionComponent = (props) => {\n  const [className, setClassName] = useState(\"show-transition hidden\");\n  setTimeout(() => setClassName(\"show-transition\"), 0);\n\n  return (\n    <div className={className}>\n      {props.children}\n    </div>\n  )\n}","import React from \"react\";\nimport Cover from \"../../shared/cover\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\n\nconst Result = () => (\n  <Cover>\n    <FadeIn>\n      <h1 className=\"cover-heading\">Quite soon, here will be useful info</h1>\n      <p className=\"lead\">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam ultricies ipsum porttitor,\n        aliquet enim eu, congue nulla. Nulla luctus ante sit amet sodales convallis. Aliquam lectus nisl, semper eget\n        aliquam et, malesuada ut orci.</p>\n      <p className=\"lead\">\n        <a href=\"https://t.me/zesp32\" target={\"_blank\"} rel=\"noreferrer\" className=\"btn btn-lg btn-secondary\">Get more</a>\n      </p>\n    </FadeIn>\n  </Cover>\n);\n\nexport default Result;","import React from \"react\";\nimport {DeviceInfo} from \"../../services/zesp/models/DeviceInfo\";\n\ninterface IProps {\n  device: DeviceInfo\n}\n\nexport default (props: IProps) => {\n  const deviceImage = getDeviceImageSrc(props.device);\n  const src = `/device-images/${deviceImage}`;\n  return (<div className=\"item-image\" style={{backgroundImage: `url(${src})`}}/>);\n}\n\nfunction getDeviceImageSrc(device: DeviceInfo): string {\n  if (!device.templateInfo) return \"zigbee.png\";\n  return device.templateInfo.image;\n}","import React from \"react\";\nimport {DeviceInfo} from \"../../services/zesp/models/DeviceInfo\";\nimport ItemImage from \"./item-image\";\nimport {NavLink} from \"react-router-dom\";\n\ninterface IProps {\n  device: DeviceInfo\n}\n\nexport default (props: IProps) => {\n  const title = props.device.Name && props.device.Name.length > 0 ? props.device.Name : props.device.ModelId\n  const detailsLink = `/devices/${props.device.IEEE}-${props.device.Device}`;\n\n  let tags: string[] = [];\n  for (const key of Object.keys(props.device.Report))\n    tags.push(props.device.Report[key].reportIdInfo.name);\n\n  // remove duplicates and unknown \n  tags = tags\n    .filter((x, i) => x !== \"unknown\" && tags.indexOf(x) == i)\n    .sort((a, b) => a > b ? 1 : -1);\n\n  return (\n    <NavLink className=\"item p-3 border rounded\" to={detailsLink}>\n      <div className=\"d-flex\">\n        <div><ItemImage device={props.device}/></div>\n        <div className=\"ps-2\">\n          <div className=\"title\">{title}</div>\n          <div className=\"ieee text-muted small\"><span className=\"badge bg-info me-1\">{props.device.Device}</span>{props.device.IEEE}</div>\n          {tags.length > 0 && (\n            <div className=\"badges small\">\n              {tags.map((x, i) => (<span key={i} className=\"badge bg-secondary\">{x}</span>))}\n            </div>\n          )}\n        </div>\n      </div>\n    </NavLink>\n  );\n}","import React, {Fragment} from \"react\";\nimport \"./styles.scss\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {Card} from \"react-bootstrap\";\nimport Item from \"./item\";\nimport {useGlobalState} from \"../../shared/global-state-provider\";\nimport {DeviceInfo} from \"../../services/zesp/models/DeviceInfo\";\nimport {useTranslation} from \"react-i18next\";\n\nconst Result = () => {\n  const globalState = useGlobalState();\n  const {t} = useTranslation(\"pages.devices\");\n\n  //TODO style and translate it\n  if (!globalState.state.devices || globalState.state.devices.length == 0) return (\n    <div>No devices found...</div>\n  )\n\n  let devices = globalState.state.devices;\n\n  // find root device\n  const rootDeviceIndex = devices.findIndex(x => x.Device === \"0000\");\n  const rootDevice = devices[rootDeviceIndex];\n  devices = devices.filter(x => x != rootDevice);\n\n  const lightDevices: DeviceInfo[] = devices.filter(x => x.templateInfo?.group === \"light\");\n  const sensorDevices: DeviceInfo[] = devices.filter(x => x.templateInfo?.group === \"sensor\");\n  const switchDevices: DeviceInfo[] = devices.filter(x => x.templateInfo?.group === \"switch\");\n  const otherDevices: DeviceInfo[] = devices.filter(x =>\n    !lightDevices.includes(x) &&\n    !sensorDevices.includes(x) &&\n    !switchDevices.includes(x)\n  );\n\n  return (\n    <FadeIn>\n      <div className=\"devices\">\n        <Card>\n          <Card.Body>\n            <div className=\"group\">\n              <div className=\"title h5 pb-3\">{t(\"groups.hub\")}</div>\n              <div className=\"items d-flex flex-wrap\">\n                <Item device={rootDevice}/>\n              </div>\n            </div>\n\n            <DevicesGroup title={t(\"groups.lights\")} devices={lightDevices}/>\n            <DevicesGroup title={t(\"groups.sensors\")} devices={sensorDevices}/>\n            <DevicesGroup title={t(\"groups.switches\")} devices={switchDevices}/>\n            <DevicesGroup title={t(\"groups.other\")} devices={otherDevices}/>\n          </Card.Body>\n        </Card>\n      </div>\n    </FadeIn>\n  );\n}\n\nconst DevicesGroup = (props: { devices: DeviceInfo[], title: string }) => props.devices.length == 0\n  ? (<Fragment/>)\n  : (\n    <div className=\"group border-top pt-4\">\n      <div className=\"title h5 pb-3\">{props.title} <span className=\"badge bg-secondary\">{props.devices.length}</span></div>\n      <div className=\"items d-flex flex-wrap\">\n        {props.devices.map((device, i) => (<Item device={device} key={i}/>))}\n      </div>\n    </div>\n  )\n\nexport default Result; ","import React, {Fragment, useEffect} from \"react\";\nimport {Container, Nav} from \"react-bootstrap\";\nimport {NavLink} from \"react-router-dom\";\nimport {ZespService} from \"../../services/zesp\";\nimport {Single} from \"../../services/single\";\nimport {useGlobalState} from \"../../shared/global-state-provider\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {ZespSettings} from \"../../services/zesp/models/ZespSettings\";\nimport toast from \"react-hot-toast\";\nimport {TFunction} from \"react-i18next\";\nimport {IGlobalState} from \"../../global-state\";\nimport {BsGearFill} from \"react-icons/bs\";\n\nconst Result = () => {\n  const globalState = useGlobalState();\n\n  useEffect(() => {\n    Single.Spinner.show();\n    ZespService.settings.getAsync()\n      .then(data => {\n        globalState.setState(prev => ({...prev, ...{zespSettings: data}}))\n        Single.Spinner.hide();\n      })\n      .catch(error => {\n        //TODO show error window\n        alert(error);\n      });\n  }, []);\n\n  if (!globalState.state.zespSettings) return (<Fragment/>);\n\n  return (\n    <FadeIn>\n      <div className=\"aaa\">...</div>\n      <Container className=\"p-0\">\n        <Nav variant=\"pills\">\n          <Nav.Item><NavLink className=\"nav-link\" to=\"/setup\" exact>Wifi client</NavLink></Nav.Item>\n          <Nav.Item><NavLink className=\"nav-link\" to=\"/setup/zigbee\">Zigbee settings</NavLink></Nav.Item>\n          <Nav.Item><NavLink className=\"nav-link\" to=\"/setup/mqtt\">MQTT client</NavLink></Nav.Item>\n          <Nav.Item><NavLink className=\"nav-link\" to=\"/setup/telegram\">Telegram bot</NavLink></Nav.Item>\n          <Nav.Item><NavLink className=\"nav-link\" to=\"/setup/z2m\">Zigbee2MQTT client</NavLink></Nav.Item>\n          <Nav.Item className=\"ms-auto\"><NavLink className=\"nav-link\" to=\"/setup/zesp-ui\"><BsGearFill style={{marginTop: \"-3px\"}}/> ZESP:UI</NavLink></Nav.Item>\n        </Nav>\n      </Container>\n    </FadeIn>\n  );\n}\n\nexport const SaveSettings = (data: Partial<ZespSettings>, globalState: IGlobalState, t: TFunction<string[]>): Promise<void> => {\n  const updatedSettings: ZespSettings = ({...globalState.state.zespSettings!, ...data});\n  const promise = ZespService.settings.setAsync(updatedSettings)\n    .then(() => globalState.setState(prev => ({...prev, zespSettings: updatedSettings})));\n\n  toast.promise(promise, {loading: t(\"common:saving_progress\"), success: t(\"common:saving_success\"), error: t(\"common:saving_error\")});\n  return promise;\n}\n\nexport default Result;\n","import React, {useState} from \"react\";\nimport {Modal} from \"react-bootstrap\";\nimport {useParams, NavLink, useHistory} from \"react-router-dom\";\n\nexport default () => {\n  const {ieee, device} = useParams<{ ieee: string, device: string }>();\n  const [show, setShow] = useState(true);\n  const history = useHistory();\n\n  const handleClose = () => setShow(false);\n  const handleExit = () => setTimeout(() => history.push(\"/devices\"), 100);\n  const handleCloseLink = (event: React.MouseEvent) => {\n    event.preventDefault();\n    handleClose();\n  }\n\n  return (\n    <Modal show={show} onHide={handleClose} onExited={handleExit}>\n      <Modal.Header closeButton>Not implemented yet</Modal.Header>\n      <Modal.Body>\n        <p>Device: <span className=\"badge bg-info\">{ieee} ({device})</span></p>\n        <p>\n          Hello, my dear friend! Just imagine how awesome this feature can be and share it with developers ~_~ <br/>\n          Or you can even implement it yourself, everything you need is just to jump to source codes, made some magic, test it and that's it!\n        </p>\n        <p>\n          <NavLink to=\"/devices\" onClick={handleCloseLink}>Go back for now</NavLink>\n        </p>\n      </Modal.Body>\n    </Modal>\n  );\n}","import {FormEvent} from \"react\";\nimport $ from \"jquery\";\n\n// we need this 'any' type to provide general solution\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype IAction = (arg: any) => void;\n\nconst Result = {\n  handleSubmit: function handleSubmit(e: FormEvent, action: IAction) {\n    e.preventDefault();\n\n    // we need this 'any' type to provide general solution\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const data: any = {};\n\n    for (const input of $(e.target).find(\"input\")) {\n      const id = $(input).prop(\"id\");\n      if (id == null) return;\n\n      if ($(input).prop(\"type\") === \"checkbox\") {\n        if ($(input).prop(\"checked\") === true) data[id] = $(input).attr(\"checked_value\") || \"true\";\n        else data[id] = $(input).attr(\"unchecked_value\") || \"false\";\n      } else {\n        data[id] = $(input).val();\n      }\n    }\n    // console.log(data);\n    action(data)\n  }\n};\n\nexport default Result;","import React, {FormEvent} from \"react\";\nimport {Form} from \"react-bootstrap\";\n\nimport {IProps} from \"./interfaces\";\nimport $ from \"./logic\";\n\nconst ReactForm = (props: IProps) => {\n  const {onSubmit, ...restProps} = props;\n  const onSubmitForm = (event: FormEvent) => $.handleSubmit(event, onSubmit);\n\n  return (\n    <Form onSubmit={onSubmitForm} {...restProps}>\n      {props.children}\n    </Form>\n  );\n}\n\nexport {ReactForm};","import React, {useEffect, useRef, useState} from \"react\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {Button, Card} from \"react-bootstrap\";\nimport {ReactForm} from \"../../shared/form/react-form\";\nimport {Single} from \"../../services/single\";\nimport {AllMessagesZespResponseValidator} from \"../../services/zesp/common/ZespResponseValidators\";\n\nconst maxMessagesCount = 15;\nconst predefinedMessages = [\"getDeviceList\", \"get_Mi_lamp\", \"LoadJson|/location.json\", \"LoadJson|/groups.json\"];\nconst predefinedBinary = [\"01 0000 01 0100\", \"01 0000 01 0000\"];\n\ninterface IFormData {\n  messageToSend?: string,\n}\n\nexport default () => {\n  const [messages, _setMessages] = useState<string[]>([]);\n  const [messageSendValue, setMessageSendValue] = useState<string>(\"\");\n\n  const messagesRef = useRef(messages);\n\n  const addMessages = (message: string) => {\n    const data: string[] = [message.substr(0, 250), ...messagesRef.current];\n    const cutCount = data.length - maxMessagesCount;\n    if (cutCount > 0) data.splice(data.length - cutCount, cutCount)\n\n    messagesRef.current = data;\n    _setMessages(data);\n  }\n\n  const onSend = (data: IFormData) => {\n    if (!data.messageToSend) return;\n    addMessages(`>${data.messageToSend}`);\n    Single.ZespConnector.send(data.messageToSend);\n  }\n\n  const onSendPredefined = (event: React.MouseEvent): void => {\n    const el = event.target as HTMLButtonElement;\n    const data = el.innerText;\n    setMessageSendValue(data);\n  }\n\n  const onSendBinary = (message?: string | null): void => {\n    // const p1 = \"01\";\n    // const deviceId = \"0000\";\n    // const epn = \"01\"; // ???\n    // const cmd = \"0000\";\n    // const data = p1 + deviceId + epn + cmd;\n\n    const data = (message || messageSendValue).replaceAll(\" \", \"\");\n    const dataHex = data.match(/[\\da-f]{2}/gi)?.map(group => parseInt(group, 16)) as ArrayLike<number>;\n    const dataToSend = new Uint8Array(dataHex);\n\n    addMessages(`>bin: ${data} (${dataToSend})`);\n    Single.ZespConnector.send(dataToSend);\n\n    // 010000010000\n    // 01 0000 01 0000\n    // 00000000: 0100 0001 0000\n    // OFF \\\"01\"+ Device +epn+\"0000\\\"\n    // ON \\\"01\"+ Device +epn+\"0100\\\"\n  }\n\n  const onClearLog = () => {\n    messagesRef.current = [];\n    _setMessages([]);\n  }\n\n  useEffect(() => {\n    const listener = Single.ZespConnector.subscribe(AllMessagesZespResponseValidator, (event) => {\n      const message = event.response;\n      addMessages(message);\n    });\n    return () => Single.ZespConnector.unsubscribe(listener);\n  }, []);\n\n  return (\n\n    <FadeIn>\n      <ReactForm onSubmit={onSend}>\n        <Card>\n          <Card.Header>WebSocket tester (FOR DEVELOPMENT ONLY)</Card.Header>\n          <Card.Body>\n            <div className=\"row mb-2\">\n              <label className=\"col-md-3 col-lg-2\">Message to send</label>\n              <div className=\"col\">\n                <input type=\"text\" className=\"form-control\" id=\"messageToSend\" value={messageSendValue} onChange={event => setMessageSendValue(event.target.value)}/>\n              </div>\n            </div>\n            <div className=\"row\">\n              <div className=\"col-md-3 col-lg-2\"/>\n              <div className=\"col\">\n                <div>\n                  {predefinedMessages.map((x, i) => (\n                    <button key={i} type=\"submit\" className=\"btn btn-sm btn-outline-primary me-1\" onClick={onSendPredefined}>{x}</button>\n                  ))}\n                </div>\n                <div className=\"mt-1\">\n                  {predefinedBinary.map((x, i) => (\n                    <button key={i} type=\"button\" className=\"btn btn-sm btn-outline-secondary me-1\" onClick={() => {\n                      setMessageSendValue(x);\n                      onSendBinary(x);\n                    }}>{x}</button>\n                  ))}\n                </div>\n              </div>\n            </div>\n          </Card.Body>\n          <Card.Footer>\n            <Button variant=\"primary\" type=\"submit\">Send message</Button>\n            <Button variant=\"secondary\" type=\"button\" onClick={() => onSendBinary()} className=\"ms-2\">Send binary</Button>\n          </Card.Footer>\n        </Card>\n      </ReactForm>\n\n      <Card className=\"mt-4\">\n        <Card.Header>\n          <span>Communication log <span className=\"badge bg-secondary small\">{messages.length}</span></span>\n          <button className=\"btn btn-outline-secondary ms-3 btn-sm\" onClick={onClearLog}>Clear log</button>\n        </Card.Header>\n        <Card.Body>\n          {messages.map((message, i) => message.startsWith(\">\")\n            ? (<div key={i} className=\"px-2 mb-3 py-1 m-1 bg-success bg-opacity-25 rounded\">{message.substr(1)}</div>)\n            : (<div key={i} className=\"border-start mb-3 border-3 border-warning p-0 d-flex flex-wrap\">{message.split(\"|\").map((x, i2) => (\n              <span key={i2} className=\"bg-warning bg-opacity-25 m-1 px-2 rounded\">{x}</span>\n            ))}</div>))}\n        </Card.Body>\n      </Card>\n    </FadeIn>\n  );\n}","import React from \"react\";\nimport {Col, Form, Row} from \"react-bootstrap\";\n\ntype Props = {\n  defaultValue?: string | number | boolean | undefined;\n  controlId: string;\n  label: string;\n  placeholder?: string;\n  type?: \"text\" | \"password\";\n};\n\nconst Result = ({controlId, label, placeholder, defaultValue, type = \"text\"}: Props) => {\n  let inputProps = ({\n    placeholder,\n    type\n  });\n\n  if (defaultValue) inputProps = ({...inputProps, ...{defaultValue: defaultValue.toString()}});\n\n  return (\n    <Form.Group as={Row} className=\"mb-3\" controlId={controlId}>\n      <Form.Label column md=\"3\" lg=\"2\">{label}</Form.Label>\n      <Col>\n        <Form.Control {...inputProps} />\n      </Col>\n    </Form.Group>\n  );\n}\n\nexport default Result;\n","import React from \"react\";\nimport {Form} from \"react-bootstrap\";\n\ntype IProps = {\n  defaultChecked?: boolean | number | string;\n  controlId: string;\n  label: string;\n  checkedValue?: string | number | boolean | undefined;\n  uncheckedValue?: string | number | boolean | undefined;\n};\n\nconst Result = ({controlId, label, defaultChecked, checkedValue = \"true\", uncheckedValue = \"false\"}: IProps) => {\n  const defaultCheckedBool =\n    defaultChecked === \"true\" ||\n    defaultChecked === \"1\" ||\n    defaultChecked === 1 ||\n    defaultChecked === true ||\n    false;\n\n  let props = {checked_value: checkedValue, unchecked_value: uncheckedValue};\n  if (defaultChecked) props = ({...props, ...{defaultChecked: defaultCheckedBool}});\n\n  return (\n    <Form.Group controlId={controlId} className=\"d-inline-block\">\n      <Form.Label className=\"d-flex\">\n        <Form.Check className=\"pe-2\" {...props}/><span>{label}</span>\n      </Form.Label>\n    </Form.Group>\n  );\n}\n\nexport default Result;","import React, {Fragment} from \"react\";\nimport {useTranslation} from \"react-i18next\";\nimport {Button, Card, Col, Row} from \"react-bootstrap\";\nimport {CheckGroupInline, InputGroupHorizontal} from \"../../shared/form\";\nimport {ReactForm} from \"../../shared/form/react-form\";\nimport {useGlobalState} from \"../../shared/global-state-provider\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {ZespMqttSettings} from \"../../services/zesp/models/ZespSettings\";\nimport {SaveSettings} from \"./index\";\n\nconst Result = () => {\n  const globalState = useGlobalState();\n  const {t} = useTranslation([\"pages.setup-mqtt\", \"common\"]);\n  const settings = globalState.state.zespSettings?.MQTT;\n\n  if (!settings) return (<Fragment/>);\n\n  const onSubmit = (data: ZespMqttSettings) => SaveSettings({MQTT: data}, globalState, t);\n\n  return (\n    <FadeIn>\n      <Card>\n        <ReactForm onSubmit={onSubmit}>\n          <Card.Body>\n            <InputGroupHorizontal controlId=\"mqttup\" defaultValue={settings.mqttup} label={t(\"topic.label\")} placeholder={t(\"topic.placeholder\")}/>\n            <InputGroupHorizontal controlId=\"mqtt\" defaultValue={settings.mqtt} label={t(\"server.label\")} placeholder={t(\"server.placeholder\")}/>\n            <InputGroupHorizontal controlId=\"mqttPort\" defaultValue={(settings.mqttPort)?.toString()} label={t(\"port.label\")} placeholder={t(\"port.placeholder\")}/>\n            <InputGroupHorizontal controlId=\"mqttLogin\" defaultValue={settings.mqttLogin} label={t(\"login.label\")} placeholder={t(\"login.placeholder\")}/>\n            <InputGroupHorizontal type=\"password\" controlId=\"mqttPassw\" defaultValue={settings.mqttPassw} label={t(\"password.label\")} placeholder={t(\"password.placeholder\")}/>\n            <Row>\n              <Col md=\"3\" lg=\"2\"/>\n              <Col className=\"space-between-4\">\n                <CheckGroupInline controlId=\"mqttEnable\" defaultChecked={settings.mqttEnable} label={t(\"is_enabled.label\")} checkedValue={1} uncheckedValue={0}/>\n                <CheckGroupInline controlId=\"Home_Assistant\" defaultChecked={settings.Home_Assistant} label={t(\"is_ha_enabled.label\")} checkedValue={1} uncheckedValue={0}/>\n              </Col>\n            </Row>\n\n          </Card.Body>\n          <Card.Footer><Button variant=\"primary\" type=\"submit\">{t(\"common:save_button\")}</Button></Card.Footer>\n        </ReactForm>\n      </Card>\n    </FadeIn>\n  );\n}\n\nexport default Result;","import React from \"react\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\n\nconst Result = () => (\n  <FadeIn>\n    <div className=\"px-4 py-5 bg-light rounded-3\">\n      <div className=\"container-fluid\">\n        <h1 className=\"display-5 fw-bold\">Not implemented yet!</h1>\n        <p className=\"col-md-8 fs-4\">\n          Hello, my dear friend! Just imagine how awesome this feature can be and share it with developers ~_~ <br/><br/>\n          Or you can even implement it yourself, everything you need is just to jump to source codes, made some magic, test it and that's it!\n        </p>\n        <hr className=\"my-4\"/>\n        <p>This feature is under contruction. You can find latest verion on <a href=\"#\">github project page</a> or just click this big blue button bellow.</p>\n        <a href=\"#\" target={\"_blank\"} rel=\"noreferrer\" className=\"btn btn-primary btn-lg\" type=\"button\">Learn more</a>\n      </div>\n    </div>\n    {/*<div className=\"jumbotron\">*/}\n    {/*  <h1 className=\"display-4\">Not implemented yet!</h1>*/}\n    {/*  <p className=\"lead\">*/}\n    {/*    Hello, my dear friend! Just imagine how awesome this feature can be and share it with developers ~_~ <br/>*/}\n    {/*    Or you can even implement it yourself, everything you need is just to jump to source codes, made some magic, test it and that's it!*/}\n    {/*  </p>*/}\n    {/*  <hr className=\"my-4\"/>*/}\n    {/*  <p>This feature is under contruction. You can find latest verion on <a href=\"#\">github project page</a> or just click this big blue button bellow.</p>*/}\n    {/*  <a className=\"btn btn-primary btn-lg\" href=\"#\" target={\"_blank\"} rel=\"noreferrer\" role=\"button\">Learn more</a>*/}\n    {/*</div>*/}\n  </FadeIn>\n);\n\nexport default Result;","import React, {Fragment} from \"react\";\nimport {Button, Card} from \"react-bootstrap\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {useGlobalState} from \"../../shared/global-state-provider\";\nimport {useTranslation} from \"react-i18next\";\nimport {ReactForm} from \"../../shared/form/react-form\";\nimport {InputGroupHorizontal} from \"../../shared/form\";\nimport {ZespWifiSettings} from \"../../services/zesp/models/ZespSettings\";\nimport {SaveSettings} from \"./index\";\n\nconst Result = () => {\n  const globalState = useGlobalState();\n  const {t} = useTranslation([\"pages.setup-wifi\", \"common\"]);\n  const settings = globalState.state.zespSettings?.Wifi;\n\n  if (!settings) return (<Fragment/>);\n\n  const onSubmit = (data: ZespWifiSettings): Promise<void> => SaveSettings({Wifi: data}, globalState, t);\n\n  return (\n    <Fragment>\n      <FadeIn>\n        <ReactForm onSubmit={onSubmit}>\n          <Card>\n            <Card.Body>\n              <InputGroupHorizontal controlId=\"ssid\" defaultValue={settings?.ssid} label={t(\"ssid.label\")} placeholder={t(\"ssid.placeholder\")}/>\n              <InputGroupHorizontal type=\"password\" controlId=\"pass\" defaultValue={settings?.pass} label={t(\"pass.label\")} placeholder={t(\"pass.placeholder\")}/>\n              <InputGroupHorizontal controlId=\"ip\" defaultValue={settings?.ip} label={t(\"ip.label\")} placeholder={t(\"ip.placeholder\")}/>\n              <InputGroupHorizontal controlId=\"mask\" defaultValue={settings?.mask} label={t(\"mask.label\")} placeholder={t(\"mask.placeholder\")}/>\n              <InputGroupHorizontal controlId=\"gw\" defaultValue={settings?.gw} label={t(\"gw.label\")} placeholder={t(\"gw.placeholder\")}/>\n            </Card.Body>\n            <Card.Footer><Button variant=\"primary\" type=\"submit\">{t(\"common:save_button\")}</Button></Card.Footer>\n          </Card>\n        </ReactForm>\n      </FadeIn>\n    </Fragment>\n  )\n};\n\nexport default Result;","import React, {Fragment} from \"react\";\nimport {Route} from \"react-router-dom\";\nimport {DevicesPage, MainPage, SetupPage, DeviceInfoPage, SocketTestPage} from \"./pages\";\nimport {NotImplementedYetPage, SetupMqttPage, SetupWifiPage} from \"./pages/setup/setup-pages\";\n\nexport const Routes = () => (\n  <Fragment>\n      <Route exact path=\"/\" component={MainPage}/>\n        <Route path=\"/devices\" component={DevicesPage}/>\n        <Route path=\"/devices/:ieee-:device\" component={DeviceInfoPage}/>\n      <Route path=\"/setup\" component={SetupPage}/>\n      <Route exact path=\"/setup\" component={SetupWifiPage}/>\n      <Route path=\"/setup/mqtt\" component={SetupMqttPage}/>\n      <Route path=\"/setup/zigbee\" component={NotImplementedYetPage}/>\n      <Route path=\"/setup/telegram\" component={NotImplementedYetPage}/>\n      <Route path=\"/setup/z2m\" component={NotImplementedYetPage}/>\n    <Route path=\"/setup/zesp-ui\" component={NotImplementedYetPage}/>\n    <Route path=\"/socket-test\" component={SocketTestPage}/>\n  </Fragment>\n)","import React from \"react\";\nimport \"./styles.scss\";\nimport {Card} from \"react-bootstrap\";\nimport {NavLink} from \"react-router-dom\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {IServerInfo} from \"./interfaces\";\nimport {useTranslation} from \"react-i18next\";\n\ninterface IProps {\n  openAddServer: () => void,\n  openEditAction: (server: IServerInfo) => void,\n  openServerAction: (index: number) => void,\n  servers: IServerInfo[]\n}\n\nexport default (props: IProps) => {\n  const {t} = useTranslation(\"pages.welcome\");\n  const sortedServers = props.servers\n    .map((server, index) => ({server, index}))\n    .sort((a, b) => a.server.name > b.server.name ? 1 : -1);\n\n  return (\n    <div className=\"container welcome-page h-100\">\n      <FadeIn>\n        <Card className=\"text-start\">\n          <Card.Header>{t(\"list.title\")}</Card.Header>\n          <Card.Body>\n            {props.servers.length == 0 && (\n              <div>{t(\"list.add_message\")}</div>\n            )}\n            {props.servers.length > 0 && (\n              <nav className=\"servers-list\">\n                {sortedServers.map((data, i) => (\n                  <div className=\"item\" key={`item-${i}`}>\n                    <NavLink\n                      className=\"server-button\"\n                      to=\"/\"\n                      onClick={(e) => {\n                        props.openServerAction(data.index);\n                        e.preventDefault();\n                      }}\n                      activeClassName=\"none\"><i className=\"bi bi-caret-right-fill\"/> {data.server.name}</NavLink>\n                    <button type=\"button\" onClick={() => props.openEditAction(data.server)} className=\"edit-button\"><i className=\"bi bi-pencil-fill\"/></button>\n                  </div>\n                ))}\n              </nav>\n            )}\n          </Card.Body>\n          <Card.Footer className=\"text-right\">\n            <button type=\"button\" onClick={props.openAddServer} className=\"btn btn-primary\">{t(\"list.add_button\")}</button>\n          </Card.Footer>\n        </Card>\n      </FadeIn>\n    </div>\n  )\n}","import React, {useState} from \"react\";\nimport \"./styles.scss\";\nimport {Card, FormControl, InputGroup, OverlayTrigger, Popover} from \"react-bootstrap\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {IServerInfo} from \"./interfaces\";\nimport {ReactForm} from \"../../shared/form/react-form\";\nimport {useTranslation} from \"react-i18next\";\n\ninterface IProps {\n  closeAction: () => void;\n  deleteAction: () => void;\n  addAction: (data: IServerInfo) => void;\n  updateAction: (data: IServerInfo) => void;\n  editServer?: IServerInfo;\n}\n\nexport default (props: IProps) => {\n  const {t} = useTranslation(\"pages.welcome\");\n  const [deleteConfirmed, setDeleteConfirmed] = useState(false);\n\n  const onSubmit = (data: IServerInfo): Promise<void> => {\n    if (props.editServer) props.updateAction(data);\n    else props.addAction(data);\n\n    return Promise.resolve();\n  }\n\n  const onDeleteClicked = () => {\n    if (!deleteConfirmed) return;\n    props.deleteAction();\n  }\n\n  const popover = (\n    <Popover id=\"popover-basic\">\n      <Popover.Header as=\"h3\">{t(\"edit.delete_title\")}</Popover.Header>\n      <Popover.Body><span dangerouslySetInnerHTML={{__html: t(\"edit.delete_message\")}}/></Popover.Body>\n    </Popover>\n  );\n\n  return (\n    <div className=\"container welcome-page h-100\">\n      <FadeIn>\n        <ReactForm onSubmit={onSubmit}>\n          <Card className=\"text-start\">\n            <Card.Header className=\"d-flex justify-content-between\">\n              <span className=\"modal-title\">{t(\"edit.title\")}</span>\n              <button type=\"button\" className=\"btn-close\" aria-label=\"Close\" onClick={props.closeAction}/>\n            </Card.Header>\n            <Card.Body>\n              <FormControl className=\"mb-2\" id=\"name\" defaultValue={props.editServer?.name} placeholder={t(\"edit.name_input_placeholder\")}/>\n              <InputGroup>\n                <InputGroup.Text id=\"basic-addon3\">{document.location.protocol === \"https:\" ? \"wss\" : \"ws\"}://</InputGroup.Text>\n                <FormControl id=\"address\" defaultValue={props.editServer?.address} aria-describedby=\"basic-addon3\" placeholder={t(\"edit.address_input_placeholder\")}/>\n              </InputGroup>\n            </Card.Body>\n\n            {props.editServer && (\n              <Card.Footer className=\"d-flex justify-content-between\">\n                {/*<button type=\"button\" onClick={props.deleteAction} className=\"btn btn-outline-danger\">Delete</button>*/}\n                <div>\n                  <OverlayTrigger trigger=\"click\" placement=\"top\" overlay={popover} rootClose={true} onToggle={setDeleteConfirmed}>\n                    <button onClick={onDeleteClicked} type=\"button\" className=\"btn btn-outline-danger\">{t(\"edit.delete_button\")}</button>\n                  </OverlayTrigger>\n                </div>\n                <button type=\"submit\" className=\"btn btn-primary\">{t(\"edit.save_button\")}</button>\n              </Card.Footer>\n            )}\n\n            {!props.editServer && (\n              <Card.Footer className=\"text-right\">\n                <button type=\"submit\" className=\"btn btn-primary\">{t(\"edit.add_button\")}</button>\n              </Card.Footer>\n            )}\n          </Card>\n        </ReactForm>\n      </FadeIn>\n    </div>\n  )\n}","// Copy-pasted from here: https://usehooks-typescript.com/react-hook/use-local-storage\n\nimport {Dispatch, SetStateAction, useEffect, useState} from 'react'\n\ntype SetValue<T> = Dispatch<SetStateAction<T>>\n\nexport function useLocalStorage<T>(key: string, initialValue: T): [T, SetValue<T>] {\n  // Get from local storage then\n  // parse stored json or return initialValue\n  const readValue = (): T => {\n    // Prevent build error \"window is undefined\" but keep keep working\n    if (typeof window === 'undefined') {\n      return initialValue\n    }\n\n    try {\n      const item = window.localStorage.getItem(key)\n      return item ? (JSON.parse(item) as T) : initialValue\n    } catch (error) {\n      console.warn(`Error reading localStorage key “${key}”:`, error)\n      return initialValue\n    }\n  }\n\n  // State to store our value\n  // Pass initial state function to useState so logic is only executed once\n  const [storedValue, setStoredValue] = useState<T>(readValue)\n\n  // Return a wrapped version of useState's setter function that ...\n  // ... persists the new value to localStorage.\n  const setValue: SetValue<T> = value => {\n    // Prevent build error \"window is undefined\" but keeps working\n    if (typeof window == 'undefined') {\n      console.warn(\n        `Tried setting localStorage key “${key}” even though environment is not a client`,\n      )\n    }\n\n    try {\n      // Allow value to be a function so we have the same API as useState\n      const newValue = value instanceof Function ? value(storedValue) : value\n\n      // Save to local storage\n      window.localStorage.setItem(key, JSON.stringify(newValue))\n\n      // Save state\n      setStoredValue(newValue)\n\n      // We dispatch a custom event so every useLocalStorage hook are notified\n      window.dispatchEvent(new Event('local-storage'))\n    } catch (error) {\n      console.warn(`Error setting localStorage key “${key}”:`, error)\n    }\n  }\n\n  useEffect(() => {\n    setStoredValue(readValue())\n  }, [])\n\n  useEffect(() => {\n    const handleStorageChange = () => {\n      setStoredValue(readValue())\n    }\n\n    // this only works for other documents, not the current one\n    window.addEventListener('storage', handleStorageChange)\n\n    // this is a custom event, triggered in writeValueToLocalStorage\n    window.addEventListener('local-storage', handleStorageChange)\n\n    return () => {\n      window.removeEventListener('storage', handleStorageChange)\n      window.removeEventListener('local-storage', handleStorageChange)\n    }\n  }, [])\n\n  return [storedValue, setValue]\n}\n","import React, {FunctionComponent, useState} from \"react\";\nimport \"./styles.scss\";\nimport {IServerInfo, WelcomePageParts} from \"./interfaces\";\nimport PartItems from \"./part-items\";\nimport PartEdit from \"./part-edit\";\nimport {useLocalStorage} from \"../../services/localStorage\";\nimport {useGlobalState} from \"../../shared/global-state-provider\";\n\nexport const WelcomePage: FunctionComponent = () => {\n  const globalState = useGlobalState();\n  const [currentPart, setCurrentPart] = useState<WelcomePageParts>(\"welcome\");\n  const [editServer, setEditServer] = useState<IServerInfo>();\n  const [servers, setServers] = useLocalStorage<IServerInfo[]>(\"servers\", []);\n\n  // const servers: IServerInfo[] = [];\n\n  const backToWelcomeAction = () => {\n    setEditServer(undefined);\n    setCurrentPart(\"welcome\");\n  }\n\n  const openAddAction = () => {\n    setEditServer(undefined);\n    setCurrentPart(\"edit\");\n  }\n\n  const openEditAction = (server: IServerInfo) => {\n    setEditServer(server);\n    setCurrentPart(\"edit\");\n  }\n\n  const addAction = (server: IServerInfo) => {\n    servers.push(server)\n    setServers(servers);\n    backToWelcomeAction();\n  }\n\n  const updateAction = (server: IServerInfo) => {\n    const index = servers.indexOf(editServer!);\n    servers[index] = server;\n    setServers(servers);\n\n    console.log(servers);\n    backToWelcomeAction();\n  }\n\n  const deleteAction = () => {\n    setServers(servers.filter(server => server !== editServer));\n    backToWelcomeAction();\n  };\n\n  const openServerAction = (index: number) => {\n    // const selectedServer = servers[index];\n    // console.log(selectedServer);\n    // console.log(index);\n    globalState.setState(prev => ({...prev, ...{selectedServerIndex: index}}));\n  }\n\n  if (currentPart === \"edit\") return (\n    <PartEdit editServer={editServer} addAction={addAction} updateAction={updateAction} closeAction={backToWelcomeAction} deleteAction={deleteAction}/>);\n  return (<PartItems servers={servers} openAddServer={openAddAction} openEditAction={openEditAction} openServerAction={openServerAction}/>);\n}","import React, {Fragment, useEffect} from 'react';\nimport {BrowserRouter as Router, Switch} from \"react-router-dom\";\nimport './bootstrap-updates.scss';\nimport './App.scss';\nimport TopMenu from \"./shared/top-menu\";\nimport LoadingSpinner from \"./shared/loading-spinner\";\nimport {GlobalStateProvider, useGlobalState} from \"./shared/global-state-provider\";\nimport {Single} from \"./services/single\";\nimport {ZespService} from \"./services/zesp\";\nimport toast, {Toaster} from \"react-hot-toast\";\nimport {Routes} from \"./Routes\";\nimport {WelcomePage} from \"./pages/welcome\";\nimport {useLocalStorage} from \"./services/localStorage\";\nimport {IServerInfo} from \"./pages/welcome/interfaces\";\n\nconst Content = () => {\n  const globalState = useGlobalState();\n  const [servers] = useLocalStorage<IServerInfo[]>(\"servers\", []);\n  const selectedServer = (\n    globalState.state.selectedServerIndex === null || servers.length <= globalState.state.selectedServerIndex!\n      ? null\n      : servers[globalState.state.selectedServerIndex!]\n  );\n\n  return selectedServer ? (<App server={selectedServer}/>) : (<WelcomePage/>);\n  // return <WelcomePage/>;\n}\n\nconst App = (props: { server: IServerInfo }) => {\n  const globalState = useGlobalState();\n\n  useEffect(() => {\n    Single.Spinner.init(globalState);\n    Single.Spinner.show();\n\n    Single.ZespConnectorPromise\n      .then(zesp => zesp.connectAsync(globalState, props.server))\n      .then(() => ZespService.general.initAsync(globalState))\n      .then(() => {\n        globalState.setState(prev => ({...prev, ...{appInitialized: true}}))\n        Single.Spinner.hide();\n      })\n      .catch(error => {\n        globalState.setState(prev => ({\n          ...prev, ...{\n            appInitialized: false,\n            selectedServerIndex: null,\n          }\n        }))\n        Single.ZespConnector.disconnect();\n        Single.Spinner.hide();\n\n        toast.error(`Ooops, cannot connect to the server (${props.server.address}). ${error}`); //TODO localization\n      });\n  }, []);\n\n  if (!globalState.state.appInitialized) {\n    return (<Fragment/>);\n  }\n\n  return (\n    <div className=\"container-md d-flex w-100 h-100 p-3 mx-auto flex-column\">\n      <header className=\"masthead\">\n        <a href=\"/\"><h3 className=\"masthead-brand\">ZESP:UI</h3></a>\n        <TopMenu/>\n      </header>\n      <main role=\"main\" className=\"text-start d-flex flex-grow-1 flex-column\">\n        <Routes/>\n      </main>\n      <footer className=\"mastfoot mt-3\">\n        <p>ZESP UI application, by <a href=\"https://t.me/NickRimmer\" target={\"_blank\"} rel=\"noreferrer\">@NickRimmer</a>. (0.0.0 version, <span>dev build</span>)\n        </p>\n      </footer>\n    </div>\n  )\n}\n\nconst Result = () => {\n  return (\n    <Router>\n      <Switch>\n        <GlobalStateProvider>\n          <Content/>\n          <LoadingSpinner/>\n          <Toaster/>\n        </GlobalStateProvider>\n      </Switch>\n    </Router>\n  );\n}\n\nexport default Result;","import {ReportHandler} from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({getCLS, getFID, getFCP, getLCP, getTTFB}) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport './loader.js';\nimport \"bootstrap/dist/js/bootstrap.bundle\";\nimport './i18n/config';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App/>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import i18n from \"i18next\";\nimport {initReactI18next} from \"react-i18next\";\n\nconst languages = [\"en\"];\nconst namespaces = [\n    \"common\",\n    \"nav\",\n    \"pages.setup-mqtt\",\n    \"pages.setup-wifi\",\n    \"pages.welcome\",\n    \"pages.devices\",\n];\n\nconst i18next = i18n.use(initReactI18next);\ni18next.init({\n    fallbackLng: languages[0],\n    lng: languages[0],\n    resources: loadResources(),\n    ns: namespaces,\n    defaultNS: 'common'\n});\ni18n.languages = languages;\n\nfunction loadResources() {\n    const result = {};\n\n    for (let lang of languages) {\n        result[lang] = {};\n\n        for (let ns of namespaces) {\n            const path = `./locales/${lang}/${ns.replace(\".\", \"/\")}.json`;\n            try {\n                // eslint-disable-next-line \n                result[lang][ns] = require('' + path); // wtf with JS???\n                console.debug(`${path} (ok)`);\n            } catch (error) {\n                // it's ok\n                console.debug(`${path} (error)`);\n            }\n        }\n    }\n\n    return result;\n}\n\nexport default i18n;"],"sourceRoot":""}