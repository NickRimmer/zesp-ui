(this["webpackJsonpzesp-ui-app"]=this["webpackJsonpzesp-ui-app"]||[]).push([[0],{113:function(e,t,n){},120:function(e){e.exports=JSON.parse('{"save_button":"Save changes","saving_success":"Saving successful","saving_error":"Oops... we cannot complete it )=","saving_progress":"Saving in progress..."}')},121:function(e){e.exports=JSON.parse('{"home":"Home","devices":"Devices","setup":"Settings"}')},122:function(e){e.exports=JSON.parse('{"groups":{"hub":"Hub devices","sensors":"Sensors or monitoring systems","switches":"Switches","lights":"Lights and bulbs","other":"Other or unknown devices","all":"All registered devices"}}')},123:function(e){e.exports=JSON.parse('{"topic":{"label":"Topic name","placeholder":"Enter MQTT topic name (e.g. zesp32)"},"server":{"label":"Server address","placeholder":"Enter MQTT server address (e.g. 192.168.1.1)"},"port":{"label":"Server port","placeholder":"Enter MQTT server port (e.g. 1883)"},"login":{"label":"MQTT Login","placeholder":"Enter MQTT user login (e.g. mqtt)"},"password":{"label":"MQTT Password","placeholder":"Enter MQTT user password (e.g. pa$vv0rd)"},"is_enabled":{"label":"Client is enabled"},"is_ha_enabled":{"label":"Home Assistant"}}')},124:function(e){e.exports=JSON.parse('{"ssid":{"label":"WIFI SSID","placeholder":"Enter SSID of your wifi AP (e.g. MySecretWifi)"},"pass":{"label":"WIFI Password","placeholder":"Enter your connection password (e.g. super-duper-password)"},"ip":{"label":"Local address","placeholder":"Enter static IP address and port of device with ZESP (e.g. 192.168.1.2:8082)"},"mask":{"label":"Local mask address","placeholder":"Enter device network mask (e.g. 255.255.255.0)"},"gw":{"label":"Gateway address","placeholder":"Enter gateway address (e.g. 192.168.1.1)"}}')},125:function(e){e.exports=JSON.parse('{"list":{"title":"Welcome here, stranger!","add_button":"Add a new server","add_message":"There is no servers added. Please, click this big blue button bellow to add your awesome server."},"edit":{"title":"Connection settings","delete_button":"Delete","delete_title":"Delete confirmation","delete_message":"Are you <strong>sure</strong> you want to delete it?<br/>Just asking, no pressure... if you want to continue, smash <span class=\'badge bg-danger\'>Delete</span> button bellow one more time.","save_button":"Save changes","add_button":"Add server","name_input_placeholder":"Enter display name (e.g. My hub4fun)","address_input_placeholder":"Your server address (e.g. 192.168.1.1)"}}')},152:function(e){e.exports=JSON.parse('[{"id":"on_off_root","arguments":{"commandOn":"01 0000 01  0100","commandOff":"01 0000 01  0000"},"reportKey":{"endpoint":"01","clusterId":"0006","attributeId":"0000"}},{"id":"level_root","arguments":{"command":"MoveToLevel|0000|1|1|1|{value}|0009","min":0,"max":255},"reportKey":{"endpoint":"FF","clusterId":"BBBB","attributeId":"0001"}},{"id":"rgb_root","arguments":{"command":"MoveToColor|0000|1|1|{x}|{y}|0001"},"reportKey":{"endpoint":"FF","clusterId":"BBBB","attributeId":"0002"}},{"id":"illuminance_sensor","reportKey":{"endpoint":"01","clusterId":"0106","attributeId":"0000"}},{"id":"level_control","group":"Playback","label":"Volume","arguments":{"command":"setVolume|{value:dec}","min":0,"max":32768},"reportKey":{"endpoint":"FF","clusterId":"BBBB","attributeId":"0003"}},{"id":"player_src_root","group":"Playback","reportKey":{"endpoint":"FF","clusterId":"BBBB","attributeId":"0004"}},{"id":"player_control_root","group":"Playback","arguments":{"commandOn":"playSound|{value}","commandOff":"killSound|0"},"reportKey":{"endpoint":"FF","clusterId":"BBBB","attributeId":"0005"}}]')},167:function(e){e.exports=JSON.parse('[{"modelIds":["ZESP_Root"],"image":"zesp.jpg","layout":"root.json"},{"modelIds":["lumi.sensor_switch"],"image":"default-sensor-switch.jpg"},{"modelIds":["lumi.sensor_motion"],"image":"default-sensor-motion.jpg"},{"modelIds":["lumi.sensor_magnet"],"image":"default-sensor-magnet.jpg"}]')},175:function(e,t,n){},176:function(e,t,n){window.$=window.jQuery=n(27),console.debug=function(){console.log("Debug logs are disabled")}},198:function(e,t,n){var c={"./config":94,"./config.js":94,"./locales/en/common":120,"./locales/en/common.json":120,"./locales/en/nav":121,"./locales/en/nav.json":121,"./locales/en/pages/devices":122,"./locales/en/pages/devices.json":122,"./locales/en/pages/setup-mqtt":123,"./locales/en/pages/setup-mqtt.json":123,"./locales/en/pages/setup-wifi":124,"./locales/en/pages/setup-wifi.json":124,"./locales/en/pages/welcome":125,"./locales/en/pages/welcome.json":125};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(c,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return c[e]}r.keys=function(){return Object.keys(c)},r.resolve=o,e.exports=r,r.id=198},199:function(e,t,n){},200:function(e,t,n){},201:function(e,t,n){},215:function(e,t,n){},224:function(e,t,n){},225:function(e,t,n){},228:function(e,t,n){},335:function(e,t,n){var c={"./root":152,"./root.json":152};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(c,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return c[e]}r.keys=function(){return Object.keys(c)},r.resolve=o,e.exports=r,r.id=335},336:function(e,t,n){"use strict";n.r(t);var c,r,o,a,s=n(0),i=n.n(s),l=n(23),d=n.n(l),u=(n(175),n(176),n(177),n(94),n(2)),b=n(6),j=n(15),p=n(14),f=(n(199),n(200),n(352)),m=(n(201),n(1)),v=function(){var e=Object(f.a)("nav").t;return Object(m.jsxs)("nav",{className:"nav nav-masthead justify-content-center",children:[Object(m.jsx)(j.b,{className:"nav-link",to:"/devices",children:e("devices")}),!1,Object(m.jsx)(j.b,{className:"nav-link",to:"/setup",children:e("setup")})]})},O=n(27),h=n.n(O),g=(n(215),n(342)),x=Object(s.createContext)({state:{},setState:{}}),y=function(e){var t=e.children,n=e.value,c=void 0===n?{}:n;Object.assign(c,{spinnerLoadingShow:!1,zespConnected:!1,appInitialized:!1,zespSettings:void 0,selectedServerIndex:null,devices:[]});var r=Object(s.useState)(c),o=Object(b.a)(r,2),a=o[0],i=o[1];return Object(m.jsx)(x.Provider,{value:{state:a,setState:i},children:t})},S=function(){var e=Object(s.useContext)(x);if(!e)throw new Error("useGlobalState must be used within a GlobalStateContext");return e},N=function(){return S().state.spinnerLoadingShow?(setTimeout((function(){return h()(".loading-overlay").removeClass("hidden")}),0),Object(m.jsx)("div",{className:"loading-overlay hidden",children:Object(m.jsx)(g.a,{animation:"border",variant:"light"})})):Object(m.jsx)(s.Fragment,{})},w=n(159),I={ConnectionStartTimeout:500,VerifyConnectionTimeout:5e3,DefaultRequestTimeoutSeconds:5},_=n(35),C=n(48),k=n(52),E=n(170),z="zesp-data-received",T=function(e){Object(C.a)(n,e);var t=Object(k.a)(n);function n(e,c,r){var o;return Object(_.a)(this,n),(o=t.call(this,z)).dataType=void 0,o.response=void 0,o.dataParts=void 0,o.dataType=e,o.dataParts=c,o.response=r,o}return n}(Object(E.a)(Event));!function(e){e[e.Restart=1012]="Restart"}(c||(c={}));var F,L,R,P,B=new EventTarget,Z={connectAsync:function(e,t){return new Promise((function(n,c){return a?(console.warn("ZespConnector already initialized"),void n(R.ZespConnector)):(o=e,a=t,setTimeout((function(){return Z.reconnectAsync(!0).then((function(){return n(R.ZespConnector)})).catch((function(t){e().setState((function(e){return Object(u.a)(Object(u.a)({},e),{zespConnected:!1})})),c(t)}))}),I.ConnectionStartTimeout),F=setInterval((function(){return Z.reconnectAsync(!1).then((function(){return n(R.ZespConnector)})).catch((function(t){console.warn("Reconnection is failed: ".concat(t)),e().setState((function(e){return Object(u.a)(Object(u.a)({},e),{zespConnected:!1})})),c(t)}))}),I.VerifyConnectionTimeout),Z)}))},disconnect:function(){F&&(clearInterval(F),F=null),a=null,o().setState((function(e){return Object(u.a)(Object(u.a)({},e),{zespConnected:!1})}));try{var e,t,n,c,s,i,l;if(3===(null===(e=r)||void 0===e||null===(t=e.underlyingWebsocket)||void 0===t?void 0:t.readyState)||null==(null===(n=r)||void 0===n||null===(c=n.underlyingWebsocket)||void 0===c?void 0:c.readyState))return void console.debug("zesp connection already closed");if(1===(null===(s=r)||void 0===s||null===(i=s.underlyingWebsocket)||void 0===i?void 0:i.readyState))return console.debug("zesp connection closing..."),void r.close(1e3);null===(l=r)||void 0===l||l.close(1e3)}catch(d){}},reconnectAsync:function(e){return new Promise((function(t,n){var s,i,l,d;if(o||n("ZespConnector is not initialized yet"),a||n("Server configuration missed"),0!==(null===(s=r)||void 0===s||null===(i=s.underlyingWebsocket)||void 0===i?void 0:i.readyState))if(1!==(null===(l=r)||void 0===l||null===(d=l.underlyingWebsocket)||void 0===d?void 0:d.readyState)||e){console.debug("Start ws connection...");try{r.close(c.Restart)}catch(j){}o().setState((function(e){return Object(u.a)(Object(u.a)({},e),{zespConnected:!1})}));var b="https:"===document.location.protocol?"wss":"ws";r=new w.WebsocketBuilder("".concat(b,"://").concat(a.address,":81")).onOpen((function(){M(),t()})).onClose(A).onError((function(){V(),n("zesp connection error")})).onMessage(D).build()}else t();else n("Already connecting")}))},send:function(e){if(!o)throw new Error("ZespConnector is not initialized yet");var t=!0===e.isBinary?q(e.data):e.data;r.send(t)},requestAsync:function(e){return new Promise((function(t,n){(!e.timeoutSeconds||e.timeoutSeconds<=0)&&(e.timeoutSeconds=I.DefaultRequestTimeoutSeconds),!0!==e.isBinary&&(e.isBinary=!1);var c=!1,r=e.responseValidator,o=function e(n){var o=n;r.isValid(o)&&(c=!0,B.removeEventListener(z,e),t(o))};try{B.addEventListener(z,o),Z.send({data:e.data,isBinary:e.isBinary}),setTimeout((function(){c||(B.removeEventListener(z,o),console.warn("zesp response did not received (timeout: ".concat(e.timeoutSeconds," seconds)")),n("timeout"))}),1e3*e.timeoutSeconds)}catch(a){n("exception: ".concat(a))}}))},request:function(e){return new Promise((function(t,n){Z.requestAsync(e).then((function(n){e.onSuccess?e.onSuccess(n):console.debug("zesp request completed (".concat(e.responseValidator.name,")")),t(R.ZespConnector)})).catch((function(t){var c="".concat(t," (").concat(e.responseValidator.name,"; ").concat(e.data,")");e.onError?e.onError(c):console.warn("zesp request failed: ".concat(c)),n(c)}))}))},subscribe:function(e,t){var n=function(n){var c=n;e.isValid(c)&&t(c)};return B.addEventListener(z,n),n},unsubscribe:function(e){return B.removeEventListener(z,e)},getGlobalState:function(){return o()}},M=function(){console.debug("Zesp connection opened"),o().setState((function(e){return Object(u.a)(Object(u.a)({},e),{zespConnected:!0})}))},A=function(){console.debug("Zesp connection closed"),o().setState((function(e){return Object(u.a)(Object(u.a)({},e),{zespConnected:!1})}))},V=function(){console.debug("Zesp connection error happened )=")},D=function(e,t){var n=t.data.replace(/\|(?=([^"]*"[^"]*")*[^"]*$)/gi,"\0").split("\0");if(0!=n.length){var c=n.shift();/\/(.+)\.json/gi.exec(c)&&(n.unshift(c),c="json");var r=new T(c,n,t.data);B.dispatchEvent(r)}else console.warn("Received empty message from zesp")},q=function(e){var t,n=null===(t=e.replaceAll(" ","").match(/[\da-f]{2}/gi))||void 0===t?void 0:t.map((function(e){return parseInt(e,16)}));return new Uint8Array(n)},K=Z,J={init:function(e){L?console.warn("Loader spinner already initialized"):L=e},show:function(){return G(!0)},hide:function(){return G(!1)}},G=function(e){return L.setState((function(t){return Object(u.a)(Object(u.a)({},t),{spinnerLoadingShow:e})}))};(P=R||(R={})).ZespConnector=K,P.ZespConnectorPromise=new Promise((function(e){return e(R.ZespConnector)})),P.Spinner=J;var U=n(21),W=(n(224),function(e){var t=Object(s.useState)("show-transition hidden"),n=Object(b.a)(t,2),c=n[0],r=n[1];return setTimeout((function(){return r("show-transition")}),0),Object(m.jsx)("div",{className:c,children:e.children})}),H=(n(225),n(351)),Q=function(e){var t,n=(t=e.device).settings?t.settings.image:"zigbee.png",c="".concat(".","/device-images/").concat(n);return Object(m.jsx)("div",{className:"item-image",style:{backgroundImage:"url(".concat(c,")")}})};var Y=n(79),$=n(25),X=function(e,t,n){var c;return null===(c=e.state.devices)||void 0===c?void 0:c.find((function(e){return e.zespInfo.IEEE===t&&e.zespInfo.Device===n}))},ee=function(e){return(e.customLayout||ne(e)).reduce((function(e,t){var n=t.group||"main",c=e.find((function(e){return e.name===n}));return c||(c={name:n},e.push(c)),c.settings=[].concat(Object($.a)(c.settings||[]),[t]),e}),[])},te=function(e){if(10!=(null===e||void 0===e?void 0:e.length))throw Error("Unknown format of report key: ".concat(e));return{endpoint:e.substr(0,2),clusterId:e.substr(2,4),attributeId:e.substr(6,4)}},ne=function(e){return Object.keys(e.zespInfo.Report).map((function(t){return function(t){var n,c=te(t),r=Y.find((function(e){return e.clusterId==c.clusterId})),o={id:c.clusterId,reportKey:c};if(!r)return console.debug("Report key '".concat(t,"' with unregistered cluster '").concat(c.clusterId,"' received")),o;var a=null===(n=e.zespInfo.Report[t].role)||void 0===n?void 0:n.split("&");return a&&a.length>0?Object(u.a)(Object(u.a)({},o),ce(a,r,t)):r.attributes&&r.attributes[c.attributeId]||o}(t)}))},ce=function(e,t,n){var c=te(n),r=e[0],o=e.length>1?e[1]:null,a=t.attributes&&(t.attributes["".concat(c.attributeId,":").concat(r)]||t.attributes[r])||{id:r};return o&&(a.zespRoleSettings=JSON.parse(o)),a},re=function(e){for(var t=e.device.zespInfo,n=t.Name&&t.Name.length>0?t.Name:e.device.zespInfo.ModelId,c="/devices/".concat(t.IEEE,"-").concat(t.Device),r=[],o=function(){var e=s[a],t=te(e),n=Y.find((function(e){return e.clusterId===t.clusterId}));r.push((null===n||void 0===n?void 0:n.name)||t.clusterId)},a=0,s=Object.keys(t.Report);a<s.length;a++)o();return r=r.filter((function(e,t){return r.indexOf(e)==t})).sort((function(e,t){return e>t?1:-1})),Object(m.jsx)(j.b,{className:"item p-3 border rounded",to:c,children:Object(m.jsxs)("div",{className:"d-flex",children:[Object(m.jsx)("div",{children:Object(m.jsx)(Q,{device:e.device})}),Object(m.jsxs)("div",{className:"ps-2",children:[Object(m.jsx)("div",{className:"title",children:n}),Object(m.jsxs)("div",{className:"ieee text-muted small",children:[Object(m.jsx)("span",{className:"badge bg-info me-1",children:t.Device}),t.IEEE]}),r.length>0&&Object(m.jsx)("div",{className:"badges small",children:r.map((function(e,t){return Object(m.jsx)("span",{className:"badge bg-secondary",children:e},t)}))})]})]})})},oe=function(e){return 0==e.devices.length?Object(m.jsx)(s.Fragment,{}):Object(m.jsxs)("div",{className:"group border-top pt-4",children:[e.title&&Object(m.jsxs)("div",{className:"title h5 pb-3",children:[Object(m.jsx)("span",{children:e.title}),e.devices.length>1&&Object(m.jsx)("span",{className:"badge bg-secondary ms-2",children:e.devices.length})]}),Object(m.jsx)("div",{className:"items d-flex flex-wrap",children:e.devices.map((function(e,t){return Object(m.jsx)(re,{device:e},t)}))})]})},ae=function(){var e=S(),t=Object(f.a)("pages.devices").t;if(!e.state.devices||0==e.state.devices.length)return Object(m.jsx)("div",{children:"No devices found..."});var n=e.state.devices.sort();return Object(m.jsx)(W,{children:Object(m.jsx)("div",{className:"devices",children:Object(m.jsx)(H.a,{children:Object(m.jsx)(H.a.Body,{children:Object(m.jsx)(oe,{title:t("groups.all"),devices:n})})})})})},se=n(343),ie=n(349),le=n(168),de=function e(t){return{name:e.name,isValid:function(e){return e.dataType===t}}},ue={name:"AllZespResponseValidator",isValid:function(e){return!0}},be=function(){return new Promise((function(e,t){R.ZespConnector.requestAsync({data:"loadConfig",responseValidator:de("jsconfig")}).then((function(e){return function(e){var t=JSON.parse(e),n={};return Object.assign(n,t),n}(e.dataParts[0])})).then((function(t){return e(t)})).catch((function(e){return t(e)}))}))},je=function(e){var t=["SaveJson","/jsconfig.txt",JSON.stringify(e)].join("|");return new Promise((function(e,n){R.ZespConnector.requestAsync({data:t,responseValidator:de("ZD_RSP")}).then((function(t){"ok"===t.dataParts[1].toLocaleLowerCase()?e():n("Settings was not saved: ".concat(t.response))})).catch((function(e){return n(e)}))}))};var pe=function(e,t,n){var c=Object(u.a)(Object(u.a)({},t.state.zespSettings),e),r=je(c).then((function(){return t.setState((function(e){return Object(u.a)(Object(u.a)({},e),{},{zespSettings:c})}))}));return U.b.promise(r,{loading:n("common:saving_progress"),success:n("common:saving_success"),error:n("common:saving_error")}),r},fe=function(){var e=S();return Object(s.useEffect)((function(){R.Spinner.show(),be().then((function(t){e.setState((function(e){return Object(u.a)(Object(u.a)({},e),{zespSettings:t})})),R.Spinner.hide()})).catch((function(e){alert(e)}))}),[]),e.state.zespSettings?Object(m.jsxs)(W,{children:[Object(m.jsx)("div",{className:"aaa",children:"..."}),Object(m.jsx)(se.a,{className:"p-0",children:Object(m.jsxs)(ie.a,{variant:"pills",children:[Object(m.jsx)(ie.a.Item,{children:Object(m.jsx)(j.b,{className:"nav-link",to:"/setup",exact:!0,children:"Wifi client"})}),Object(m.jsx)(ie.a.Item,{children:Object(m.jsx)(j.b,{className:"nav-link",to:"/setup/zigbee",children:"Zigbee"})}),Object(m.jsx)(ie.a.Item,{children:Object(m.jsx)(j.b,{className:"nav-link",to:"/setup/mqtt",children:"MQTT client"})}),Object(m.jsx)(ie.a.Item,{children:Object(m.jsx)(j.b,{className:"nav-link",to:"/setup/telegram",children:"Telegram bot"})}),Object(m.jsx)(ie.a.Item,{children:Object(m.jsx)(j.b,{className:"nav-link",to:"/setup/z2m",children:"Z2M client"})}),Object(m.jsx)(ie.a.Item,{className:"ms-auto",children:Object(m.jsxs)(j.b,{className:"nav-link",to:"/setup/zesp-ui",children:[Object(m.jsx)(le.a,{style:{marginTop:"-3px"}})," ZESP:UI"]})})]})})]}):Object(m.jsx)(s.Fragment,{})},me=(n(228),n(348)),ve=function(e){var t=e.device.zespInfo.Name||e.device.zespInfo.ModelId,n=e.groups.length>1?"with-tabs":"",c=e.groups.length>1?Object(m.jsx)("ul",{className:"nav nav-tabs",children:e.groups.map((function(n,c){return Object(m.jsx)("li",{className:"nav-item",children:Object(m.jsx)("button",{type:"button",className:"btn btn-light nav-link ".concat(e.activeGroupName===n.name?"active":""),onClick:function(){return e.setActiveGroupName(n.name)},children:"main"===n.name?t:n.name})},c)}))}):Object(m.jsx)("div",{children:t});return Object(m.jsxs)(me.a.Header,{className:n,children:[Object(m.jsx)("div",{children:c}),Object(m.jsxs)("div",{className:"text-end modal-right-buttons",children:[e.onDetailsClicked&&Object(m.jsx)("button",{type:"button",className:"btn",onClick:e.onDetailsClicked,children:Object(m.jsx)("i",{className:"bi bi-archive"})}),Object(m.jsx)("span",{className:"border-end mx-3"}),Object(m.jsx)("button",{type:"button",className:"btn-close me-1","aria-label":"Close",onClick:e.onCloseClicked})]})]})},Oe=n(344),he=n(345),ge=n(346),xe=function(e){if(!e.config.reportKey)return console.debug("No report key in config found for ".concat(e.deviceInfo.zespInfo.IEEE," device and ").concat(e.config.id," control")),null;var t=e.config.reportKey.endpoint+e.config.reportKey.clusterId+e.config.reportKey.attributeId;return e.deviceInfo.zespInfo.Report[t]},ye=function(e,t){var n,c=null===(n=e.deviceInfo.customLayout)||void 0===n?void 0:n.find((function(e){return e.id===t}));return[c,c&&c.reportKey?e.deviceInfo.zespInfo.Report[c.reportKey.endpoint+c.reportKey.clusterId+c.reportKey.attributeId]:void 0]},Se=function(e,t,n,c){var r=c||t.config.reportKey;if(!r)return!1;var o=e.state.devices,a=null===o||void 0===o?void 0:o.find((function(e){return e.zespInfo.IEEE===t.deviceInfo.zespInfo.IEEE}));if(!a)return!1;var s=r.endpoint+r.clusterId+r.attributeId;return a.zespInfo.Report[s].val=n,e.setState((function(e){return Object(u.a)(Object(u.a)({},e),{devices:o})})),!0},Ne=function(e){var t=xe(e);return Object(m.jsxs)(Oe.a,{children:[Object(m.jsx)(qe,{children:"Light power:"}),Object(m.jsx)(Ke,{children:Object(m.jsxs)(he.a,{children:[Object(m.jsx)(ge.a,{variant:"1"===(null===t||void 0===t?void 0:t.val.toString())?"primary":"secondary",onClick:function(){R.ZespConnector.send({data:e.config.arguments.commandOn,isBinary:!0})},children:"ON"}),Object(m.jsx)(ge.a,{variant:"1"===(null===t||void 0===t?void 0:t.val.toString())?"secondary":"primary",onClick:function(){R.ZespConnector.send({data:e.config.arguments.commandOff,isBinary:!0})},children:"OFF"})]})})]})},we=n(161),Ie=n(51),_e=function(e){var t=S(),n=xe(e),c=(null===n||void 0===n?void 0:n.val)?Number(n.val):(e.config.arguments.max-e.config.arguments.min)/2+e.config.arguments.min,r=Object(s.useState)(c),o=Object(b.a)(r,2),a=o[0],i=o[1],l={min:e.config.arguments.min,max:e.config.arguments.max},d=function(t){return Math.max(Math.min(e.config.arguments.max,t),e.config.arguments.min)},j=function(n){return Se(t,e,n.toString())};return Object(m.jsxs)(Oe.a,{children:[Object(m.jsx)(qe,{children:"Level:"}),Object(m.jsxs)(Ke,{children:[Object(m.jsx)(we.a,Object(u.a)({style:{width:"80px"},className:"me-2",type:"number",value:a,onChange:function(t){return function(t){var n=d(t);i(n);var c=e.config.arguments.command.replace("{value}",n.toString(16));R.ZespConnector.send({data:c}),j(n)}(Number(t.target.value))}},l)),Object(m.jsx)(Ie.a,Object(u.a)({value:a,onChange:function(e){return i(Number(e.target.value))},onMouseUp:function(){var t=d(a),n=e.config.arguments.command.replace("{value}",t.toString(16));R.ZespConnector.send({data:n}),j(t)}},l))]})]})},Ce=n(89);function ke(e,t){var n=function(){if("undefined"===typeof window)return t;try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(c){return console.warn("Error reading localStorage key \u201c".concat(e,"\u201d:"),c),t}},c=Object(s.useState)(n),r=Object(b.a)(c,2),o=r[0],a=r[1];return Object(s.useEffect)((function(){a(n())}),[]),Object(s.useEffect)((function(){var e=function(){a(n())};return window.addEventListener("storage",e),window.addEventListener("local-storage",e),function(){window.removeEventListener("storage",e),window.removeEventListener("local-storage",e)}}),[]),[o,function(t){"undefined"==typeof window&&console.warn("Tried setting localStorage key \u201c".concat(e,"\u201d even though environment is not a client"));try{var n=t instanceof Function?t(o):t;window.localStorage.setItem(e,JSON.stringify(n)),a(n),window.dispatchEvent(new Event("local-storage"))}catch(c){console.warn("Error setting localStorage key \u201c".concat(e,"\u201d:"),c)}}]}var Ee=function(e){var t=S(),n=xe(e),c=(null===n||void 0===n?void 0:n.val)?null===n||void 0===n?void 0:n.val.split(":").map((function(e){return Number(e)})):[255,255,255];3!==c.length&&(console.warn("Incorrect RGB value stored to reportd: ".concat(null===n||void 0===n?void 0:n.val)),c=[255,255,255]);var r=Object(s.useState)({r:c[0],g:c[1],b:c[2]}),o=Object(b.a)(r,2),a=o[0],i=o[1],l=ke("colorPicker",1),d=Object(b.a)(l,2),u=d[0],j=d[1],p=function(n){return Se(t,e,"".concat(n.r,":").concat(n.g,":").concat(n.b))},f=function(t){i(t);var n=ze(t),c=Object(b.a)(n,2),r=c[0],o=c[1],a=e.config.arguments.command.replace("{x}",r.toString(16));a=a.replace("{y}",o.toString(16)),R.ZespConnector.send({data:a}),p(t)},v=function(e){return Object(m.jsx)("button",{className:"btn btn-outline-secondary me-1 btn-xs ".concat(u==e?"active":""),type:"button",onClick:function(){return j(e)},children:e})};return Object(m.jsxs)(Oe.a,{children:[Object(m.jsx)(qe,{className:"user-select-none",children:Object(m.jsxs)("div",{children:[Object(m.jsx)("div",{children:"Light color:"}),Object(m.jsxs)("div",{children:[v(1),v(2),v(3)]})]})}),Object(m.jsx)(Ke,{children:Object(m.jsxs)("div",{className:"flex-grow-1",children:[1===u&&Object(m.jsx)(Ce.c,{color:a,onChange:function(e){return i(e.rgb)},onChangeComplete:function(){var t=ze(a),n=Object(b.a)(t,2),c=n[0],r=n[1],o=e.config.arguments.command.replace("{x}",c.toString(16));o=o.replace("{y}",r.toString(16)),R.ZespConnector.send({data:o}),p(a)}}),2===u&&Object(m.jsx)(Ce.b,{color:a,onChange:function(e){return f(e.rgb)},triangle:"hide",width:"214px"}),3===u&&Object(m.jsx)(Ce.a,{color:a,onChange:function(e){return f(e.rgb)}})]})})]})},ze=function(e){var t=e.b>.04045?Math.pow((e.b+.055)/1.055,2.4):e.b/12.92,n=e.g>.04045?Math.pow((e.g+.055)/1.055,2.4):e.g/12.92,c=e.r>.04045?Math.pow((e.r+.055)/1.055,2.4):e.r/12.92,r=.664511*t+.154324*n+.162028*c,o=.283881*t+.668433*n+.047685*c,a=88e-6*t+.07231*n+.986039*c,s=r/(r+o+a),i=o/(r+o+a);return isNaN(s)&&(s=0),isNaN(i)&&(i=0),[Number((65279*s).toFixed(0)),Number((65279*i).toFixed(0))]},Te=function(e){var t=JSON.stringify(e.config),n=JSON.stringify(xe(e));return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{children:["Unknown control: ",e.config.id]}),Object(m.jsxs)("div",{className:"alert alert-info",children:[Object(m.jsx)("div",{children:t}),n&&Object(m.jsx)("div",{className:"mt-2",children:n})]})]})},Fe=function(e){var t=Object(s.useState)(),n=Object(b.a)(t,2),c=n[0],r=n[1];return!0===e.onRefresh&&Object(s.useEffect)((function(){return r(e.classNameFrom)}),[e.children]),!1===e.onLoad&&Object(s.useEffect)((function(){return r(e.classNameTo)}),[]),setTimeout((function(){return r(e.classNameTo)}),e.timeOutMs||100),Object(m.jsx)("span",{className:c,children:e.children})},Le=function(e){return Object(m.jsx)(Fe,{classNameFrom:"highlight-value just-added",classNameTo:"highlight-value",onRefresh:!0,onLoad:!1,children:e.children})},Re=function(e){var t=xe(e),n=(null===t||void 0===t?void 0:t.val)?parseInt(t.val,16).toString():null;return Object(m.jsxs)(Oe.a,{children:[Object(m.jsx)(qe,{children:"Illuminance:"}),Object(m.jsxs)(Ke,{children:[n&&Object(m.jsx)(Le,{children:n}),!n&&Object(m.jsx)("span",{className:"alert alert-warning small py-2 m-0",children:"No data"})]})]})},Pe=function(e){var t=S(),n={min:e.config.arguments.min,max:e.config.arguments.max},c=xe(e),r=(null===c||void 0===c?void 0:c.val)?Number(c.val):(n.max-n.min)/2+n.min,o=Object(s.useState)(r),a=Object(b.a)(o,2),i=a[0],l=a[1],d=function(t){return Math.max(Math.min(e.config.arguments.max,t),e.config.arguments.min)},j=function(n){return Se(t,e,n.toString())};return Object(m.jsxs)(Oe.a,{children:[Object(m.jsxs)(qe,{children:[e.config.label||"Level",":"]}),Object(m.jsxs)(Ke,{children:[Object(m.jsx)(we.a,Object(u.a)({style:{width:"100px"},className:"me-2 text-center",type:"number",value:i,onChange:function(t){return function(t){var n=d(t);l(n);var c=Be(e.config.arguments.command,n);R.ZespConnector.send({data:c}),j(n)}(Number(t.target.value))}},n)),Object(m.jsx)(Ie.a,Object(u.a)({value:i,onChange:function(e){return l(Number(e.target.value))},onMouseUp:function(){var t=d(i),n=Be(e.config.arguments.command,t);R.ZespConnector.send({data:n}),j(t)}},n))]})]})},Be=function(e,t){return e.replace("{value}",t.toString(16)).replace("{value:dec}",t.toString())},Ze=function(e){var t=xe(e),n=ye(e,"player_control_root"),c=Object(b.a)(n,2),r=c[0],o=c[1];if(!t)return Object(s.useEffect)((function(){U.b.error("'".concat(e.config.id,"' layout settings not found"))}),[]),Object(m.jsx)(m.Fragment,{});if(!o)return Object(s.useEffect)((function(){U.b.error("'player_control_root' layout settings not found")}),[]),Object(m.jsx)(m.Fragment,{});var a=Object(s.useState)(t.val||""),i=Object(b.a)(a,2),l=i[0],d=i[1],u=Object(s.useState)(o.val||"OFF"),j=Object(b.a)(u,2),p=j[0],f=j[1],v=S();return Object(m.jsxs)(Oe.a,{children:[Object(m.jsx)(qe,{children:"Radio stream:"}),Object(m.jsx)(Ke,{children:Object(m.jsxs)("div",{className:"input-group",children:[Object(m.jsx)("input",{className:"form-control",list:"datalistOptions",placeholder:"Click to see dropdown suggestions",value:l,onChange:function(t){var n=t.target.value;d(n),Se(v,e,n)}}),Object(m.jsx)("button",{className:"btn btn-outline-secondary ".concat("ON"!==p?"active":""),type:"button",onClick:function(){console.log("stop"),f("OFF"),Se(v,e,"OFF",r.reportKey),d(""),Se(v,e,""),r?R.ZespConnector.send({data:r.arguments.commandOff}):console.warn("No configured OFF command for 'player_control_root' operation found in layout")},children:Object(m.jsx)("i",{className:"bi-stop"})}),Object(m.jsx)("button",{className:"btn btn-outline-secondary rounded-end ".concat("ON"===p?"active":""),type:"button",onClick:function(){l&&0!==l.length?(f("ON"),Se(v,e,"ON",r.reportKey),r?R.ZespConnector.send({data:r.arguments.commandOn.replace("{value}",l)}):console.warn("No configured ON command for 'player_control_root' operation found in layout")):U.b.error("Please select source first",{icon:"\ud83c\udfb5"})},children:Object(m.jsx)("i",{className:"bi-play"})}),Object(m.jsx)("datalist",{id:"datalistOptions",children:["http://chanson.hostingradio.ru:8041/chanson128.mp3","http://dorognoe.hostingradio.ru:8000/radio?type=.mp3","http://stream3.radiostyle.ru:8001/biker-fm","http://air.radiorecord.ru:8102/sd90_320","http://stream.hitroe.com/stream","http://air.radiorecord.ru:8102/tm_320","http://eu.radioboss.fm:8024/stream"].map((function(e,t){return Object(m.jsx)("option",{value:e},t)}))})]})})]})},Me=function(e){var t,n,c,r=xe(e);if(!r)return Object(m.jsx)("div",{className:"alert alert-warning",children:"Report missed"});var o=Number((null===(t=e.config.zespRoleSettings.payload_on)||void 0===t?void 0:t.toString())||"0"),a=Number((null===(n=r.parsed)||void 0===n?void 0:n.toString())||(null===(c=r.val)||void 0===c?void 0:c.toString())||"1")===o;return Object(m.jsxs)(Oe.a,{children:[Object(m.jsxs)(qe,{children:[r.label||"State",":"]}),Object(m.jsx)(Ke,{children:Object(m.jsx)(Le,{children:a?"ON":"OFF"})})]})},Ae=function(e){var t=xe(e);if(!t)return Object(m.jsx)("div",{className:"alert alert-warning",children:"Report missed"});var n=t.parsed||t.val,c=e.config.zespRoleSettings.unit_of_measurement||"";return Object(m.jsxs)(Oe.a,{children:[Object(m.jsxs)(qe,{children:[t.label||"Value",":"]}),Object(m.jsx)(Ke,{children:Object(m.jsx)(Le,{children:n?"".concat(n," ").concat(c):"No data"})})]})},Ve=n(166),De=function(e,t){var n={config:e,deviceInfo:t};switch(e.id){case"on_off_root":return Object(m.jsx)(Ne,Object(u.a)(Object(u.a)({},n),{},{config:n.config}));case"level_root":return Object(m.jsx)(_e,Object(u.a)(Object(u.a)({},n),{},{config:n.config}));case"rgb_root":return Object(m.jsx)(Ee,Object(u.a)(Object(u.a)({},n),{},{config:n.config}));case"player_src_root":return Object(m.jsx)(Ze,Object(u.a)(Object(u.a)({},n),{},{config:n.config}));case"player_control_root":return Object(m.jsx)(m.Fragment,{});case"level_control":return Object(m.jsx)(Pe,Object(u.a)(Object(u.a)({},n),{},{config:n.config}));case"illuminance_sensor":return Object(m.jsx)(Re,Object(u.a)(Object(u.a)({},n),{},{config:n.config}));case"binary_sensor":return Object(m.jsx)(Me,Object(u.a)(Object(u.a)({},n),{},{config:n.config}));case"sensor":return Object(m.jsx)(Ae,Object(u.a)(Object(u.a)({},n),{},{config:n.config}));default:return Object(m.jsx)(Te,Object(u.a)({},n))}},qe=function(e){return Object(m.jsx)(Ve.a,{md:"4",children:e.children})},Ke=function(e){return Object(m.jsx)(Ve.a,{children:e.children})},Je=function(e){var t=e.groups.find((function(t){return t.name===e.activeGroupName}));return t?Object(m.jsx)(me.a.Body,{className:"text-start device-dialog p-4",children:t.settings.map((function(t,n){return Object(m.jsx)("div",{className:"device-control-group",children:De(t,e.device)},n)}))}):Object(m.jsxs)("div",{children:["Group '",e.activeGroupName,"' not found."]})},Ge=function(){var e=Object(p.g)();return Object(s.useEffect)((function(){e.push("/devices"),U.b.error("Device information not found")}),[]),Object(m.jsx)(m.Fragment,{})},Ue=function(){var e=Object(p.h)(),t=e.ieee,n=e.device,c=Object(s.useState)(!0),r=Object(b.a)(c,2),o=r[0],a=r[1],i=Object(p.g)(),l=S(),d=X(l,t,n);if(!d)return Object(m.jsx)(Ge,{});var u=ee(d),j=Object(s.useState)(u[0].name),f=Object(b.a)(j,2),v=f[0],O=f[1],h=function(){return a(!1)};return Object(m.jsxs)(me.a,{show:o,onHide:h,onExited:function(){return setTimeout((function(){return i.push("/devices")}),100)},children:[Object(m.jsx)(ve,{groups:u,device:d,activeGroupName:v,setActiveGroupName:O,onCloseClicked:h,onDetailsClicked:function(){console.log(d),U.b.success("Check console for logs",{icon:"\ud83d\udc7d"})}}),Object(m.jsx)(Je,{groups:u,device:d,activeGroupName:v})]})},We=n(5),He=n(350),Qe=n(53),Ye={handleSubmit:function(e,t){e.preventDefault();var n,c={},r=Object(Qe.a)(h()(e.target).find("input"));try{for(r.s();!(n=r.n()).done;){var o=n.value,a=h()(o).prop("id");if(null==a)return;"checkbox"===h()(o).prop("type")?!0===h()(o).prop("checked")?c[a]=h()(o).attr("checked_value")||"true":c[a]=h()(o).attr("unchecked_value")||"false":c[a]=h()(o).val()}}catch(s){r.e(s)}finally{r.f()}t(c)}},$e=["onSubmit"],Xe=function(e){var t=e.onSubmit,n=Object(We.a)(e,$e);return Object(m.jsx)(He.a,Object(u.a)(Object(u.a)({onSubmit:function(e){return Ye.handleSubmit(e,t)}},n),{},{children:e.children}))},et=["getDeviceList","get_Mi_lamp","LoadJson|/location.json","LoadJson|/groups.json"],tt=["01 0000 01 0100","01 0000 01 0000"],nt=function(){var e=Object(s.useState)([]),t=Object(b.a)(e,2),n=t[0],c=t[1],r=Object(s.useState)(""),o=Object(b.a)(r,2),a=o[0],i=o[1],l=Object(s.useState)(!1),d=Object(b.a)(l,2),u=d[0],j=d[1],p=Object(s.useRef)(n),f=Object(s.useRef)(u),v=function(e){if(!f.current){var t=[e.substr(0,250)].concat(Object($.a)(p.current)),n=t.length-15;n>0&&t.splice(t.length-n,n),p.current=t,c(t)}},O=function(e){var t=e.target.innerText;i(t)},h=function(e){var t=e||a;R.ZespConnector.send({data:t,isBinary:!0})};return Object(s.useEffect)((function(){var e=R.ZespConnector.subscribe(ue,(function(e){var t=e.response;v(t)}));return function(){return R.ZespConnector.unsubscribe(e)}}),[]),Object(m.jsxs)(W,{children:[Object(m.jsx)(Xe,{onSubmit:function(e){e.messageToSend&&(v(">".concat(e.messageToSend)),R.ZespConnector.send({data:e.messageToSend}))},children:Object(m.jsxs)(H.a,{children:[Object(m.jsx)(H.a.Header,{children:"WebSocket tester (FOR DEVELOPMENT ONLY)"}),Object(m.jsxs)(H.a.Body,{children:[Object(m.jsxs)("div",{className:"row mb-2",children:[Object(m.jsx)("label",{className:"col-md-3 col-lg-2",children:"Message to send"}),Object(m.jsx)("div",{className:"col",children:Object(m.jsx)("input",{type:"text",className:"form-control",id:"messageToSend",value:a,onChange:function(e){return i(e.target.value)}})})]}),Object(m.jsxs)("div",{className:"row",children:[Object(m.jsx)("div",{className:"col-md-3 col-lg-2"}),Object(m.jsxs)("div",{className:"col",children:[Object(m.jsx)("div",{children:et.map((function(e,t){return Object(m.jsx)("button",{type:"submit",className:"btn btn-sm btn-outline-primary me-1",onClick:O,children:e},t)}))}),Object(m.jsx)("div",{className:"mt-1",children:tt.map((function(e,t){return Object(m.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-secondary me-1",onClick:function(){i(e),h(e)},children:e},t)}))})]})]})]}),Object(m.jsxs)(H.a.Footer,{children:[Object(m.jsx)(ge.a,{variant:"primary",type:"submit",children:"Send message"}),Object(m.jsx)(ge.a,{variant:"secondary",type:"button",onClick:function(){return h()},className:"ms-2",children:"Send binary"})]})]})}),Object(m.jsxs)(H.a,{className:"mt-4",children:[Object(m.jsxs)(H.a.Header,{children:[Object(m.jsxs)("span",{children:["Communication log ",Object(m.jsx)("span",{className:"badge bg-secondary small",children:n.length})]}),Object(m.jsx)("button",{className:"btn btn-outline-secondary ms-3 btn-sm",onClick:function(){p.current=[],c([])},children:"Clear log"}),Object(m.jsx)("button",{className:"btn btn-outline-secondary ms-3 btn-sm",onClick:function(){return function(){var e=!f.current;f.current=e,j(e)}()},children:u?"Start logs":"Pause logs"})]}),Object(m.jsx)(H.a.Body,{children:n.map((function(e,t){return e.startsWith(">")?Object(m.jsx)("div",{className:"px-2 mb-3 py-1 m-1 bg-success bg-opacity-25 rounded",children:e.substr(1)},t):Object(m.jsx)("div",{className:"border-start mb-3 border-3 border-warning p-0 d-flex flex-wrap",children:e.split("|").map((function(e,t){return Object(m.jsx)("span",{className:"bg-warning bg-opacity-25 m-1 px-2 rounded",children:e},t)}))},t)}))})]})]})},ct=function(e){var t=e.controlId,n=e.label,c=e.placeholder,r=e.defaultValue,o=e.type,a={placeholder:c,type:void 0===o?"text":o};return r&&(a=Object(u.a)(Object(u.a)({},a),{defaultValue:r.toString()})),Object(m.jsxs)(He.a.Group,{as:Oe.a,className:"mb-3",controlId:t,children:[Object(m.jsx)(He.a.Label,{column:!0,md:"3",lg:"2",children:n}),Object(m.jsx)(Ve.a,{children:Object(m.jsx)(He.a.Control,Object(u.a)({},a))})]})},rt=function(e){var t=e.controlId,n=e.label,c=e.defaultChecked,r=e.checkedValue,o=void 0===r?"true":r,a=e.uncheckedValue,s="true"===c||"1"===c||1===c||!0===c||!1,i={checked_value:o,unchecked_value:void 0===a?"false":a};return c&&(i=Object(u.a)(Object(u.a)({},i),{defaultChecked:s})),Object(m.jsx)(He.a.Group,{controlId:t,className:"d-inline-block",children:Object(m.jsxs)(He.a.Label,{className:"d-flex",children:[Object(m.jsx)(He.a.Check,Object(u.a)({className:"pe-2"},i)),Object(m.jsx)("span",{children:n})]})})},ot=function(){var e,t,n=S(),c=Object(f.a)(["pages.setup-mqtt","common"]).t,r=null===(e=n.state.zespSettings)||void 0===e?void 0:e.MQTT;if(!r)return Object(m.jsx)(s.Fragment,{});return Object(m.jsx)(W,{children:Object(m.jsx)(H.a,{children:Object(m.jsxs)(Xe,{onSubmit:function(e){return pe({MQTT:e},n,c)},children:[Object(m.jsxs)(H.a.Body,{children:[Object(m.jsx)(ct,{controlId:"mqttup",defaultValue:r.mqttup,label:c("topic.label"),placeholder:c("topic.placeholder")}),Object(m.jsx)(ct,{controlId:"mqtt",defaultValue:r.mqtt,label:c("server.label"),placeholder:c("server.placeholder")}),Object(m.jsx)(ct,{controlId:"mqttPort",defaultValue:null===(t=r.mqttPort)||void 0===t?void 0:t.toString(),label:c("port.label"),placeholder:c("port.placeholder")}),Object(m.jsx)(ct,{controlId:"mqttLogin",defaultValue:r.mqttLogin,label:c("login.label"),placeholder:c("login.placeholder")}),Object(m.jsx)(ct,{type:"password",controlId:"mqttPassw",defaultValue:r.mqttPassw,label:c("password.label"),placeholder:c("password.placeholder")}),Object(m.jsxs)(Oe.a,{children:[Object(m.jsx)(Ve.a,{md:"3",lg:"2"}),Object(m.jsxs)(Ve.a,{className:"space-between-4",children:[Object(m.jsx)(rt,{controlId:"mqttEnable",defaultChecked:r.mqttEnable,label:c("is_enabled.label"),checkedValue:1,uncheckedValue:0}),Object(m.jsx)(rt,{controlId:"Home_Assistant",defaultChecked:r.Home_Assistant,label:c("is_ha_enabled.label"),checkedValue:1,uncheckedValue:0})]})]})]}),Object(m.jsx)(H.a.Footer,{children:Object(m.jsx)(ge.a,{variant:"primary",type:"submit",children:c("common:save_button")})})]})})})},at=function(){return Object(m.jsx)(W,{children:Object(m.jsx)("div",{className:"px-4 py-5 bg-light rounded-3",children:Object(m.jsxs)("div",{className:"container-fluid",children:[Object(m.jsx)("h1",{className:"display-5 fw-bold",children:"Not implemented yet!"}),Object(m.jsxs)("p",{className:"col-md-8 fs-4",children:["Hello, my dear friend! Just imagine how awesome this feature can be and share it with developers ~_~ ",Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),"Or you can even implement it yourself, everything you need is just to jump to source codes, made some magic, test it and that's it!"]}),Object(m.jsx)("hr",{className:"my-4"}),Object(m.jsxs)("p",{children:["This feature is under contruction. You can find latest verion on ",Object(m.jsx)("a",{href:"#",children:"github project page"})," or just click this big blue button bellow."]}),Object(m.jsx)("a",{href:"#",target:"_blank",rel:"noreferrer",className:"btn btn-primary btn-lg",type:"button",children:"Learn more"})]})})})},st=function(){var e,t=S(),n=Object(f.a)(["pages.setup-wifi","common"]).t,c=null===(e=t.state.zespSettings)||void 0===e?void 0:e.Wifi;if(!c)return Object(m.jsx)(s.Fragment,{});return Object(m.jsx)(s.Fragment,{children:Object(m.jsx)(W,{children:Object(m.jsx)(Xe,{onSubmit:function(e){return pe({Wifi:e},t,n)},children:Object(m.jsxs)(H.a,{children:[Object(m.jsxs)(H.a.Body,{children:[Object(m.jsx)(ct,{controlId:"ssid",defaultValue:null===c||void 0===c?void 0:c.ssid,label:n("ssid.label"),placeholder:n("ssid.placeholder")}),Object(m.jsx)(ct,{type:"password",controlId:"pass",defaultValue:null===c||void 0===c?void 0:c.pass,label:n("pass.label"),placeholder:n("pass.placeholder")}),Object(m.jsx)(ct,{controlId:"ip",defaultValue:null===c||void 0===c?void 0:c.ip,label:n("ip.label"),placeholder:n("ip.placeholder")}),Object(m.jsx)(ct,{controlId:"mask",defaultValue:null===c||void 0===c?void 0:c.mask,label:n("mask.label"),placeholder:n("mask.placeholder")}),Object(m.jsx)(ct,{controlId:"gw",defaultValue:null===c||void 0===c?void 0:c.gw,label:n("gw.label"),placeholder:n("gw.placeholder")})]}),Object(m.jsx)(H.a.Footer,{children:Object(m.jsx)(ge.a,{variant:"primary",type:"submit",children:n("common:save_button")})})]})})})})},it=function(){return Object(m.jsxs)(s.Fragment,{children:[Object(m.jsx)(p.b,{exact:!0,path:"/",children:Object(m.jsx)(p.a,{to:"/devices"})}),Object(m.jsx)(p.b,{path:"/devices",component:ae}),Object(m.jsx)(p.b,{path:"/devices/:ieee-:device",component:Ue}),Object(m.jsx)(p.b,{path:"/setup",component:fe}),Object(m.jsx)(p.b,{exact:!0,path:"/setup",component:st}),Object(m.jsx)(p.b,{path:"/setup/mqtt",component:ot}),Object(m.jsx)(p.b,{path:"/setup/zigbee",component:at}),Object(m.jsx)(p.b,{path:"/setup/telegram",component:at}),Object(m.jsx)(p.b,{path:"/setup/z2m",component:at}),Object(m.jsx)(p.b,{path:"/setup/zesp-ui",component:at}),Object(m.jsx)(p.b,{path:"/socket-test",component:nt})]})},lt=(n(113),function(e){var t=Object(f.a)("pages.welcome").t,n=e.servers.map((function(e,t){return{server:e,index:t}})).sort((function(e,t){return e.server.name>t.server.name?1:-1}));return Object(m.jsx)("div",{className:"container welcome-page h-100",children:Object(m.jsx)(W,{children:Object(m.jsxs)(H.a,{className:"text-start",children:[Object(m.jsx)(H.a.Header,{children:t("list.title")}),Object(m.jsxs)(H.a.Body,{children:[0==e.servers.length&&Object(m.jsx)("div",{children:t("list.add_message")}),e.servers.length>0&&Object(m.jsx)("nav",{className:"servers-list",children:n.map((function(t,n){return Object(m.jsxs)("div",{className:"item",children:[Object(m.jsxs)(j.b,{className:"server-button",to:"/",onClick:function(n){e.openServerAction(t.index),n.preventDefault()},activeClassName:"none",children:[Object(m.jsx)("i",{className:"bi bi-caret-right-fill"})," ",t.server.name]}),Object(m.jsx)("button",{type:"button",onClick:function(){return e.openEditAction(t.server)},className:"edit-button",children:Object(m.jsx)("i",{className:"bi bi-pencil-fill"})})]},"item-".concat(n))}))})]}),Object(m.jsx)(H.a.Footer,{className:"text-right",children:Object(m.jsx)("button",{type:"button",onClick:e.openAddServer,className:"btn btn-primary",children:t("list.add_button")})})]})})})}),dt=n(169),ut=n(353),bt=n(347),jt=function(e){var t,n,c=Object(f.a)("pages.welcome").t,r=Object(s.useState)(!1),o=Object(b.a)(r,2),a=o[0],i=o[1],l=Object(m.jsxs)(dt.a,{id:"popover-basic",children:[Object(m.jsx)(dt.a.Header,{as:"h3",children:c("edit.delete_title")}),Object(m.jsx)(dt.a.Body,{children:Object(m.jsx)("span",{dangerouslySetInnerHTML:{__html:c("edit.delete_message")}})})]});return Object(m.jsx)("div",{className:"container welcome-page h-100",children:Object(m.jsx)(W,{children:Object(m.jsx)(Xe,{onSubmit:function(t){return e.editServer?e.updateAction(t):e.addAction(t),Promise.resolve()},children:Object(m.jsxs)(H.a,{className:"text-start",children:[Object(m.jsxs)(H.a.Header,{className:"d-flex justify-content-between",children:[Object(m.jsx)("span",{className:"modal-title",children:c("edit.title")}),Object(m.jsx)("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:e.closeAction})]}),Object(m.jsxs)(H.a.Body,{children:[Object(m.jsx)(we.a,{className:"mb-2",id:"name",defaultValue:null===(t=e.editServer)||void 0===t?void 0:t.name,placeholder:c("edit.name_input_placeholder")}),Object(m.jsxs)(ut.a,{children:[Object(m.jsxs)(ut.a.Text,{id:"basic-addon3",children:["https:"===document.location.protocol?"wss":"ws","://"]}),Object(m.jsx)(we.a,{id:"address",defaultValue:null===(n=e.editServer)||void 0===n?void 0:n.address,"aria-describedby":"basic-addon3",placeholder:c("edit.address_input_placeholder")})]})]}),e.editServer&&Object(m.jsxs)(H.a.Footer,{className:"d-flex justify-content-between",children:[Object(m.jsx)("div",{children:Object(m.jsx)(bt.a,{trigger:"click",placement:"top",overlay:l,rootClose:!0,onToggle:i,children:Object(m.jsx)("button",{onClick:function(){a&&e.deleteAction()},type:"button",className:"btn btn-outline-danger",children:c("edit.delete_button")})})}),Object(m.jsx)("button",{type:"submit",className:"btn btn-primary",children:c("edit.save_button")})]}),!e.editServer&&Object(m.jsx)(H.a.Footer,{className:"text-right",children:Object(m.jsx)("button",{type:"submit",className:"btn btn-primary",children:c("edit.add_button")})})]})})})})},pt=function(){var e=S(),t=Object(s.useState)("welcome"),n=Object(b.a)(t,2),c=n[0],r=n[1],o=Object(s.useState)(),a=Object(b.a)(o,2),i=a[0],l=a[1],d=ke("servers",[]),j=Object(b.a)(d,2),p=j[0],f=j[1],v=function(){l(void 0),r("welcome")};return"edit"===c?Object(m.jsx)(jt,{editServer:i,addAction:function(e){p.push(e),f(p),v()},updateAction:function(e){var t=p.indexOf(i);p[t]=e,f(p),console.log(p),v()},closeAction:v,deleteAction:function(){f(p.filter((function(e){return e!==i}))),v()}}):Object(m.jsx)(lt,{servers:p,openAddServer:function(){l(void 0),r("edit")},openEditAction:function(e){l(e),r("edit")},openServerAction:function(t){e.setState((function(e){return Object(u.a)(Object(u.a)({},e),{selectedServerIndex:t})}))}})},ft=n(167),mt={getDevicesList:function(e){return e.request({data:"getDeviceList",responseValidator:de("alldev"),onSuccess:function(t){return vt(t,e.getGlobalState())}})}},vt=function(e,t){var c=e.dataParts[0],r=[];Object.assign(r,JSON.parse(c));var o=r.map((function(e){var t=ft.find((function(t){return t.modelIds.findIndex((function(t){return t===e.ModelId}))>=0})),c=(null===t||void 0===t?void 0:t.layout)&&n(335)("./".concat(t.layout));return c&&c.forEach((function(t){if(t.reportKey){var n=t.reportKey.endpoint+t.reportKey.clusterId+t.reportKey.attributeId;e.Report[n]={}}})),{zespInfo:e,settings:t,customLayout:c}}));t.setState((function(e){return Object(u.a)(Object(u.a)({},e),{devices:o})}))},Ot=mt,ht=function(e,t){e.subscribe(de("rep"),(function(e){return gt(e,t)}))},gt=function(e,t){if(e.dataParts.length<2)return console.warn("Unknown format of updated received"),void console.warn(e.response);var n=t(),c=n.state.devices,r=e.dataParts[1],o=null===c||void 0===c?void 0:c.find((function(e){return e.zespInfo.IEEE===r}));if(o){var a,s=JSON.parse(e.dataParts[0]),i=s.EndPoint+s.ClusterId+s.AttribId,l=o.zespInfo.Report[i];if(l)l.val!==s.Data&&l.parsed!==s.parsed&&(l.parsed=s.parsed,l.val=s.Data,n.setState((function(e){return Object(u.a)(Object(u.a)({},e),{devices:c})})));else console.debug("Report '".concat(i,"' not found for '").concat(o.zespInfo.IEEE,"' device (").concat(null!==(a=o.zespInfo.Name)&&void 0!==a?a:o.zespInfo.ModelId,")"))}else console.debug("Update received for unknown device: ".concat(r))},xt=function(e){return e.request({data:"get_Mi_lamp",responseValidator:de("Mi_lamp"),onSuccess:function(t){return yt(t,e.getGlobalState())}})},yt=function(e,t){var n,c,r,o,a,s,i,l=t.state.devices;if(l){var d=JSON.parse(e.dataParts[0]),b=l.find((function(e){return"ZESP_Root"===e.zespInfo.ModelId}));if(b){var j=b.customLayout;if(j){var p=null===(n=j.find((function(e){return"on_off_root"===e.id})))||void 0===n?void 0:n.reportKey;p?b.zespInfo.Report[p.endpoint+p.clusterId+p.attributeId].val=d.on.toString():console.warn("Root device report 'on_off_root' not found");var f=null===(c=j.find((function(e){return"level_root"===e.id})))||void 0===c?void 0:c.reportKey;f?b.zespInfo.Report[f.endpoint+f.clusterId+f.attributeId].val=d.level.toString():console.warn("Root device report 'level_root' not found");var m=null===(r=j.find((function(e){return"rgb_root"===e.id})))||void 0===r?void 0:r.reportKey;m?b.zespInfo.Report[m.endpoint+m.clusterId+m.attributeId].val="".concat(d.B,":").concat(d.G,":").concat(d.R):console.warn("Root device report 'rgb_root' not found");var v=null===(o=j.find((function(e){return"level_control"===e.id})))||void 0===o?void 0:o.reportKey;v?b.zespInfo.Report[v.endpoint+v.clusterId+v.attributeId].val=d.sound.volume.toString():console.warn("Root device report 'level_control' not found");var O=null===(a=j.find((function(e){return"player_src_root"===e.id})))||void 0===a?void 0:a.reportKey;O?b.zespInfo.Report[O.endpoint+O.clusterId+O.attributeId].val=null===(s=d.sound.current_path)||void 0===s?void 0:s.toString():console.warn("Root device report 'player_src_root' not found");var h=null===(i=j.find((function(e){return"player_control_root"===e.id})))||void 0===i?void 0:i.reportKey;h?b.zespInfo.Report[h.endpoint+h.clusterId+h.attributeId].val=d.sound.play.toString():console.warn("Root device report 'player_control_root' not found"),t.setState((function(e){return Object(u.a)(Object(u.a)({},e),{devices:l})}))}else console.warn("Update received, but no root layout found")}else console.debug("Update received, but no root devices found")}else console.debug("Update received, but no any devices found")},St=!1,Nt=function(e){return new Promise((function(t,n){if(St)return console.warn("zesp service already initialized"),void t();St=!0,console.debug("Load initial data from zesp..."),R.ZespConnectorPromise.then(Ot.getDevicesList).then(xt).then((function(t){return ht(t,e)})).then((function(){return t()})).catch((function(e){console.error("Cannot complete zesp service initialization: ".concat(e)),n(e)}))}))},wt=function(){var e=S(),t=ke("servers",[]),n=Object(b.a)(t,1)[0],c=null===e.state.selectedServerIndex||n.length<=e.state.selectedServerIndex?null:n[e.state.selectedServerIndex];return c?Object(m.jsx)(It,{server:c}):Object(m.jsx)(pt,{})},It=function(e){var t=S(),n=Object(s.useRef)(t);return Object(s.useEffect)((function(){n.current=t}),[t]),Object(s.useEffect)((function(){R.Spinner.init(t),R.Spinner.show(),R.ZespConnectorPromise.then((function(t){return t.connectAsync((function(){return n.current}),e.server)})).then((function(){return Nt((function(){return n.current}))})).then((function(){t.setState((function(e){return Object(u.a)(Object(u.a)({},e),{appInitialized:!0})})),R.Spinner.hide()})).catch((function(n){t.setState((function(e){return Object(u.a)(Object(u.a)({},e),{appInitialized:!1,selectedServerIndex:null})})),R.ZespConnector.disconnect(),R.Spinner.hide(),U.b.error("Ooops, cannot connect to the server (".concat(e.server.address,"). ").concat(n))}))}),[]),t.state.appInitialized?Object(m.jsxs)("div",{className:"container-md d-flex w-100 h-100 p-3 mx-auto flex-column",children:[Object(m.jsxs)("header",{className:"masthead",children:[Object(m.jsx)("a",{href:"/",children:Object(m.jsx)("h3",{className:"masthead-brand",children:"ZESP:UI"})}),Object(m.jsx)(v,{})]}),Object(m.jsx)("main",{role:"main",className:"text-start d-flex flex-grow-1 flex-column",children:Object(m.jsx)(it,{})}),Object(m.jsx)("footer",{className:"mastfoot mt-3",children:Object(m.jsxs)("p",{children:["ZESP UI application, by ",Object(m.jsx)("a",{href:"https://t.me/NickRimmer",target:"_blank",rel:"noreferrer",children:"@NickRimmer"}),". (0.0.0 version, ",Object(m.jsx)("span",{children:"dev build"}),")"]})})]}):Object(m.jsx)(s.Fragment,{})},_t=function(){return Object(m.jsx)(j.a,{children:Object(m.jsx)(p.d,{children:Object(m.jsxs)(y,{children:[Object(m.jsx)(wt,{}),Object(m.jsx)(N,{}),Object(m.jsx)(U.a,{})]})})})},Ct=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,354)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,o=t.getLCP,a=t.getTTFB;n(e),c(e),r(e),o(e),a(e)}))};d.a.render(Object(m.jsx)(i.a.StrictMode,{children:Object(m.jsx)(_t,{})}),document.getElementById("root")),Ct()},79:function(e){e.exports=JSON.parse('[{"clusterId":"0000","name":"Basic"},{"clusterId":"0006","name":"On_Off","attributes":{"0000":{"id":"on_off_control","commandOn":"cmd_on|...","commandOff":"cmd_off|..."}}},{"clusterId":"0008","name":"Level_Control"},{"clusterId":"0106","name":"Illuminance"},{"clusterId":"0300","name":"Color_Control"},{"clusterId":"0406","name":"Occupancy_Sensing"},{"clusterId":"BBBB","name":"Custom"}]')},94:function(e,t,n){"use strict";n.r(t);var c=n(90),r=n(56),o=["en"],a=["common","nav","pages.setup-mqtt","pages.setup-wifi","pages.welcome","pages.devices"];c.a.use(r.e).init({fallbackLng:o[0],lng:o[0],resources:function(){for(var e={},t=0,c=o;t<c.length;t++){var r=c[t];e[r]={};for(var s=0,i=a;s<i.length;s++){var l=i[s],d="./locales/".concat(r,"/").concat(l.replace(".","/"),".json");try{e[r][l]=n(198)(""+d),console.debug("".concat(d," (ok)"))}catch(u){console.debug("".concat(d," (error)"))}}}return e}(),ns:a,defaultNS:"common"}),c.a.languages=o,t.default=c.a}},[[336,1,2]]]);
//# sourceMappingURL=main.9043cc3b.chunk.js.map