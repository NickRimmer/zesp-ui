{"version":3,"sources":["loader.js","i18n sync /^.*$","data/layouts sync /^/.//.*$","services/zesp/enums/CloseEventCodes.tsx","services/zesp/common/ZespConnector.tsx","shared/top-menu/index.tsx","shared/global-state-provider/state-logic.tsx","global-state.tsx","shared/loading-spinner/index.tsx","services/zesp/common/Constants.tsx","services/zesp/common/ZespDataEvent.tsx","shared/loading-spinner/service.tsx","services/single.tsx","services/zesp/common/ZespResponseValidators.tsx","services/zesp/service-devices.tsx","services/zesp/service-general.tsx","services/zesp/index.tsx","services/zesp/service-settings.tsx","shared/cover/index.tsx","shared/fadein-transition/index.tsx","pages/main/index.tsx","pages/devices/item-image.tsx","pages/devices/item.tsx","pages/devices/index.tsx","pages/setup/index.tsx","pages/device-info/DeviceDialog.tsx","pages/device-info/NotFoundView.tsx","device-controls/OnOffControl.tsx","device-controls/UnknownControl.tsx","device-controls/OnOffRoot.tsx","device-controls/LevelRoot.tsx","services/localStorage.tsx","device-controls/RgbRoot.tsx","device-controls/IlluminanceSensor.tsx","device-controls/index.tsx","pages/device-info/index.tsx","shared/form/react-form/logic.tsx","shared/form/react-form/index.tsx","pages/socket-test/index.tsx","shared/form/input-group-horizontal.tsx","shared/form/checkbox-group-inline.tsx","pages/setup/mqtt.tsx","pages/setup/not-implemented-yet.tsx","pages/setup/wifi.tsx","Routes.tsx","pages/welcome/part-items.tsx","pages/welcome/part-edit.tsx","pages/welcome/index.tsx","App.tsx","reportWebVitals.ts","index.tsx","i18n/config.js"],"names":["window","$","jQuery","require","console","debug","log","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","CloseEventCodes","_ws","_globalState","_server","Result","t","useTranslation","className","to","exact","process","GlobalStateContext","createContext","state","setState","GlobalStateProvider","children","value","assign","spinnerLoadingShow","zespConnected","appInitialized","zespSettings","undefined","selectedServerIndex","devices","useState","Provider","useGlobalState","context","useContext","setTimeout","removeClass","animation","variant","ConnectionStartTimeout","VerifyConnectionTimeout","DefaultRequestTimeoutSeconds","ZespDataEventType","ZespDataEvent","dataType","dataParts","response","Event","_reconnecter","onMessageEvent","EventTarget","ZespConnector","connectAsync","globalState","server","Promise","reject","warn","Single","reconnectAsync","then","catch","error","prev","Constants","setInterval","disconnect","clearInterval","underlyingWebsocket","readyState","close","force","Restart","prevState","protocol","document","location","WebsocketBuilder","address","onOpen","onConnectionOpen","onClose","onConnectionClosed","onError","onConnectionError","onMessage","onMessageReceived","build","send","args","data","isBinary","getBinaryData","requestAsync","timeoutSeconds","responseReceived","validator","responseValidator","listener","event","result","isValid","removeEventListener","addEventListener","request","onSuccess","name","errorMessage","subscribe","handler","zespEvent","unsubscribe","getGlobalState","ws","messageParts","replace","split","length","messageType","shift","exec","unshift","resultEvent","dispatchEvent","message","dataHex","replaceAll","match","group","parseInt","Uint8Array","init","show","setVisible","hide","isVisible","ZespConnectorImplementation","LoadingSpinnerImplementation","JsonZespResponseValidator","fileName","responseFileName","TypedZespResponseValidator","AllMessagesZespResponseValidator","ServiceDevices","requestData","zesp","onDevicesListReceived","jsonString","JSON","parse","device","details","getDeviceDetails","ModelId","Report","key","getReportDetails","x","modelId","predefinedDevices","find","modelIds","findIndex","y","reportKey","clusterId","substr","endpoint","attributeId","getReportName","reportType","DataHaClusterIds","isInitialized","onGroupsReceived","onLocationsReceived","onMiLampDataReceived","onDevicesUpdate","ZespService","initAsync","ZespConnectorPromise","ping","getAsync","json","parseResponse","settings","setAsync","stringify","join","toLocaleLowerCase","props","FadeIn","setClassName","href","target","rel","deviceImage","image","src","style","backgroundImage","title","Name","detailsLink","IEEE","Device","tags","push","filter","i","indexOf","sort","a","b","DevicesGroup","showWithoutGroups","groupName","filterByGroup","rootDevices","lightDevices","sensorDevices","switchDevices","otherDevices","includes","Card","Body","SaveSettings","updatedSettings","promise","toast","loading","success","useEffect","Spinner","alert","Container","Nav","Item","marginTop","DeviceDialog","history","useHistory","setShow","Modal","onHide","onExited","size","Header","closeButton","ieee","OnOffControl","config","arguments","commandOff","commandOn","UnknownControl","configData","report","reportData","OnOffRoot","Row","Col","md","lg","ButtonGroup","Button","onClick","LevelRoot","setValue","minMaxAttributes","min","max","inRange","Math","FormControl","width","type","onChange","command","toString","inputChangeHandler","Number","FormRange","onMouseUp","useLocalStorage","initialValue","readValue","item","localStorage","getItem","storedValue","setStoredValue","handleStorageChange","newValue","Function","setItem","RgbRoot","r","g","color","setColor","colorPicker","setColorPicker","colorChangeHandler","rgb","rgbToXY","colorPickerButton","onChangeComplete","triangle","red","pow","green","blue","X","Y","Z","isNaN","toFixed","IlluminanceSensor","val","getControlForDevice","deviceInfo","controlProps","useParams","NotFoundView","controls","layout","buildLayoutSettingsFromFile","buildLayoutSettingsFromZesp","content","s","reportDetails","clusterInfo","roleInfo","role","attributeInfo","attributes","roleControlSettings","getControlId","handleSubmit","action","preventDefault","input","prop","attr","ReactForm","onSubmit","restProps","Form","predefinedMessages","predefinedBinary","messages","_setMessages","messageSendValue","setMessageSendValue","paused","_setPaused","messagesRef","useRef","pausedRef","addMessages","current","cutCount","splice","onSendPredefined","innerText","onSendBinary","messageToSend","Footer","togglePause","startsWith","i2","controlId","label","placeholder","defaultValue","inputProps","Group","as","Label","column","Control","defaultChecked","checkedValue","uncheckedValue","defaultCheckedBool","checked_value","unchecked_value","Check","MQTT","mqttup","mqtt","mqttPort","mqttLogin","mqttPassw","mqttEnable","Home_Assistant","Wifi","ssid","pass","ip","mask","gw","Routes","path","component","MainPage","DevicesPage","DeviceInfoPage","SetupPage","SetupWifiPage","SetupMqttPage","NotImplementedYetPage","SocketTestPage","sortedServers","servers","index","openServerAction","activeClassName","openEditAction","openAddServer","deleteConfirmed","setDeleteConfirmed","popover","Popover","dangerouslySetInnerHTML","__html","editServer","updateAction","addAction","closeAction","InputGroup","Text","OverlayTrigger","trigger","placement","overlay","rootClose","onToggle","deleteAction","WelcomePage","currentPart","setCurrentPart","setEditServer","setServers","backToWelcomeAction","Content","selectedServer","App","reportWebVitals","onPerfEntry","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById","languages","namespaces","i18n","use","initReactI18next","fallbackLng","lng","resources","lang","ns","loadResources","defaultNS"],"mappings":"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","file":"static/js/main.38181daf.chunk.js","sourcesContent":["window.$ = window.jQuery = require('jquery')\n\nif (process.env.NODE_ENV !== \"development\") console.debug = () => {\n    // show info for dev environment only\n    console.log(\"Debug logs are disabled\");\n};","var map = {\n\t\"./config\": 94,\n\t\"./config.js\": 94,\n\t\"./locales/en/common\": 120,\n\t\"./locales/en/common.json\": 120,\n\t\"./locales/en/nav\": 121,\n\t\"./locales/en/nav.json\": 121,\n\t\"./locales/en/pages/devices\": 122,\n\t\"./locales/en/pages/devices.json\": 122,\n\t\"./locales/en/pages/setup-mqtt\": 123,\n\t\"./locales/en/pages/setup-mqtt.json\": 123,\n\t\"./locales/en/pages/setup-wifi\": 124,\n\t\"./locales/en/pages/setup-wifi.json\": 124,\n\t\"./locales/en/pages/welcome\": 125,\n\t\"./locales/en/pages/welcome.json\": 125\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 198;","var map = {\n\t\"./root\": 152,\n\t\"./root.json\": 152\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 335;","// https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent#status_codes\nexport enum CloseEventCodes {\n  Restart = 1012\n}","import {Websocket, WebsocketBuilder} from \"websocket-ts\";\nimport Constants from \"./Constants\";\nimport {ZespDataEvent, ZespDataEventType} from \"./ZespDataEvent\";\nimport {IGlobalState} from \"../../../global-state\";\nimport {IZespConnector, ZespConnectorHandler, ZespConnectorListener} from \"../interfaces/IZespConnector\";\nimport {Single} from \"../../single\";\nimport {CloseEventCodes} from \"../enums/CloseEventCodes\";\nimport {IZespResponseValidator} from \"../interfaces/IZespResponseValidator\";\nimport {IServerInfo} from \"../../../pages/welcome/interfaces\";\n\n// const zespHost = \"192.168.3.30\"; //TODO read host from config\n\nlet _ws: Websocket;\nlet _globalState: IGlobalState;\nlet _server: IServerInfo | null;\nconst onMessageEvent = new EventTarget();\nlet _reconnecter: NodeJS.Timeout | null | undefined;\n\nconst ZespConnector: IZespConnector = {\n  connectAsync: (globalState, server) => new Promise<IZespConnector>((resolve, reject) => {\n    if (_globalState && _server) {\n      console.warn(\"ZespConnector already initialized\");\n      resolve(Single.ZespConnector);\n      return;\n    }\n\n    _globalState = globalState;\n    _server = server;\n\n    // start with delay\n    setTimeout(() => ZespConnector.reconnectAsync(true)\n        .then(() => resolve(Single.ZespConnector))\n        .catch(error => {\n          _globalState.setState(prev => ({...prev, ...{zespConnected: false}}));\n          reject(error);\n        }),\n      Constants.ConnectionStartTimeout);\n\n    // setup watchdog\n    _reconnecter = setInterval(() => ZespConnector.reconnectAsync(false)\n        .then(() => resolve(Single.ZespConnector))\n        .catch(error => {\n          console.warn(`Reconnection is failed: ${error}`);\n          _globalState.setState(prev => ({...prev, ...{zespConnected: false}}));\n          reject(error);\n        }),\n      Constants.VerifyConnectionTimeout);\n\n    return ZespConnector;\n  }),\n\n  disconnect: () => {\n    if (_reconnecter) {\n      clearInterval(_reconnecter);\n      _reconnecter = null;\n    }\n    _server = null;\n    _globalState.setState(prev => ({...prev, ...{zespConnected: false}}));\n\n    try {\n      if (_ws?.underlyingWebsocket?.readyState === 3 || _ws?.underlyingWebsocket?.readyState == null) {\n        console.debug(\"zesp connection already closed\");\n        return;\n      } else if (_ws?.underlyingWebsocket?.readyState === 1) {\n        console.debug(\"zesp connection closing...\");\n        _ws.close(1000); // closed normal\n        return;\n      } else {\n        _ws?.close(1000); // closed normal\n      }\n    } catch {\n      //it's ok (;\n    }\n  },\n\n  reconnectAsync: (force) => new Promise<void>((resolve, reject) => {\n    if (!_globalState) {\n      reject(\"ZespConnector is not initialized yet\");\n      // throw new Error(\"ZespConnector is not initialized yet\")\n    }\n\n    if (!_server) {\n      reject(\"Server configuration missed\");\n      // throw new Error(\"ZespConnector is not initialized yet\")\n    }\n\n    if (_ws?.underlyingWebsocket?.readyState === 0) {\n      reject(\"Already connecting\");\n      return;\n    }\n\n    // check if already connected\n    if (_ws?.underlyingWebsocket?.readyState === 1 && !force) {\n      resolve();\n      return;\n    }\n\n    // create new connection\n    console.debug(\"Start ws connection...\");\n    try {\n      _ws.close(CloseEventCodes.Restart);\n    } catch {\n      // it's ok :P\n    }\n\n    _globalState.setState(prevState => ({...prevState, ...{zespConnected: false}}))\n    const protocol = document.location.protocol === \"https:\" ? \"wss\" : \"ws\";\n    _ws = new WebsocketBuilder(`${protocol}://${_server!.address}:81`)\n      .onOpen(() => {\n        onConnectionOpen();\n        resolve();\n      })\n      .onClose(onConnectionClosed)\n      .onError(() => {\n        onConnectionError();\n        reject(\"zesp connection error\")\n      })\n      .onMessage(onMessageReceived)\n      .build();\n  }),\n\n  send: (args) => {\n    if (!_globalState) throw new Error(\"ZespConnector is not initialized yet\");\n    const data = args.isBinary === true\n      ? getBinaryData(args.data)\n      : args.data;\n\n    _ws.send(data);\n  },\n\n  requestAsync: (args) => new Promise<ZespDataEvent>(((resolve, reject) => {\n    if (!args.timeoutSeconds || args.timeoutSeconds <= 0) args.timeoutSeconds = Constants.DefaultRequestTimeoutSeconds;\n    if (args.isBinary !== true) args.isBinary = false;\n\n    let responseReceived = false;\n    const validator = args.responseValidator;\n\n    // on response received from zesp\n    const listener = (event: Event) => {\n      const result = event as ZespDataEvent;\n      if (!validator.isValid(result)) return;\n\n      responseReceived = true;\n      onMessageEvent.removeEventListener(ZespDataEventType, listener);\n      resolve(result);\n    }\n\n    // if no response for a specific time (timeout)\n    const onTimeout = () => {\n      if (responseReceived) return;\n\n      onMessageEvent.removeEventListener(ZespDataEventType, listener);\n      console.warn(`zesp response did not received (timeout: ${args.timeoutSeconds} seconds)`);\n      reject(\"timeout\");\n    };\n\n    // send request\n    try {\n      onMessageEvent.addEventListener(ZespDataEventType, listener);\n      ZespConnector.send({data: args.data, isBinary: args.isBinary})\n      setTimeout(onTimeout, args.timeoutSeconds * 1000);\n    } catch (error) {\n      reject(`exception: ${error}`);\n    }\n  })),\n\n  request: (args) => new Promise<IZespConnector>((resolve, reject) => {\n    ZespConnector\n      .requestAsync(args)\n      .then(event => {\n        if (args.onSuccess) args.onSuccess(event);\n        else console.debug(`zesp request completed (${args.responseValidator.name})`);\n\n        resolve(Single.ZespConnector);\n      })\n      .catch(error => {\n        const errorMessage = `${error} (${args.responseValidator.name}; ${args.data})`;\n\n        if (args.onError) args.onError(errorMessage);\n        else console.warn(`zesp request failed: ${errorMessage}`);\n        reject(errorMessage);\n      });\n  }),\n\n  subscribe: (validator: IZespResponseValidator, handler: ZespConnectorHandler): ZespConnectorListener => {\n    const listener = (event: Event): void => {\n      const zespEvent = event as ZespDataEvent;\n      if (!validator.isValid(zespEvent)) return;\n\n      handler(zespEvent);\n    }\n\n    onMessageEvent.addEventListener(ZespDataEventType, listener)\n    return listener;\n  },\n\n  unsubscribe: (listener: ZespConnectorListener) => onMessageEvent.removeEventListener(ZespDataEventType, listener),\n\n  getGlobalState: () => _globalState\n};\n\nconst onConnectionOpen = () => {\n  console.debug(\"Zesp connection opened\");\n  _globalState.setState(prevState => ({...prevState, ...{zespConnected: true}}));\n}\n\nconst onConnectionClosed = () => {\n  console.debug(\"Zesp connection closed\");\n  _globalState.setState(prevState => ({...prevState, ...{zespConnected: false}}));\n}\n\nconst onConnectionError = () => {\n  console.debug(\"Zesp connection error happened )=\");\n}\n\nconst onMessageReceived = (ws: Websocket, e: MessageEvent) => {\n  const messageParts = e.data\n    .replace(/\\|(?=([^\"]*\"[^\"]*\")*[^\"]*$)/ig, \"\\x00\")\n    .split(\"\\x00\");\n\n  if (messageParts.length == 0) {\n    console.warn(\"Received empty message from zesp\");\n    return;\n  }\n\n  let messageType = messageParts.shift();\n\n  const jsonMatch = /\\/(.+)\\.json/ig.exec(messageType);\n  if (jsonMatch) {\n    messageParts.unshift(messageType);\n    messageType = \"json\";\n  }\n\n  const resultEvent = new ZespDataEvent(messageType, messageParts, e.data);\n  // console.debug(resultEvent);\n  onMessageEvent.dispatchEvent(resultEvent);\n}\n\nconst getBinaryData = (message: string): Uint8Array => {\n  const data = message.replaceAll(\" \", \"\");\n  const dataHex = data.match(/[\\da-f]{2}/gi)?.map(group => parseInt(group, 16)) as ArrayLike<number>;\n  return new Uint8Array(dataHex);\n}\n\nexport default ZespConnector;","import React from 'react';\nimport {useTranslation} from \"react-i18next\";\nimport {NavLink} from \"react-router-dom\";\n\nimport './styles.scss'\n\nconst Result = () => {\n  const {t} = useTranslation(\"nav\");\n\n  return (\n    <nav className=\"nav nav-masthead justify-content-center\">\n      <NavLink className=\"nav-link\" to=\"/\" exact={true}>{t('home')}</NavLink>\n      <NavLink className=\"nav-link\" to=\"/devices\">{t('devices')}</NavLink>\n      {process.env.NODE_ENV === \"development\" && (\n        <NavLink className=\"nav-link\" to=\"/socket-test\" exact={true}>Test WS</NavLink>\n      )}\n      <NavLink className=\"nav-link\" to=\"/setup\">{t('setup')}</NavLink>\n    </nav>\n  );\n};\n\nexport default Result;","// https://jamiehaywood.medium.com/typesafe-global-state-with-typescript-react-react-context-c2df743f3ce\n\nimport React, {createContext, Dispatch, SetStateAction, useContext, useState} from \"react\";\nimport {GetDefaultGlobalStateValues, GlobalStateInterface} from \"../../global-state\";\n\nconst GlobalStateContext = createContext({\n  state: {} as Partial<GlobalStateInterface>,\n  setState: {} as Dispatch<SetStateAction<Partial<GlobalStateInterface>>>,\n});\n\nconst GlobalStateProvider = (\n  {\n    children,\n    value = {} as GlobalStateInterface,\n  }: {\n    children: React.ReactNode;\n    value?: Partial<GlobalStateInterface>;\n  }) => {\n\n  Object.assign(value, GetDefaultGlobalStateValues(useGlobalState));\n  const [state, setState] = useState(value);\n\n  return (\n    <GlobalStateContext.Provider value={{state, setState}}>\n      {children}\n    </GlobalStateContext.Provider>\n  );\n};\n\nconst useGlobalState = () => {\n  const context = useContext(GlobalStateContext);\n  if (!context) {\n    throw new Error(\"useGlobalState must be used within a GlobalStateContext\");\n  }\n\n  return context;\n};\n\nconst DebugState = () => {\n  const {state} = useGlobalState();\n  return <pre>{JSON.stringify(state || {}, null, \"\\t\")}</pre>;\n};\n\nexport {GlobalStateProvider, DebugState, useGlobalState};","import {Dispatch, SetStateAction} from \"react\";\nimport {ZespSettings} from \"./services/zesp/models/ZespSettings\";\nimport {DeviceInfo} from \"./services/zesp/models/DeviceInfo\";\n\ninterface GlobalStateInterface {\n  spinnerLoadingShow: boolean,\n  zespConnected: boolean,\n  appInitialized: boolean,\n  zespSettings?: ZespSettings,\n  selectedServerIndex: number | null,\n  devices: DeviceInfo[],\n}\n\nexport interface IGlobalState {\n  state: Partial<GlobalStateInterface>,\n  setState: Dispatch<SetStateAction<Partial<GlobalStateInterface>>>\n}\n\n// eslint-disable-next-line\nconst GetDefaultGlobalStateValues = (useGlobalState: () => IGlobalState): GlobalStateInterface => {\n  return ({\n    spinnerLoadingShow: false,\n    zespConnected: false,\n    appInitialized: false,\n    zespSettings: undefined,\n    selectedServerIndex: null,\n    devices: []\n  });\n};\n\nexport {GetDefaultGlobalStateValues};\nexport type {GlobalStateInterface};","import React, {Fragment} from \"react\";\nimport $ from \"jquery\";\nimport \"./styles.scss\"\nimport {Spinner} from \"react-bootstrap\";\nimport {useGlobalState} from \"../global-state-provider\";\n\nconst Result = () => {\n  const {state} = useGlobalState();\n\n  if (state.spinnerLoadingShow) {\n    setTimeout(() => $(\".loading-overlay\").removeClass(\"hidden\"), 0);\n    return (\n      <div className={\"loading-overlay hidden\"}>\n        <Spinner animation=\"border\" variant=\"light\"/>\n      </div>\n    );\n  }\n\n  return <Fragment/>;\n}\n\nexport default Result;","const Result = {\n  // delay before connection start\n  ConnectionStartTimeout: 500,\n\n  // connection verify interval\n  VerifyConnectionTimeout: 5000,\n\n  // default timeout for requests in seconds \n  DefaultRequestTimeoutSeconds: 5,\n}\n\nexport default Result;","export const ZespDataEventType = \"zesp-data-received\";\n\nexport class ZespDataEvent extends Event {\n  readonly dataType: string;\n  readonly response: string;\n  readonly dataParts: string[];\n\n  constructor(dataType: string, dataParts: string[], response: string) {\n    super(ZespDataEventType);\n\n    this.dataType = dataType;\n    this.dataParts = dataParts;\n    this.response = response;\n  }\n}","import {IGlobalState} from \"../../global-state\";\n\nlet _globalState: IGlobalState;\n\nexport interface ILoadingSpinner {\n  init(globalState: IGlobalState): void;\n\n  show(): void;\n\n  hide(): void;\n}\n\nexport default {\n  init: (globalState: IGlobalState) => {\n    if (_globalState) {\n      console.warn(\"Loader spinner already initialized\");\n      return;\n    }\n\n    _globalState = globalState;\n  },\n\n  show: () => setVisible(true),\n  hide: () => setVisible(false),\n} as ILoadingSpinner\n\nconst setVisible = (isVisible: boolean): void => _globalState.setState(prev => ({...prev, ...{spinnerLoadingShow: isVisible}}));","import {IZespConnector} from \"./zesp/interfaces/IZespConnector\";\nimport ZespConnectorImplementation from \"./zesp/common/ZespConnector\";\nimport LoadingSpinnerImplementation, {ILoadingSpinner} from \"../shared/loading-spinner/service\";\n\nexport namespace Single {\n  export const ZespConnector: IZespConnector = ZespConnectorImplementation;\n  export const ZespConnectorPromise: Promise<IZespConnector> = new Promise<IZespConnector>(resolve => resolve(Single.ZespConnector));\n  export const Spinner: ILoadingSpinner = LoadingSpinnerImplementation;\n}","import {ZespDataEvent} from \"./ZespDataEvent\";\nimport {IZespResponseValidator} from \"../interfaces/IZespResponseValidator\";\n\nexport const JsonZespResponseValidator = (fileName: string): IZespResponseValidator => ({\n  name: JsonZespResponseValidator.name,\n  isValid: (event: ZespDataEvent) => {\n    if (event.dataType !== \"json\") return false;\n    const responseFileName = event.dataParts[0];\n    const foundFileName = (/\\/(.+)\\.json/ig.exec(responseFileName) as string[])[1];\n\n    return foundFileName === fileName;\n  }\n});\n\nexport const TypedZespResponseValidator = (dataType: string): IZespResponseValidator => ({\n  name: TypedZespResponseValidator.name,\n  isValid: (event: ZespDataEvent) => event.dataType === dataType\n});\n\nexport const AllMessagesZespResponseValidator: IZespResponseValidator = ({\n  name: \"AllZespResponseValidator\",\n  isValid: (event => true)\n});","import {ZespDataEvent} from \"./common/ZespDataEvent\";\nimport {DeviceInfo, ReportDetails} from \"./models/DeviceInfo\";\nimport DataHaClusterIds from \"../../data/zigbee/ha-cluster-ids.json\";\nimport {IGlobalState} from \"../../global-state\";\nimport {IZespConnector} from \"./interfaces/IZespConnector\";\nimport {TypedZespResponseValidator} from \"./common/ZespResponseValidators\";\nimport predefinedDevices from \"../../data/devices.json\";\nimport {DeviceDetails} from \"../../models/DeviceDetails\";\nimport {ClusterInfo} from \"../../models/ClusterInfo\";\n\nconst ServiceDevices = {\n  requestData: (zesp: IZespConnector) => {\n    return zesp.request({\n      data: \"getDeviceList\",\n      responseValidator: TypedZespResponseValidator(\"alldev\"),\n      onSuccess: (event) => onDevicesListReceived(event, zesp.getGlobalState())\n    })\n  }\n}\n\n// when list of devices received from ZESP\nconst onDevicesListReceived = (event: ZespDataEvent, globalState: IGlobalState): void => {\n  const jsonString: string = event.dataParts[0];\n  const devices: DeviceInfo[] = [];\n  Object.assign(devices, JSON.parse(jsonString))\n\n  // additional device data extraction\n  for (const device of devices) {\n    device.details = getDeviceDetails(device.ModelId);\n\n    for (const key of Object.keys(device.Report))\n      device.Report[key].details = getReportDetails(key);\n  }\n\n  globalState.setState(x => ({...x, ...{devices: devices}}));\n}\n\n// read predefined details\nconst getDeviceDetails = (modelId: string): DeviceDetails | null =>\n  predefinedDevices.find(x => x.modelIds.findIndex(y => y === modelId) >= 0) as DeviceDetails | null;\n\n// parse report key\nconst getReportDetails = (reportKey: string): ReportDetails => {\n  const clusterId = reportKey.substr(2, 4);\n  return {\n    endpoint: reportKey.substr(0, 2),\n    clusterId: clusterId,\n    attributeId: reportKey.substr(6),\n    name: getReportName(clusterId)\n  };\n}\n\n// read report name from cluster info\nconst getReportName = (clusterId: string): string => {\n  const reportType = (DataHaClusterIds as ClusterInfo[]).find(x => x.id == clusterId);\n  return reportType?.name ?? clusterId;\n}\n\nexport default ServiceDevices;","import {Single} from \"../single\";\nimport {JsonZespResponseValidator, TypedZespResponseValidator} from \"./common/ZespResponseValidators\";\nimport {ZespDataEvent} from \"./common/ZespDataEvent\";\nimport {IGlobalState} from \"../../global-state\";\nimport ServiceDevices from \"./service-devices\";\n\nconst send = (data: string) => Single.ZespConnector.send({data: data});\nlet isInitialized = false;\n// let _globalState: IGlobalState;\n\nexport default {\n  initAsync: (globalState: IGlobalState): Promise<void> => new Promise<void>((resolve, reject) => {\n    if (isInitialized) {\n      console.warn(\"zesp service already initialized\");\n      resolve();\n      return;\n    }\n\n    isInitialized = true;\n    // _globalState = globalState\n    console.debug(\"Load initial data from zesp...\");\n\n    //TODO move each promise to fn\n    Single.ZespConnectorPromise\n      .then(zesp => zesp.request({data: \"LoadJson|/groups.json\", responseValidator: JsonZespResponseValidator(\"groups\"), onSuccess: onGroupsReceived}))\n      .then(zesp => zesp.request({data: \"LoadJson|/location.json\", responseValidator: JsonZespResponseValidator(\"location\"), onSuccess: onLocationsReceived}))\n      .then(zesp => zesp.request({data: \"get_Mi_lamp\", responseValidator: TypedZespResponseValidator(\"Mi_lamp\"), onSuccess: onMiLampDataReceived}))\n      .then(ServiceDevices.requestData)\n      .then(zesp => zesp.subscribe(TypedZespResponseValidator(\"rep\"), onDevicesUpdate))\n      .then(() => resolve())\n      .catch(error => {\n        console.error(`Cannot complete zesp service initialization: ${error}`);\n        reject(error);\n      });\n  }),\n\n  ping: () => send(\"ping\"),\n  // loadConfigAsync: () => Single.ZespConnector.requestAsync({data: \"loadConfig\", responseValidator: TypedZespResponseValidator(\"jsconfig\")})\n}\n\nfunction onGroupsReceived(event: ZespDataEvent) {\n  console.log(\"groups received\");\n}\n\nfunction onLocationsReceived(event: ZespDataEvent) {\n  console.log(\"locations received\");\n}\n\nfunction onMiLampDataReceived(event: ZespDataEvent) {\n  console.log(\"MI Lamp data received\");\n}\n\nfunction onDevicesUpdate(event: ZespDataEvent) {\n  console.log(`Device update received: ${event.dataParts[1]}`);\n}\n","import GeneralService from \"./service-general\";\nimport SettingsService from \"./service-settings\";\n\n\nexport const ZespService = ({\n  general: GeneralService,\n  settings: SettingsService\n});","import {ZespSettings} from \"./models/ZespSettings\";\nimport {Single} from \"../single\";\nimport {TypedZespResponseValidator} from \"./common/ZespResponseValidators\";\n\nexport default {\n  getAsync: (): Promise<ZespSettings> => new Promise<ZespSettings>((resolve, reject) => {\n    Single.ZespConnector.requestAsync({data: \"loadConfig\", responseValidator: TypedZespResponseValidator(\"jsconfig\")})\n      .then(event => parseResponse(event.dataParts[0]))\n      .then(settings => resolve(settings))\n      .catch(error => reject(error));\n  }),\n\n  setAsync: (settings: ZespSettings): Promise<void> => {\n    const data = [\n      \"SaveJson\",\n      \"/jsconfig.txt\",\n      JSON.stringify(settings)\n    ].join(\"|\");\n\n    return new Promise((resolve, reject) => {\n      Single.ZespConnector.requestAsync({data: data, responseValidator: TypedZespResponseValidator(\"ZD_RSP\")})\n        .then(event => {\n          // console.log(event);\n          if (event.dataParts[1].toLocaleLowerCase() === \"ok\") resolve();\n          else reject(`Settings was not saved: ${event.response}`)\n        })\n        .catch(error => reject(error));\n    })\n  }\n}\n\nfunction parseResponse(jsonString: string): ZespSettings {\n  const json = JSON.parse(jsonString);\n  const result = {} as ZespSettings;\n  Object.assign(result, json);\n\n  return result;\n}\n","import React, {FunctionComponent} from \"react\";\n\nconst Result: FunctionComponent = (props) => {\n  return (\n    <div className=\"cover text-center d-flex content-light align-self-center flex-grow-1 align-items-center\">\n      <div className=\"\">\n        {props.children}\n      </div>\n    </div>\n  );\n}\n\nexport default Result;","import {FunctionComponent, useState} from \"react\";\nimport \"./styles.scss\";\n\nexport const FadeIn: FunctionComponent = (props) => {\n  const [className, setClassName] = useState(\"show-transition hidden\");\n  setTimeout(() => setClassName(\"show-transition\"), 0);\n\n  return (\n    <div className={className}>\n      {props.children}\n    </div>\n  )\n}","import React from \"react\";\nimport Cover from \"../../shared/cover\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\n\nconst Result = () => (\n  <Cover>\n    <FadeIn>\n      <h1 className=\"cover-heading\">Quite soon, here will be useful info</h1>\n      <p className=\"lead\">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam ultricies ipsum porttitor,\n        aliquet enim eu, congue nulla. Nulla luctus ante sit amet sodales convallis. Aliquam lectus nisl, semper eget\n        aliquam et, malesuada ut orci.</p>\n      <p className=\"lead\">\n        <a href=\"https://t.me/zesp32\" target={\"_blank\"} rel=\"noreferrer\" className=\"btn btn-lg btn-secondary\">Get more</a>\n      </p>\n    </FadeIn>\n  </Cover>\n);\n\nexport default Result;","import React from \"react\";\nimport {DeviceInfo} from \"../../services/zesp/models/DeviceInfo\";\n\ninterface IProps {\n  device: DeviceInfo\n}\n\nexport default (props: IProps) => {\n  const deviceImage = getDeviceImageSrc(props.device);\n  const src = `${process.env.PUBLIC_URL}/device-images/${deviceImage}`;\n  return (<div className=\"item-image\" style={{backgroundImage: `url(${src})`}}/>);\n}\n\nfunction getDeviceImageSrc(device: DeviceInfo): string {\n  if (!device.details) return \"zigbee.png\";\n  return device.details.image;\n}","import React from \"react\";\nimport {DeviceInfo} from \"../../services/zesp/models/DeviceInfo\";\nimport ItemImage from \"./item-image\";\nimport {NavLink} from \"react-router-dom\";\n\ninterface IProps {\n  device: DeviceInfo\n}\n\nexport default (props: IProps) => {\n  const title = props.device.Name && props.device.Name.length > 0 ? props.device.Name : props.device.ModelId\n  const detailsLink = `/devices/${props.device.IEEE}-${props.device.Device}`;\n\n  let tags: string[] = [];\n  for (const key of Object.keys(props.device.Report))\n    tags.push(props.device.Report[key].details.name);\n\n  // remove duplicates and unknown \n  tags = tags\n    .filter((x, i) => tags.indexOf(x) == i)\n    .sort((a, b) => a > b ? 1 : -1);\n\n  return (\n    <NavLink className=\"item p-3 border rounded\" to={detailsLink}>\n      <div className=\"d-flex\">\n        <div><ItemImage device={props.device}/></div>\n        <div className=\"ps-2\">\n          <div className=\"title\">{title}</div>\n          <div className=\"ieee text-muted small\"><span className=\"badge bg-info me-1\">{props.device.Device}</span>{props.device.IEEE}</div>\n          {tags.length > 0 && (\n            <div className=\"badges small\">\n              {tags.map((x, i) => (<span key={i} className=\"badge bg-secondary\">{x}</span>))}\n            </div>\n          )}\n        </div>\n      </div>\n    </NavLink>\n  );\n}","import React, {Fragment} from \"react\";\nimport \"./styles.scss\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {Card} from \"react-bootstrap\";\nimport Item from \"./item\";\nimport {useGlobalState} from \"../../shared/global-state-provider\";\nimport {DeviceInfo} from \"../../services/zesp/models/DeviceInfo\";\nimport {useTranslation} from \"react-i18next\";\nimport {GroupName} from \"../../models/DeviceDetails\"\n\nconst Result = () => {\n  const globalState = useGlobalState();\n  const {t} = useTranslation(\"pages.devices\");\n\n  //TODO style and translate it\n  if (!globalState.state.devices || globalState.state.devices.length == 0) return (\n    <div>No devices found...</div>\n  )\n\n  const devices = globalState.state.devices.sort();\n\n  //TODO filter can be different, according to settings in future \n  const filterByGroup = showWithoutGroups;\n  // const filterByGroup = showDeviceInFirstGroups;\n  // const filterByGroup = showDeviceInAllGroups;\n\n  const rootDevices: DeviceInfo[] = devices.filter(x => filterByGroup(x, \"root\"));\n  const lightDevices: DeviceInfo[] = devices.filter(x => filterByGroup(x, \"light\"));\n  const sensorDevices: DeviceInfo[] = devices.filter(x => filterByGroup(x, \"sensor\"));\n  const switchDevices: DeviceInfo[] = devices.filter(x => filterByGroup(x, \"switch\"));\n  const otherDevices: DeviceInfo[] = devices.filter(x =>\n    !rootDevices.includes(x) &&\n    !lightDevices.includes(x) &&\n    !sensorDevices.includes(x) &&\n    !switchDevices.includes(x)\n  );\n\n  return (\n    <FadeIn>\n      <div className=\"devices\">\n        <Card>\n          <Card.Body>\n            <DevicesGroup title={t(\"groups.hub\")} devices={rootDevices}/>\n            <DevicesGroup title={t(\"groups.lights\")} devices={lightDevices}/>\n            <DevicesGroup title={t(\"groups.sensors\")} devices={sensorDevices}/>\n            <DevicesGroup title={t(\"groups.switches\")} devices={switchDevices}/>\n            <DevicesGroup title={otherDevices.length === devices.length ? t(\"groups.all\") : t(\"groups.other\")} devices={otherDevices}/>\n          </Card.Body>\n        </Card>\n      </div>\n    </FadeIn>\n  );\n}\n\nconst DevicesGroup = (props: { devices: DeviceInfo[], title?: string | null }) => props.devices.length == 0\n  ? (<Fragment/>)\n  : (\n    <div className=\"group border-top pt-4\">\n      {props.title && (\n        <div className=\"title h5 pb-3\">\n          <span>{props.title}</span>\n          {props.devices.length > 1 && (<span className=\"badge bg-secondary ms-2\">{props.devices.length}</span>)}\n        </div>\n      )}\n      <div className=\"items d-flex flex-wrap\">\n        {props.devices.map((device, i) => (<Item device={device} key={i}/>))}\n      </div>\n    </div>\n  )\n\nconst showWithoutGroups = (device: DeviceInfo, groupName: GroupName) => !groupName;\n\n// const showDeviceInAllGroups = (device: DeviceInfo, groupName: TemplateGroupName) =>\n//   device.templateInfo &&\n//   device.templateInfo.groups &&\n//   device.templateInfo.groups.indexOf(groupName) >= 0;\n\n// const showDeviceInFirstGroups = (device: DeviceInfo, groupName: TemplateGroupName) =>\n//   device.templateInfo &&\n//   device.templateInfo.groups &&\n//   device.templateInfo.groups.length > 0 &&\n//   device.templateInfo.groups[0] === groupName;\n\nexport default Result; ","import React, {Fragment, useEffect} from \"react\";\nimport {Container, Nav} from \"react-bootstrap\";\nimport {NavLink} from \"react-router-dom\";\nimport {ZespService} from \"../../services/zesp\";\nimport {Single} from \"../../services/single\";\nimport {useGlobalState} from \"../../shared/global-state-provider\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {ZespSettings} from \"../../services/zesp/models/ZespSettings\";\nimport toast from \"react-hot-toast\";\nimport {TFunction} from \"react-i18next\";\nimport {IGlobalState} from \"../../global-state\";\nimport {BsGearFill} from \"react-icons/bs\";\n\nconst Result = () => {\n  const globalState = useGlobalState();\n\n  useEffect(() => {\n    Single.Spinner.show();\n    ZespService.settings.getAsync()\n      .then(data => {\n        globalState.setState(prev => ({...prev, ...{zespSettings: data}}))\n        Single.Spinner.hide();\n      })\n      .catch(error => {\n        //TODO show error window\n        alert(error);\n      });\n  }, []);\n\n  if (!globalState.state.zespSettings) return (<Fragment/>);\n\n  return (\n    <FadeIn>\n      <div className=\"aaa\">...</div>\n      <Container className=\"p-0\">\n        <Nav variant=\"pills\">\n          <Nav.Item><NavLink className=\"nav-link\" to=\"/setup\" exact>Wifi client</NavLink></Nav.Item>\n          <Nav.Item><NavLink className=\"nav-link\" to=\"/setup/zigbee\">Zigbee settings</NavLink></Nav.Item>\n          <Nav.Item><NavLink className=\"nav-link\" to=\"/setup/mqtt\">MQTT client</NavLink></Nav.Item>\n          <Nav.Item><NavLink className=\"nav-link\" to=\"/setup/telegram\">Telegram bot</NavLink></Nav.Item>\n          <Nav.Item><NavLink className=\"nav-link\" to=\"/setup/z2m\">Zigbee2MQTT client</NavLink></Nav.Item>\n          <Nav.Item className=\"ms-auto\"><NavLink className=\"nav-link\" to=\"/setup/zesp-ui\"><BsGearFill style={{marginTop: \"-3px\"}}/> ZESP:UI</NavLink></Nav.Item>\n        </Nav>\n      </Container>\n    </FadeIn>\n  );\n}\n\nexport const SaveSettings = (data: Partial<ZespSettings>, globalState: IGlobalState, t: TFunction<string[]>): Promise<void> => {\n  const updatedSettings: ZespSettings = ({...globalState.state.zespSettings!, ...data});\n  const promise = ZespService.settings.setAsync(updatedSettings)\n    .then(() => globalState.setState(prev => ({...prev, zespSettings: updatedSettings})));\n\n  toast.promise(promise, {loading: t(\"common:saving_progress\"), success: t(\"common:saving_success\"), error: t(\"common:saving_error\")});\n  return promise;\n}\n\nexport default Result;\n","import React, {ReactNode, useState} from \"react\";\nimport \"./styles.scss\";\nimport {useHistory} from \"react-router-dom\";\nimport {Modal} from \"react-bootstrap\";\n\nexport interface IProps {\n  children?: ReactNode\n  title: string,\n}\n\nexport const DeviceDialog = (props: IProps) => {\n  const history = useHistory();\n  const [show, setShow] = useState(true);\n\n  const handleClose = () => setShow(false);\n  const handleExit = () => setTimeout(() => history.push(\"/devices\"), 100);\n\n  return (\n    <Modal show={show} onHide={handleClose} onExited={handleExit} size=\"lg\">\n      <Modal.Header closeButton>{props.title}</Modal.Header>\n      <Modal.Body className=\"text-start device-dialog\">\n        {props.children}\n      </Modal.Body>\n    </Modal>\n  )\n}","import React from \"react\";\n\ninterface IProps {\n  device: string,\n  ieee: string,\n}\n\nexport default (props: IProps) => {\n  return (\n    <>\n      <p>Somehow we missed data for selecte device.</p>\n      <p>\n        <ul>\n          <li>Would you so kind to refresh this page and try again?</li>\n          <li>In case if you still cannot see this information, please <a\n            href=\"https://github.com/NickRimmer/zesp-ui/issues\" target={\"_blank\"}>let us know</a> about the problem.\n          </li>\n        </ul>\n      </p>\n      <p>\n        <div className=\"alert alert-warning\">Device: <span className=\"badge bg-info\">{props.device}</span> <b>{props.ieee}</b></div>\n      </p>\n    </>\n  )\n}\n","import React from \"react\";\nimport {LayoutSettingsOnOff} from \"./settings\";\nimport {IDeviceControlProps} from \"../interfaces/IDeviceControlProps\";\n\nexport const OnOffControl = (props: IDeviceControlProps<LayoutSettingsOnOff>) => {\n  return (\n    <>\n      <div>off: {props.config?.arguments?.commandOff}</div>\n      <div>on: {props.config?.arguments?.commandOn}</div>\n    </>\n  )\n}\n","import React from \"react\";\nimport {IDeviceControlProps} from \"../interfaces/IDeviceControlProps\";\nimport {LayoutSettings} from \"./settings\";\n\nexport const UnknownControl = (props: IDeviceControlProps<LayoutSettings>) => {\n  const configData = JSON.stringify(Object.assign({...props.config}, {report: props.config.report ? \"<hidden>\" : null})); // remove report to eject it to another var\n  const reportData = JSON.stringify(props.config.report);\n\n  return (\n    <>\n      <div>Unknown control: {props.config.id}</div>\n      <div className=\"alert alert-info\">\n        <div>{configData}</div>\n        {reportData && (<div className=\"mt-2\">{reportData}</div>)}\n      </div>\n    </>\n  )\n}\n","import React from \"react\";\nimport {LayoutSettingsOnOff} from \"./settings\";\nimport {IDeviceControlProps} from \"../interfaces/IDeviceControlProps\";\nimport {Button, ButtonGroup, Col, Row} from \"react-bootstrap\";\nimport {Single} from \"../services/single\";\n\n// TODO add localization\nexport const OnOffRoot = (props: IDeviceControlProps<LayoutSettingsOnOff>) => {\n  const onHandler = () => {\n    Single.ZespConnector.send({data: props.config.arguments.commandOn, isBinary: true});\n  };\n\n  const offHandler = () => {\n    Single.ZespConnector.send({data: props.config.arguments.commandOff, isBinary: true});\n  };\n\n  return (\n    <Row>\n      <Col md=\"3\" lg=\"2\">Light power:</Col>\n      <Col>\n        <ButtonGroup>\n          <Button variant=\"primary\" onClick={onHandler}>ON</Button>\n          <Button variant=\"secondary\" onClick={offHandler}>OFF</Button>\n        </ButtonGroup>\n      </Col>\n    </Row>\n  )\n}\n","import React, {useState} from \"react\";\nimport {LayoutSettingsLevel} from \"./settings\";\nimport {IDeviceControlProps} from \"../interfaces/IDeviceControlProps\";\nimport {Col, FormControl, Row} from \"react-bootstrap\";\nimport {Single} from \"../services/single\";\nimport FormRange from \"react-bootstrap/FormRange\";\n\n// TODO add localization\nexport const LevelRoot = (props: IDeviceControlProps<LayoutSettingsLevel>) => {\n  //TODO get current value\n  const [value, setValue] = useState(50);\n  const minMaxAttributes = {\n    min: props.config.arguments.min,\n    max: props.config.arguments.max\n  };\n\n  const inRange = (value: number) => Math.max(Math.min(props.config.arguments.max, value), props.config.arguments.min);\n\n  const sliderChangeHandler = () => {\n    const result = inRange(value);\n    const data = props.config.arguments.command.replace(\"{value}\", result.toString(16));\n    Single.ZespConnector.send({data: data});\n  }\n\n  const inputChangeHandler = (value: number) => {\n    const result = inRange(value);\n    setValue(result);\n    const data = props.config.arguments.command.replace(\"{value}\", result.toString(16));\n    Single.ZespConnector.send({data: data});\n  }\n\n  return (\n    <Row>\n      <Col md=\"3\" lg=\"2\">Level:</Col>\n      <Col>\n        <FormControl\n          style={{width: \"80px\"}}\n          className=\"me-2\"\n          type=\"number\"\n          value={value}\n          onChange={event => inputChangeHandler(Number(event.target.value))}\n          {...minMaxAttributes}\n        />\n\n        <FormRange\n          value={value}\n          onChange={event => setValue(Number(event.target.value))}\n          onMouseUp={sliderChangeHandler}\n          {...minMaxAttributes}\n        />\n      </Col>\n    </Row>\n  )\n}\n","// Copy-pasted from here: https://usehooks-typescript.com/react-hook/use-local-storage\n\nimport {Dispatch, SetStateAction, useEffect, useState} from 'react'\n\ntype SetValue<T> = Dispatch<SetStateAction<T>>\n\nexport function useLocalStorage<T>(key: string, initialValue: T): [T, SetValue<T>] {\n  // Get from local storage then\n  // parse stored json or return initialValue\n  const readValue = (): T => {\n    // Prevent build error \"window is undefined\" but keep keep working\n    if (typeof window === 'undefined') {\n      return initialValue\n    }\n\n    try {\n      const item = window.localStorage.getItem(key)\n      return item ? (JSON.parse(item) as T) : initialValue\n    } catch (error) {\n      console.warn(`Error reading localStorage key ${key}:`, error)\n      return initialValue\n    }\n  }\n\n  // State to store our value\n  // Pass initial state function to useState so logic is only executed once\n  const [storedValue, setStoredValue] = useState<T>(readValue)\n\n  // Return a wrapped version of useState's setter function that ...\n  // ... persists the new value to localStorage.\n  const setValue: SetValue<T> = value => {\n    // Prevent build error \"window is undefined\" but keeps working\n    if (typeof window == 'undefined') {\n      console.warn(\n        `Tried setting localStorage key ${key} even though environment is not a client`,\n      )\n    }\n\n    try {\n      // Allow value to be a function so we have the same API as useState\n      const newValue = value instanceof Function ? value(storedValue) : value\n\n      // Save to local storage\n      window.localStorage.setItem(key, JSON.stringify(newValue))\n\n      // Save state\n      setStoredValue(newValue)\n\n      // We dispatch a custom event so every useLocalStorage hook are notified\n      window.dispatchEvent(new Event('local-storage'))\n    } catch (error) {\n      console.warn(`Error setting localStorage key ${key}:`, error)\n    }\n  }\n\n  useEffect(() => {\n    setStoredValue(readValue())\n  }, [])\n\n  useEffect(() => {\n    const handleStorageChange = () => {\n      setStoredValue(readValue())\n    }\n\n    // this only works for other documents, not the current one\n    window.addEventListener('storage', handleStorageChange)\n\n    // this is a custom event, triggered in writeValueToLocalStorage\n    window.addEventListener('local-storage', handleStorageChange)\n\n    return () => {\n      window.removeEventListener('storage', handleStorageChange)\n      window.removeEventListener('local-storage', handleStorageChange)\n    }\n  }, [])\n\n  return [storedValue, setValue]\n}\n","import React, {useState} from \"react\";\nimport {IDeviceControlProps} from \"../interfaces/IDeviceControlProps\";\nimport {LayoutSettingsRgb} from \"./settings\";\nimport {HuePicker, GithubPicker, CompactPicker, RGBColor} from \"react-color\";\nimport {Col, Row} from \"react-bootstrap\";\nimport {Single} from \"../services/single\";\nimport {useLocalStorage} from \"../services/localStorage\";\n\n//TODO localize\nexport const RgbRoot = (props: IDeviceControlProps<LayoutSettingsRgb>) => {\n  const [color, setColor] = useState<RGBColor>({r: 255, g: 255, b: 255});\n  const [colorPicker, setColorPicker] = useLocalStorage(\"colorPicker\", 1);\n\n  const colorChangeHandler = (rgb: RGBColor) => {\n    setColor(rgb);\n\n    const [x, y] = rgbToXY(rgb);\n    let command = props.config.arguments.command.replace(\"{x}\", x.toString(16));\n    command = command.replace(\"{y}\", y.toString(16));\n    Single.ZespConnector.send({data: command});\n  }\n\n  const sendColorHandler = () => {\n    const [x, y] = rgbToXY(color);\n\n    let command = props.config.arguments.command.replace(\"{x}\", x.toString(16));\n    command = command.replace(\"{y}\", y.toString(16));\n\n    Single.ZespConnector.send({data: command});\n  }\n\n  const colorPickerButton = (id: number) =>\n    (<button className={`btn btn-outline-secondary me-1 btn-xs ${colorPicker == id ? \"active\" : \"\"}`} type=\"button\" onClick={() => setColorPicker(id)}>{id}</button>)\n\n  return (\n    <Row>\n      <Col md=\"3\" lg=\"2\" className=\"user-select-none\">\n        <div>\n          <div>Light color:</div>\n          <div>\n            {colorPickerButton(1)}\n            {colorPickerButton(2)}\n            {colorPickerButton(3)}\n          </div>\n        </div>\n      </Col>\n      <Col>\n        <div className=\"flex-grow-1\">\n          {colorPicker === 1 && (<HuePicker color={color} onChange={event => setColor(event.rgb)} onChangeComplete={sendColorHandler}/>)}\n          {colorPicker === 2 && (<GithubPicker color={color} onChange={event => colorChangeHandler(event.rgb)} triangle=\"hide\" width=\"214px\"/>)}\n          {colorPicker === 3 && (<CompactPicker color={color} onChange={event => colorChangeHandler(event.rgb)}/>)}\n        </div>\n      </Col>\n    </Row>\n  );\n}\n\nconst rgbToXY = (rgb: RGBColor) => {\n  // Apply a gamma correction to the RGB values, which makes the color more vivid and more the like the color displayed on the screen of your device\n  // const red = (rgb.r > 0.04045) ? Math.pow((rgb.r + 0.055) / (1.0 + 0.055), 2.4) : (rgb.r / 12.92);\n  const red = (rgb.b > 0.04045) ? Math.pow((rgb.b + 0.055) / (1.0 + 0.055), 2.4) : (rgb.b / 12.92);\n  const green = (rgb.g > 0.04045) ? Math.pow((rgb.g + 0.055) / (1.0 + 0.055), 2.4) : (rgb.g / 12.92);\n  // const blue = (rgb.b > 0.04045) ? Math.pow((rgb.b + 0.055) / (1.0 + 0.055), 2.4) : (rgb.b / 12.92);\n  const blue = (rgb.r > 0.04045) ? Math.pow((rgb.r + 0.055) / (1.0 + 0.055), 2.4) : (rgb.r / 12.92);\n\n\n  // RGB values to XYZ using the Wide RGB D65 conversion formula\n  const X = red * 0.664511 + green * 0.154324 + blue * 0.162028;\n  const Y = red * 0.283881 + green * 0.668433 + blue * 0.047685;\n  const Z = red * 0.000088 + green * 0.072310 + blue * 0.986039;\n\n  // Calculate the xy values from the XYZ values\n  // let x = (X / (X + Y + Z)).toFixed(4);\n  // let y = (Y / (X + Y + Z)).toFixed(4)\n  let x = (X / (X + Y + Z));\n  let y = (Y / (X + Y + Z));\n\n  if (isNaN(x)) x = 0;\n  if (isNaN(y)) y = 0;\n\n  return [Number((x * 65279).toFixed(0)), Number((y * 65279).toFixed(0))];\n}","import React from \"react\";\nimport {LayoutSettingsSensor} from \"./settings\";\nimport {IDeviceControlProps} from \"../interfaces/IDeviceControlProps\";\nimport {Col, Row} from \"react-bootstrap\";\n\n//TODO localization\nexport const IlluminanceSensor = (props: IDeviceControlProps<LayoutSettingsSensor>) => {\n  console.log(props);\n  return (\n    <Row>\n      <Col md=\"3\" lg=\"2\">Illuminance:</Col>\n      <Col>{props.config.report?.val || (\n        <span className=\"alert alert-warning small py-2 m-0\">No data</span>\n      )}</Col>\n    </Row>\n  )\n}","import {DeviceInfo} from \"../services/zesp/models/DeviceInfo\";\nimport {LayoutSettings, LayoutSettingsLevel, LayoutSettingsOnOff, LayoutSettingsRgb, LayoutSettingsSensor} from \"./settings\";\nimport {OnOffControl} from \"./OnOffControl\";\nimport {UnknownControl} from \"./UnknownControl\";\nimport React from \"react\";\nimport {IDeviceControlProps} from \"../interfaces/IDeviceControlProps\";\nimport {OnOffRoot} from \"./OnOffRoot\";\nimport {LevelRoot} from \"./LevelRoot\";\nimport {RgbRoot} from \"./RgbRoot\";\nimport {IlluminanceSensor} from \"./IlluminanceSensor\";\n\nexport const getControlForDevice = (config: LayoutSettings, deviceInfo: DeviceInfo) => {\n  const controlProps: IDeviceControlProps<LayoutSettings> = {\n    config,\n    deviceInfo,\n  }\n\n  switch (config.id) {\n    case \"on_off_root\" :\n      return (<OnOffRoot {...controlProps} config={controlProps.config as LayoutSettingsOnOff}/>);\n    case \"level_root\" :\n      return (<LevelRoot {...controlProps} config={controlProps.config as LayoutSettingsLevel}/>);\n    case \"rgb_root\" :\n      return (<RgbRoot {...controlProps} config={controlProps.config as LayoutSettingsRgb}/>);\n\n    case \"on_off_control\" :\n      return (<OnOffControl {...controlProps} config={controlProps.config as LayoutSettingsOnOff}/>);\n\n    case \"illuminance_sensor\" :\n      return (<IlluminanceSensor {...controlProps} config={controlProps.config as LayoutSettingsSensor}/>);\n\n    default:\n      return (<UnknownControl {...controlProps}/>)\n  }\n}","import React from \"react\";\nimport DataHaClusterIds from \"../../data/zigbee/ha-cluster-ids.json\";\nimport {useParams} from \"react-router-dom\";\nimport {useGlobalState} from \"../../shared/global-state-provider\";\nimport {DeviceDialog} from \"./DeviceDialog\";\nimport NotFoundView from \"./NotFoundView\";\nimport {DeviceInfo, ReportInfo} from \"../../services/zesp/models/DeviceInfo\";\nimport {LayoutSettings} from \"../../device-controls/settings\";\nimport {ClusterInfo} from \"../../models/ClusterInfo\";\nimport {getControlForDevice} from \"../../device-controls\";\n\nexport default () => {\n  const {ieee, device} = useParams<{ ieee: string, device: string }>();\n  const {state} = useGlobalState();\n  const deviceInfo = state.devices?.find(x => x.IEEE === ieee && x.Device === device);\n\n  if (!deviceInfo) return (\n    <DeviceDialog title=\"Oops... Device information not found\"><NotFoundView device={device} ieee={ieee}/></DeviceDialog>\n  );\n\n  const layoutSettings: LayoutSettings[] = deviceInfo.details?.layout\n    ? buildLayoutSettingsFromFile(deviceInfo)\n    : buildLayoutSettingsFromZesp(deviceInfo);\n\n  const controls = layoutSettings.map((settings, i) => (<div key={i} className=\"device-control-group\">{getControlForDevice(settings, deviceInfo)}</div>));\n  const content = (<div>{controls}</div>);\n  return (<DeviceDialog title={deviceInfo!.Name || deviceInfo!.ModelId}>{content}</DeviceDialog>);\n}\n\nconst buildLayoutSettingsFromFile = (device: DeviceInfo): LayoutSettings[] => {\n  const settings: LayoutSettings[] = require(`../../data/layouts/${device.details?.layout}`);\n  for (const s of settings) {\n    if (s.value) {\n      const ep = \"01\"; // TODO read from ZESP \n      const reportKey = ep + s.value.clusterId + s.value.attributeId;\n      s.report = device.Report[reportKey];\n    }\n  }\n\n  return settings;\n}\n\n//TODO refactoring required to reduce method cyclomatic complexity\nconst buildLayoutSettingsFromZesp = (device: DeviceInfo): LayoutSettings[] => {\n  const getControlId = (report: ReportInfo): LayoutSettings => {\n    const reportDetails = report.details;\n\n    const clusterInfo = (DataHaClusterIds as ClusterInfo[]).find(x => x.id == reportDetails.clusterId);\n    if (!clusterInfo) return {id: reportDetails.clusterId};\n\n    // build layout based on role\n    const roleInfo = report.role?.split(\"&\");\n    if (roleInfo && roleInfo.length > 0) {\n      let attributeInfo = (clusterInfo.attributes && clusterInfo.attributes[roleInfo[0]]) || {id: roleInfo[0]} as LayoutSettings;\n\n      // add role configured settings\n      if (roleInfo.length > 1) {\n        const roleControlSettings = JSON.parse(roleInfo[1]);\n        attributeInfo = {...attributeInfo, ...roleControlSettings};\n      }\n\n      // add report settings\n      attributeInfo = {...attributeInfo, ...{report: report}}\n\n      return attributeInfo;\n    }\n\n    // try to read attribute info from layout\n    const attributeInfo = clusterInfo.attributes && clusterInfo.attributes[reportDetails.attributeId];\n    if (!attributeInfo) return {id: `${reportDetails.clusterId}:${reportDetails.attributeId}`};\n\n    return attributeInfo;\n  }\n\n  const reports = Object.keys(device.Report);\n  return reports.map(key => getControlId(device.Report[key]));\n}\n\n","import {FormEvent} from \"react\";\nimport $ from \"jquery\";\n\n// we need this 'any' type to provide general solution\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype IAction = (arg: any) => void;\n\nconst Result = {\n  handleSubmit: function handleSubmit(e: FormEvent, action: IAction) {\n    e.preventDefault();\n\n    // we need this 'any' type to provide general solution\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const data: any = {};\n\n    for (const input of $(e.target).find(\"input\")) {\n      const id = $(input).prop(\"id\");\n      if (id == null) return;\n\n      if ($(input).prop(\"type\") === \"checkbox\") {\n        if ($(input).prop(\"checked\") === true) data[id] = $(input).attr(\"checked_value\") || \"true\";\n        else data[id] = $(input).attr(\"unchecked_value\") || \"false\";\n      } else {\n        data[id] = $(input).val();\n      }\n    }\n    // console.log(data);\n    action(data)\n  }\n};\n\nexport default Result;","import React, {FormEvent} from \"react\";\nimport {Form} from \"react-bootstrap\";\n\nimport {IProps} from \"./interfaces\";\nimport $ from \"./logic\";\n\nconst ReactForm = (props: IProps) => {\n  const {onSubmit, ...restProps} = props;\n  const onSubmitForm = (event: FormEvent) => $.handleSubmit(event, onSubmit);\n\n  return (\n    <Form onSubmit={onSubmitForm} {...restProps}>\n      {props.children}\n    </Form>\n  );\n}\n\nexport {ReactForm};","import React, {useEffect, useRef, useState} from \"react\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {Button, Card} from \"react-bootstrap\";\nimport {ReactForm} from \"../../shared/form/react-form\";\nimport {Single} from \"../../services/single\";\nimport {AllMessagesZespResponseValidator} from \"../../services/zesp/common/ZespResponseValidators\";\n\nconst maxMessagesCount = 15;\nconst predefinedMessages = [\"getDeviceList\", \"get_Mi_lamp\", \"LoadJson|/location.json\", \"LoadJson|/groups.json\"];\nconst predefinedBinary = [\"01 0000 01 0100\", \"01 0000 01 0000\"];\n\ninterface IFormData {\n  messageToSend?: string,\n}\n\nexport default () => {\n  const [messages, _setMessages] = useState<string[]>([]);\n  const [messageSendValue, setMessageSendValue] = useState<string>(\"\");\n  const [paused, _setPaused] = useState<boolean>(false);\n\n  const messagesRef = useRef(messages);\n  const pausedRef = useRef(paused);\n\n  const addMessages = (message: string) => {\n    if (pausedRef.current) return;\n\n    const data: string[] = [message.substr(0, 250), ...messagesRef.current];\n    const cutCount = data.length - maxMessagesCount;\n    if (cutCount > 0) data.splice(data.length - cutCount, cutCount)\n\n    messagesRef.current = data;\n    _setMessages(data);\n  }\n\n  const togglePause = () => {\n    const data = !pausedRef.current;\n    pausedRef.current = data;\n    _setPaused(data);\n  }\n\n  const onSend = (data: IFormData) => {\n    if (!data.messageToSend) return;\n    addMessages(`>${data.messageToSend}`);\n    Single.ZespConnector.send({data: data.messageToSend});\n  }\n\n  const onSendPredefined = (event: React.MouseEvent): void => {\n    const el = event.target as HTMLButtonElement;\n    const data = el.innerText;\n    setMessageSendValue(data);\n  }\n\n  const onSendBinary = (message?: string | null): void => {\n    const data = message || messageSendValue;\n    Single.ZespConnector.send({data: data, isBinary: true});\n\n    // const dataHex = data.match(/[\\da-f]{2}/gi)?.map(group => parseInt(group, 16)) as ArrayLike<number>;\n    // const dataToSend = new Uint8Array(dataHex);\n    //\n    // addMessages(`>bin: ${data} (${dataToSend})`);\n    // Single.ZespConnector.send(dataToSend);\n  }\n\n  const onClearLog = () => {\n    messagesRef.current = [];\n    _setMessages([]);\n  }\n\n  useEffect(() => {\n    const listener = Single.ZespConnector.subscribe(AllMessagesZespResponseValidator, (event) => {\n      const message = event.response;\n      addMessages(message);\n    });\n    return () => Single.ZespConnector.unsubscribe(listener);\n  }, []);\n\n  return (\n\n    <FadeIn>\n      <ReactForm onSubmit={onSend}>\n        <Card>\n          <Card.Header>WebSocket tester (FOR DEVELOPMENT ONLY)</Card.Header>\n          <Card.Body>\n            <div className=\"row mb-2\">\n              <label className=\"col-md-3 col-lg-2\">Message to send</label>\n              <div className=\"col\">\n                <input type=\"text\" className=\"form-control\" id=\"messageToSend\" value={messageSendValue} onChange={event => setMessageSendValue(event.target.value)}/>\n              </div>\n            </div>\n            <div className=\"row\">\n              <div className=\"col-md-3 col-lg-2\"/>\n              <div className=\"col\">\n                <div>\n                  {predefinedMessages.map((x, i) => (\n                    <button key={i} type=\"submit\" className=\"btn btn-sm btn-outline-primary me-1\" onClick={onSendPredefined}>{x}</button>\n                  ))}\n                </div>\n                <div className=\"mt-1\">\n                  {predefinedBinary.map((x, i) => (\n                    <button key={i} type=\"button\" className=\"btn btn-sm btn-outline-secondary me-1\" onClick={() => {\n                      setMessageSendValue(x);\n                      onSendBinary(x);\n                    }}>{x}</button>\n                  ))}\n                </div>\n              </div>\n            </div>\n          </Card.Body>\n          <Card.Footer>\n            <Button variant=\"primary\" type=\"submit\">Send message</Button>\n            <Button variant=\"secondary\" type=\"button\" onClick={() => onSendBinary()} className=\"ms-2\">Send binary</Button>\n          </Card.Footer>\n        </Card>\n      </ReactForm>\n\n      <Card className=\"mt-4\">\n        <Card.Header>\n          <span>Communication log <span className=\"badge bg-secondary small\">{messages.length}</span></span>\n          <button className=\"btn btn-outline-secondary ms-3 btn-sm\" onClick={onClearLog}>Clear log</button>\n          <button className=\"btn btn-outline-secondary ms-3 btn-sm\" onClick={() => togglePause()}>{paused ? \"Start logs\" : \"Pause logs\"}</button>\n        </Card.Header>\n        <Card.Body>\n          {messages.map((message, i) => message.startsWith(\">\")\n            ? (<div key={i} className=\"px-2 mb-3 py-1 m-1 bg-success bg-opacity-25 rounded\">{message.substr(1)}</div>)\n            : (<div key={i} className=\"border-start mb-3 border-3 border-warning p-0 d-flex flex-wrap\">{message.split(\"|\").map((x, i2) => (\n              <span key={i2} className=\"bg-warning bg-opacity-25 m-1 px-2 rounded\">{x}</span>\n            ))}</div>))}\n        </Card.Body>\n      </Card>\n    </FadeIn>\n  );\n}","import React from \"react\";\nimport {Col, Form, Row} from \"react-bootstrap\";\n\ntype Props = {\n  defaultValue?: string | number | boolean | undefined;\n  controlId: string;\n  label: string;\n  placeholder?: string;\n  type?: \"text\" | \"password\";\n};\n\nconst Result = ({controlId, label, placeholder, defaultValue, type = \"text\"}: Props) => {\n  let inputProps = ({\n    placeholder,\n    type\n  });\n\n  if (defaultValue) inputProps = ({...inputProps, ...{defaultValue: defaultValue.toString()}});\n\n  return (\n    <Form.Group as={Row} className=\"mb-3\" controlId={controlId}>\n      <Form.Label column md=\"3\" lg=\"2\">{label}</Form.Label>\n      <Col>\n        <Form.Control {...inputProps} />\n      </Col>\n    </Form.Group>\n  );\n}\n\nexport default Result;\n","import React from \"react\";\nimport {Form} from \"react-bootstrap\";\n\ntype IProps = {\n  defaultChecked?: boolean | number | string;\n  controlId: string;\n  label: string;\n  checkedValue?: string | number | boolean | undefined;\n  uncheckedValue?: string | number | boolean | undefined;\n};\n\nconst Result = ({controlId, label, defaultChecked, checkedValue = \"true\", uncheckedValue = \"false\"}: IProps) => {\n  const defaultCheckedBool =\n    defaultChecked === \"true\" ||\n    defaultChecked === \"1\" ||\n    defaultChecked === 1 ||\n    defaultChecked === true ||\n    false;\n\n  let props = {checked_value: checkedValue, unchecked_value: uncheckedValue};\n  if (defaultChecked) props = ({...props, ...{defaultChecked: defaultCheckedBool}});\n\n  return (\n    <Form.Group controlId={controlId} className=\"d-inline-block\">\n      <Form.Label className=\"d-flex\">\n        <Form.Check className=\"pe-2\" {...props}/><span>{label}</span>\n      </Form.Label>\n    </Form.Group>\n  );\n}\n\nexport default Result;","import React, {Fragment} from \"react\";\nimport {useTranslation} from \"react-i18next\";\nimport {Button, Card, Col, Row} from \"react-bootstrap\";\nimport {CheckGroupInline, InputGroupHorizontal} from \"../../shared/form\";\nimport {ReactForm} from \"../../shared/form/react-form\";\nimport {useGlobalState} from \"../../shared/global-state-provider\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {ZespMqttSettings} from \"../../services/zesp/models/ZespSettings\";\nimport {SaveSettings} from \"./index\";\n\nconst Result = () => {\n  const globalState = useGlobalState();\n  const {t} = useTranslation([\"pages.setup-mqtt\", \"common\"]);\n  const settings = globalState.state.zespSettings?.MQTT;\n\n  if (!settings) return (<Fragment/>);\n\n  const onSubmit = (data: ZespMqttSettings) => SaveSettings({MQTT: data}, globalState, t);\n\n  return (\n    <FadeIn>\n      <Card>\n        <ReactForm onSubmit={onSubmit}>\n          <Card.Body>\n            <InputGroupHorizontal controlId=\"mqttup\" defaultValue={settings.mqttup} label={t(\"topic.label\")} placeholder={t(\"topic.placeholder\")}/>\n            <InputGroupHorizontal controlId=\"mqtt\" defaultValue={settings.mqtt} label={t(\"server.label\")} placeholder={t(\"server.placeholder\")}/>\n            <InputGroupHorizontal controlId=\"mqttPort\" defaultValue={(settings.mqttPort)?.toString()} label={t(\"port.label\")} placeholder={t(\"port.placeholder\")}/>\n            <InputGroupHorizontal controlId=\"mqttLogin\" defaultValue={settings.mqttLogin} label={t(\"login.label\")} placeholder={t(\"login.placeholder\")}/>\n            <InputGroupHorizontal type=\"password\" controlId=\"mqttPassw\" defaultValue={settings.mqttPassw} label={t(\"password.label\")} placeholder={t(\"password.placeholder\")}/>\n            <Row>\n              <Col md=\"3\" lg=\"2\"/>\n              <Col className=\"space-between-4\">\n                <CheckGroupInline controlId=\"mqttEnable\" defaultChecked={settings.mqttEnable} label={t(\"is_enabled.label\")} checkedValue={1} uncheckedValue={0}/>\n                <CheckGroupInline controlId=\"Home_Assistant\" defaultChecked={settings.Home_Assistant} label={t(\"is_ha_enabled.label\")} checkedValue={1} uncheckedValue={0}/>\n              </Col>\n            </Row>\n\n          </Card.Body>\n          <Card.Footer><Button variant=\"primary\" type=\"submit\">{t(\"common:save_button\")}</Button></Card.Footer>\n        </ReactForm>\n      </Card>\n    </FadeIn>\n  );\n}\n\nexport default Result;","import React from \"react\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\n\nconst Result = () => (\n  <FadeIn>\n    <div className=\"px-4 py-5 bg-light rounded-3\">\n      <div className=\"container-fluid\">\n        <h1 className=\"display-5 fw-bold\">Not implemented yet!</h1>\n        <p className=\"col-md-8 fs-4\">\n          Hello, my dear friend! Just imagine how awesome this feature can be and share it with developers ~_~ <br/><br/>\n          Or you can even implement it yourself, everything you need is just to jump to source codes, made some magic, test it and that's it!\n        </p>\n        <hr className=\"my-4\"/>\n        <p>This feature is under contruction. You can find latest verion on <a href=\"#\">github project page</a> or just click this big blue button bellow.</p>\n        <a href=\"#\" target={\"_blank\"} rel=\"noreferrer\" className=\"btn btn-primary btn-lg\" type=\"button\">Learn more</a>\n      </div>\n    </div>\n    {/*<div className=\"jumbotron\">*/}\n    {/*  <h1 className=\"display-4\">Not implemented yet!</h1>*/}\n    {/*  <p className=\"lead\">*/}\n    {/*    Hello, my dear friend! Just imagine how awesome this feature can be and share it with developers ~_~ <br/>*/}\n    {/*    Or you can even implement it yourself, everything you need is just to jump to source codes, made some magic, test it and that's it!*/}\n    {/*  </p>*/}\n    {/*  <hr className=\"my-4\"/>*/}\n    {/*  <p>This feature is under contruction. You can find latest verion on <a href=\"#\">github project page</a> or just click this big blue button bellow.</p>*/}\n    {/*  <a className=\"btn btn-primary btn-lg\" href=\"#\" target={\"_blank\"} rel=\"noreferrer\" role=\"button\">Learn more</a>*/}\n    {/*</div>*/}\n  </FadeIn>\n);\n\nexport default Result;","import React, {Fragment} from \"react\";\nimport {Button, Card} from \"react-bootstrap\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {useGlobalState} from \"../../shared/global-state-provider\";\nimport {useTranslation} from \"react-i18next\";\nimport {ReactForm} from \"../../shared/form/react-form\";\nimport {InputGroupHorizontal} from \"../../shared/form\";\nimport {ZespWifiSettings} from \"../../services/zesp/models/ZespSettings\";\nimport {SaveSettings} from \"./index\";\n\nconst Result = () => {\n  const globalState = useGlobalState();\n  const {t} = useTranslation([\"pages.setup-wifi\", \"common\"]);\n  const settings = globalState.state.zespSettings?.Wifi;\n\n  if (!settings) return (<Fragment/>);\n\n  const onSubmit = (data: ZespWifiSettings): Promise<void> => SaveSettings({Wifi: data}, globalState, t);\n\n  return (\n    <Fragment>\n      <FadeIn>\n        <ReactForm onSubmit={onSubmit}>\n          <Card>\n            <Card.Body>\n              <InputGroupHorizontal controlId=\"ssid\" defaultValue={settings?.ssid} label={t(\"ssid.label\")} placeholder={t(\"ssid.placeholder\")}/>\n              <InputGroupHorizontal type=\"password\" controlId=\"pass\" defaultValue={settings?.pass} label={t(\"pass.label\")} placeholder={t(\"pass.placeholder\")}/>\n              <InputGroupHorizontal controlId=\"ip\" defaultValue={settings?.ip} label={t(\"ip.label\")} placeholder={t(\"ip.placeholder\")}/>\n              <InputGroupHorizontal controlId=\"mask\" defaultValue={settings?.mask} label={t(\"mask.label\")} placeholder={t(\"mask.placeholder\")}/>\n              <InputGroupHorizontal controlId=\"gw\" defaultValue={settings?.gw} label={t(\"gw.label\")} placeholder={t(\"gw.placeholder\")}/>\n            </Card.Body>\n            <Card.Footer><Button variant=\"primary\" type=\"submit\">{t(\"common:save_button\")}</Button></Card.Footer>\n          </Card>\n        </ReactForm>\n      </FadeIn>\n    </Fragment>\n  )\n};\n\nexport default Result;","import React, {Fragment} from \"react\";\nimport {Route} from \"react-router-dom\";\nimport {DeviceInfoPage, DevicesPage, MainPage, SetupPage, SocketTestPage} from \"./pages\";\nimport {NotImplementedYetPage, SetupMqttPage, SetupWifiPage} from \"./pages/setup/setup-pages\";\n\nexport const Routes = () => (\n  <Fragment>\n      <Route exact path=\"/\" component={MainPage}/>\n      <Route path=\"/devices\" component={DevicesPage}/>\n      <Route path=\"/devices/:ieee-:device\" component={DeviceInfoPage}/>\n      <Route path=\"/setup\" component={SetupPage}/>\n      <Route exact path=\"/setup\" component={SetupWifiPage}/>\n      <Route path=\"/setup/mqtt\" component={SetupMqttPage}/>\n      <Route path=\"/setup/zigbee\" component={NotImplementedYetPage}/>\n      <Route path=\"/setup/telegram\" component={NotImplementedYetPage}/>\n      <Route path=\"/setup/z2m\" component={NotImplementedYetPage}/>\n      <Route path=\"/setup/zesp-ui\" component={NotImplementedYetPage}/>\n      <Route path=\"/socket-test\" component={SocketTestPage}/>\n  </Fragment>\n)","import React from \"react\";\nimport \"./styles.scss\";\nimport {Card} from \"react-bootstrap\";\nimport {NavLink} from \"react-router-dom\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {IServerInfo} from \"./interfaces\";\nimport {useTranslation} from \"react-i18next\";\n\ninterface IProps {\n  openAddServer: () => void,\n  openEditAction: (server: IServerInfo) => void,\n  openServerAction: (index: number) => void,\n  servers: IServerInfo[]\n}\n\nexport default (props: IProps) => {\n  const {t} = useTranslation(\"pages.welcome\");\n  const sortedServers = props.servers\n    .map((server, index) => ({server, index}))\n    .sort((a, b) => a.server.name > b.server.name ? 1 : -1);\n\n  return (\n    <div className=\"container welcome-page h-100\">\n      <FadeIn>\n        <Card className=\"text-start\">\n          <Card.Header>{t(\"list.title\")}</Card.Header>\n          <Card.Body>\n            {props.servers.length == 0 && (\n              <div>{t(\"list.add_message\")}</div>\n            )}\n            {props.servers.length > 0 && (\n              <nav className=\"servers-list\">\n                {sortedServers.map((data, i) => (\n                  <div className=\"item\" key={`item-${i}`}>\n                    <NavLink\n                      className=\"server-button\"\n                      to=\"/\"\n                      onClick={(e) => {\n                        props.openServerAction(data.index);\n                        e.preventDefault();\n                      }}\n                      activeClassName=\"none\"><i className=\"bi bi-caret-right-fill\"/> {data.server.name}</NavLink>\n                    <button type=\"button\" onClick={() => props.openEditAction(data.server)} className=\"edit-button\"><i className=\"bi bi-pencil-fill\"/></button>\n                  </div>\n                ))}\n              </nav>\n            )}\n          </Card.Body>\n          <Card.Footer className=\"text-right\">\n            <button type=\"button\" onClick={props.openAddServer} className=\"btn btn-primary\">{t(\"list.add_button\")}</button>\n          </Card.Footer>\n        </Card>\n      </FadeIn>\n    </div>\n  )\n}","import React, {useState} from \"react\";\nimport \"./styles.scss\";\nimport {Card, FormControl, InputGroup, OverlayTrigger, Popover} from \"react-bootstrap\";\nimport {FadeIn} from \"../../shared/fadein-transition\";\nimport {IServerInfo} from \"./interfaces\";\nimport {ReactForm} from \"../../shared/form/react-form\";\nimport {useTranslation} from \"react-i18next\";\n\ninterface IProps {\n  closeAction: () => void;\n  deleteAction: () => void;\n  addAction: (data: IServerInfo) => void;\n  updateAction: (data: IServerInfo) => void;\n  editServer?: IServerInfo;\n}\n\nexport default (props: IProps) => {\n  const {t} = useTranslation(\"pages.welcome\");\n  const [deleteConfirmed, setDeleteConfirmed] = useState(false);\n\n  const onSubmit = (data: IServerInfo): Promise<void> => {\n    if (props.editServer) props.updateAction(data);\n    else props.addAction(data);\n\n    return Promise.resolve();\n  }\n\n  const onDeleteClicked = () => {\n    if (!deleteConfirmed) return;\n    props.deleteAction();\n  }\n\n  const popover = (\n    <Popover id=\"popover-basic\">\n      <Popover.Header as=\"h3\">{t(\"edit.delete_title\")}</Popover.Header>\n      <Popover.Body><span dangerouslySetInnerHTML={{__html: t(\"edit.delete_message\")}}/></Popover.Body>\n    </Popover>\n  );\n\n  return (\n    <div className=\"container welcome-page h-100\">\n      <FadeIn>\n        <ReactForm onSubmit={onSubmit}>\n          <Card className=\"text-start\">\n            <Card.Header className=\"d-flex justify-content-between\">\n              <span className=\"modal-title\">{t(\"edit.title\")}</span>\n              <button type=\"button\" className=\"btn-close\" aria-label=\"Close\" onClick={props.closeAction}/>\n            </Card.Header>\n            <Card.Body>\n              <FormControl className=\"mb-2\" id=\"name\" defaultValue={props.editServer?.name} placeholder={t(\"edit.name_input_placeholder\")}/>\n              <InputGroup>\n                <InputGroup.Text id=\"basic-addon3\">{document.location.protocol === \"https:\" ? \"wss\" : \"ws\"}://</InputGroup.Text>\n                <FormControl id=\"address\" defaultValue={props.editServer?.address} aria-describedby=\"basic-addon3\" placeholder={t(\"edit.address_input_placeholder\")}/>\n              </InputGroup>\n            </Card.Body>\n\n            {props.editServer && (\n              <Card.Footer className=\"d-flex justify-content-between\">\n                {/*<button type=\"button\" onClick={props.deleteAction} className=\"btn btn-outline-danger\">Delete</button>*/}\n                <div>\n                  <OverlayTrigger trigger=\"click\" placement=\"top\" overlay={popover} rootClose={true} onToggle={setDeleteConfirmed}>\n                    <button onClick={onDeleteClicked} type=\"button\" className=\"btn btn-outline-danger\">{t(\"edit.delete_button\")}</button>\n                  </OverlayTrigger>\n                </div>\n                <button type=\"submit\" className=\"btn btn-primary\">{t(\"edit.save_button\")}</button>\n              </Card.Footer>\n            )}\n\n            {!props.editServer && (\n              <Card.Footer className=\"text-right\">\n                <button type=\"submit\" className=\"btn btn-primary\">{t(\"edit.add_button\")}</button>\n              </Card.Footer>\n            )}\n          </Card>\n        </ReactForm>\n      </FadeIn>\n    </div>\n  )\n}","import React, {FunctionComponent, useState} from \"react\";\nimport \"./styles.scss\";\nimport {IServerInfo, WelcomePageParts} from \"./interfaces\";\nimport PartItems from \"./part-items\";\nimport PartEdit from \"./part-edit\";\nimport {useLocalStorage} from \"../../services/localStorage\";\nimport {useGlobalState} from \"../../shared/global-state-provider\";\n\nexport const WelcomePage: FunctionComponent = () => {\n  const globalState = useGlobalState();\n  const [currentPart, setCurrentPart] = useState<WelcomePageParts>(\"welcome\");\n  const [editServer, setEditServer] = useState<IServerInfo>();\n  const [servers, setServers] = useLocalStorage<IServerInfo[]>(\"servers\", []);\n\n  // const servers: IServerInfo[] = [];\n\n  const backToWelcomeAction = () => {\n    setEditServer(undefined);\n    setCurrentPart(\"welcome\");\n  }\n\n  const openAddAction = () => {\n    setEditServer(undefined);\n    setCurrentPart(\"edit\");\n  }\n\n  const openEditAction = (server: IServerInfo) => {\n    setEditServer(server);\n    setCurrentPart(\"edit\");\n  }\n\n  const addAction = (server: IServerInfo) => {\n    servers.push(server)\n    setServers(servers);\n    backToWelcomeAction();\n  }\n\n  const updateAction = (server: IServerInfo) => {\n    const index = servers.indexOf(editServer!);\n    servers[index] = server;\n    setServers(servers);\n\n    console.log(servers);\n    backToWelcomeAction();\n  }\n\n  const deleteAction = () => {\n    setServers(servers.filter(server => server !== editServer));\n    backToWelcomeAction();\n  };\n\n  const openServerAction = (index: number) => {\n    // const selectedServer = servers[index];\n    // console.log(selectedServer);\n    // console.log(index);\n    globalState.setState(prev => ({...prev, ...{selectedServerIndex: index}}));\n  }\n\n  if (currentPart === \"edit\") return (\n    <PartEdit editServer={editServer} addAction={addAction} updateAction={updateAction} closeAction={backToWelcomeAction} deleteAction={deleteAction}/>);\n  return (<PartItems servers={servers} openAddServer={openAddAction} openEditAction={openEditAction} openServerAction={openServerAction}/>);\n}","import React, {Fragment, useEffect} from 'react';\nimport {BrowserRouter as Router, Switch} from \"react-router-dom\";\nimport './bootstrap-updates.scss';\nimport './App.scss';\nimport TopMenu from \"./shared/top-menu\";\nimport LoadingSpinner from \"./shared/loading-spinner\";\nimport {GlobalStateProvider, useGlobalState} from \"./shared/global-state-provider\";\nimport {Single} from \"./services/single\";\nimport {ZespService} from \"./services/zesp\";\nimport toast, {Toaster} from \"react-hot-toast\";\nimport {Routes} from \"./Routes\";\nimport {WelcomePage} from \"./pages/welcome\";\nimport {useLocalStorage} from \"./services/localStorage\";\nimport {IServerInfo} from \"./pages/welcome/interfaces\";\n\nconst Content = () => {\n  const globalState = useGlobalState();\n  const [servers] = useLocalStorage<IServerInfo[]>(\"servers\", []);\n  const selectedServer = (\n    globalState.state.selectedServerIndex === null || servers.length <= globalState.state.selectedServerIndex!\n      ? null\n      : servers[globalState.state.selectedServerIndex!]\n  );\n\n  return selectedServer ? (<App server={selectedServer}/>) : (<WelcomePage/>);\n  // return <WelcomePage/>;\n}\n\nconst App = (props: { server: IServerInfo }) => {\n  const globalState = useGlobalState();\n\n  useEffect(() => {\n    Single.Spinner.init(globalState);\n    Single.Spinner.show();\n\n    Single.ZespConnectorPromise\n      .then(zesp => zesp.connectAsync(globalState, props.server))\n      .then(() => ZespService.general.initAsync(globalState))\n      .then(() => {\n        globalState.setState(prev => ({...prev, ...{appInitialized: true}}))\n        Single.Spinner.hide();\n      })\n      .catch(error => {\n        globalState.setState(prev => ({\n          ...prev, ...{\n            appInitialized: false,\n            selectedServerIndex: null,\n          }\n        }))\n        Single.ZespConnector.disconnect();\n        Single.Spinner.hide();\n\n        toast.error(`Ooops, cannot connect to the server (${props.server.address}). ${error}`); //TODO localization\n      });\n  }, []);\n\n  if (!globalState.state.appInitialized) {\n    return (<Fragment/>);\n  }\n\n  return (\n    <div className=\"container-md d-flex w-100 h-100 p-3 mx-auto flex-column\">\n      <header className=\"masthead\">\n        <a href=\"/\"><h3 className=\"masthead-brand\">ZESP:UI</h3></a>\n        <TopMenu/>\n      </header>\n      <main role=\"main\" className=\"text-start d-flex flex-grow-1 flex-column\">\n        <Routes/>\n      </main>\n      <footer className=\"mastfoot mt-3\">\n        <p>ZESP UI application, by <a href=\"https://t.me/NickRimmer\" target={\"_blank\"} rel=\"noreferrer\">@NickRimmer</a>. (0.0.0 version, <span>dev build</span>)\n        </p>\n      </footer>\n    </div>\n  )\n}\n\nconst Result = () => {\n  return (\n    <Router>\n      <Switch>\n        <GlobalStateProvider>\n          <Content/>\n          <LoadingSpinner/>\n          <Toaster/>\n        </GlobalStateProvider>\n      </Switch>\n    </Router>\n  );\n}\n\nexport default Result;","import {ReportHandler} from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({getCLS, getFID, getFCP, getLCP, getTTFB}) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport './loader.js';\nimport \"bootstrap/dist/js/bootstrap.bundle\";\nimport './i18n/config';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App/>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import i18n from \"i18next\";\nimport {initReactI18next} from \"react-i18next\";\n\nconst languages = [\"en\"];\nconst namespaces = [\n    \"common\",\n    \"nav\",\n    \"pages.setup-mqtt\",\n    \"pages.setup-wifi\",\n    \"pages.welcome\",\n    \"pages.devices\",\n];\n\nconst i18next = i18n.use(initReactI18next);\ni18next.init({\n    fallbackLng: languages[0],\n    lng: languages[0],\n    resources: loadResources(),\n    ns: namespaces,\n    defaultNS: 'common'\n});\ni18n.languages = languages;\n\nfunction loadResources() {\n    const result = {};\n\n    for (let lang of languages) {\n        result[lang] = {};\n\n        for (let ns of namespaces) {\n            const path = `./locales/${lang}/${ns.replace(\".\", \"/\")}.json`;\n            try {\n                // eslint-disable-next-line \n                result[lang][ns] = require('' + path); // wtf with JS???\n                console.debug(`${path} (ok)`);\n            } catch (error) {\n                // it's ok\n                console.debug(`${path} (error)`);\n            }\n        }\n    }\n\n    return result;\n}\n\nexport default i18n;"],"sourceRoot":""}