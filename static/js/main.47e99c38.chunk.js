(this["webpackJsonpzesp-ui-app"]=this["webpackJsonpzesp-ui-app"]||[]).push([[0],{117:function(e,t,n){},124:function(e){e.exports=JSON.parse('{"save_button":"Save changes","saving_success":"Saving successful","saving_error":"Oops... we cannot complete it )=","saving_progress":"Saving in progress..."}')},125:function(e){e.exports=JSON.parse('{"home":"Home","devices":"Devices","setup":"Settings"}')},126:function(e){e.exports=JSON.parse('{"groups":{"hub":"Hub devices","sensors":"Sensors or monitoring systems","switches":"Switches","lights":"Lights and bulbs","other":"Other or unknown devices","all":"All registered devices"}}')},127:function(e){e.exports=JSON.parse('{"topic":{"label":"Topic name","placeholder":"Enter MQTT topic name (e.g. zesp32)"},"server":{"label":"Server address","placeholder":"Enter MQTT server address (e.g. 192.168.1.1)"},"port":{"label":"Server port","placeholder":"Enter MQTT server port (e.g. 1883)"},"login":{"label":"MQTT Login","placeholder":"Enter MQTT user login (e.g. mqtt)"},"password":{"label":"MQTT Password","placeholder":"Enter MQTT user password (e.g. pa$vv0rd)"},"is_enabled":{"label":"Client is enabled"},"is_ha_enabled":{"label":"Home Assistant"}}')},128:function(e){e.exports=JSON.parse('{"ssid":{"label":"WIFI SSID","placeholder":"Enter SSID of your wifi AP (e.g. MySecretWifi)"},"pass":{"label":"WIFI Password","placeholder":"Enter your connection password (e.g. super-duper-password)"},"ip":{"label":"Local address","placeholder":"Enter static IP address and port of device with ZESP (e.g. 192.168.1.2:8082)"},"mask":{"label":"Local mask address","placeholder":"Enter device network mask (e.g. 255.255.255.0)"},"gw":{"label":"Gateway address","placeholder":"Enter gateway address (e.g. 192.168.1.1)"}}')},129:function(e){e.exports=JSON.parse('{"list":{"title":"Welcome here, stranger!","add_button":"Add a new server","add_message":"There is no servers added. Please, click this big blue button bellow to add your awesome server."},"edit":{"title":"Connection settings","delete_button":"Delete","delete_title":"Delete confirmation","delete_message":"Are you <strong>sure</strong> you want to delete it?<br/>Just asking, no pressure... if you want to continue, smash <span class=\'badge bg-danger\'>Delete</span> button bellow one more time.","save_button":"Save changes","add_button":"Add server","name_input_placeholder":"Enter display name (e.g. My hub4fun)","address_input_placeholder":"Your server address (e.g. 192.168.1.1)"}}')},155:function(e){e.exports=JSON.parse('[{"id":"on_off_root","arguments":{"commandOn":"01 0000 01  0100","commandOff":"01 0000 01  0000"},"reportKey":{"endpoint":"01","clusterId":"0006","attributeId":"0000"}},{"id":"level_root","arguments":{"command":"MoveToLevel|0000|1|1|1|{value}|0009","min":0,"max":255},"reportKey":{"endpoint":"FF","clusterId":"BBBB","attributeId":"0001"}},{"id":"rgb_root","arguments":{"command":"MoveToColor|0000|1|1|{x}|{y}|0001"},"reportKey":{"endpoint":"FF","clusterId":"BBBB","attributeId":"0002"}},{"id":"illuminance_sensor","reportKey":{"endpoint":"01","clusterId":"0106","attributeId":"0000"}},{"id":"level_control","group":"Playback","label":"Volume","arguments":{"command":"setVolume|{value:dec}","min":0,"max":32768},"reportKey":{"endpoint":"FF","clusterId":"BBBB","attributeId":"0003"}},{"id":"player_src_root","group":"Playback","reportKey":{"endpoint":"FF","clusterId":"BBBB","attributeId":"0004"}},{"id":"player_control_root","group":"Playback","arguments":{"commandOn":"playSound|{value}","commandOff":"killSound|0"},"reportKey":{"endpoint":"FF","clusterId":"BBBB","attributeId":"0005"}}]')},163:function(e){e.exports=JSON.parse('[{"modelIds":["ZESP_Root"],"image":"zesp.jpg","controls":"root.json"},{"modelIds":["lumi.sensor_switch"],"image":"default-sensor-switch.jpg"},{"modelIds":["lumi.sensor_motion"],"image":"default-sensor-motion.jpg"},{"modelIds":["lumi.sensor_magnet"],"image":"default-sensor-magnet.jpg"}]')},179:function(e,t,n){},180:function(e,t,n){window.$=window.jQuery=n(36),console.debug=function(){console.log("Debug logs are disabled")}},202:function(e,t,n){var c={"./config":98,"./config.js":98,"./locales/en/common":124,"./locales/en/common.json":124,"./locales/en/nav":125,"./locales/en/nav.json":125,"./locales/en/pages/devices":126,"./locales/en/pages/devices.json":126,"./locales/en/pages/setup-mqtt":127,"./locales/en/pages/setup-mqtt.json":127,"./locales/en/pages/setup-wifi":128,"./locales/en/pages/setup-wifi.json":128,"./locales/en/pages/welcome":129,"./locales/en/pages/welcome.json":129};function r(e){var t=a(e);return n(t)}function a(e){if(!n.o(c,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return c[e]}r.keys=function(){return Object.keys(c)},r.resolve=a,e.exports=r,r.id=202},203:function(e,t,n){},204:function(e,t,n){},205:function(e,t,n){},212:function(e,t,n){},213:function(e,t,n){},323:function(e,t,n){},324:function(e){e.exports=JSON.parse('{"default":{"titles":{"onTrue":"True","onFalse":"False"},"icons":{"onTrue":"bi-check-circle","onFalse":"bi-slash-circle"},"styles":{"onTrue":"status-primary","onFalse":"status-secondary"}},"door":{"titles":{"onTrue":"Opened","onFalse":"Closed"},"icons":{"onTrue":"bi-door-open","onFalse":"bi-door-closed"}},"motion":{"titles":{"onTrue":"Detected","onFalse":"No motion"},"icons":{"onTrue":"bi-soundwave","onFalse":"bi-fullscreen"}}}')},325:function(e,t,n){var c={"./root":155,"./root.json":155};function r(e){var t=a(e);return n(t)}function a(e){if(!n.o(c,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return c[e]}r.keys=function(){return Object.keys(c)},r.resolve=a,e.exports=r,r.id=325},341:function(e,t,n){},342:function(e,t,n){},343:function(e,t,n){},344:function(e,t,n){},345:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(22),o=n.n(a),s=(n(179),n(180),n(181),n(98),n(5)),i=n(17),l=n(15),d=(n(203),n(204),n(205),n(357)),u=n(351),b=n(10),j=n(26),m={spinnerShow:!1,spinnerMessage:"Loading..."},p=Object(j.b)({name:"spinner",initialState:m,reducers:{setSpinnerShow:function(e,t){e.spinnerShow=t.payload,e.spinnerShow&&(e.spinnerMessage=m.spinnerMessage)},setSpinner:function(e,t){e.spinnerShow=t.payload.show,e.spinnerMessage=t.payload.message||m.spinnerMessage}}}),f=function(e){return e.spinner},v=p.actions,O=v.setSpinnerShow,h=v.setSpinner,g=p.reducer,x=n(1),y=function(){var e=Object(b.c)(f),t=e.spinnerShow,n=e.spinnerMessage;return Object(x.jsx)(d.a,{show:t,centered:!0,size:"sm",backdrop:!0,children:Object(x.jsx)(d.a.Body,{children:Object(x.jsxs)("div",{className:"d-flex align-items-center",children:[Object(x.jsx)(u.a,{animation:"border",variant:"primary",className:"me-3"}),Object(x.jsx)("div",{children:n})]})})})},w=n(20),N=(n(212),function(e){var t=Object(c.useState)("show-transition hidden"),n=Object(s.a)(t,2),r=n[0],a=n[1];return setTimeout((function(){return a("show-transition")}),0),Object(x.jsx)("div",{className:"".concat(r," ").concat(e.className),children:e.children})}),S=n(24),I=(n(213),n(360)),k=n(352),_=function(e){var t=Object(c.useState)(e.device.image),n=Object(s.a)(t,2),r=n[0],a=n[1];return Object(c.useEffect)((function(){var e=new Image;e.onerror=function(){a("/device-images/default.png")},e.src=r}),[]),Object(x.jsx)("div",{className:"item-image",style:{backgroundImage:"url(".concat(r,")")}})},C=n(161),z=function(e){var t=e.device,n="/devices/".concat(t.ieee);return Object(x.jsx)(C.a,{xs:12,sm:6,lg:4,xxl:3,className:"p-1",children:Object(x.jsx)(i.b,{className:"item p-3 border rounded d-block",to:n,children:Object(x.jsxs)("div",{className:"d-flex",children:[Object(x.jsx)("div",{children:Object(x.jsx)(_,{device:e.device})}),Object(x.jsxs)("div",{className:"ps-2",children:[Object(x.jsx)("div",{className:"title",children:t.title}),Object(x.jsx)("div",{className:"ieee text-muted small",children:t.ieee}),t.tags.length>0&&Object(x.jsx)("div",{className:"badges small",children:t.tags.map((function(e,t){return Object(x.jsx)("span",{className:"badge bg-secondary",children:e},t)}))})]})]})})})},E=n(361),F=n(85),T=n(2),R=function(e){return(e.customLayout&&e.customLayout.length>0?e.customLayout:D(e)).reduce((function(e,t){var n=t.group||"main",c=e.find((function(e){return e.name===n}));return c||(c={name:n},e.push(c)),c.settings=[].concat(Object(S.a)(c.settings||[]),[t]),e}),[])},P=function(e,t){return t&&"ZED"!==t&&"ZR"!==t?"BED"===t?(null===e||void 0===e?void 0:e.length)<1?void console.warn("Unknown format of BLE report key: '".concat(e,"'")):{endpoint:"",clusterId:e,attributeId:""}:void console.warn("Unknown device type '".concat(t,"'")):10!==(null===e||void 0===e?void 0:e.length)?void console.warn("Unknown format of Zigbee report key: '".concat(e,"'")):{endpoint:e.substr(0,2),clusterId:e.substr(2,4),attributeId:e.substr(6)}},D=function(e){return Object.keys(e.zespInfo.Report).map((function(t){return function(t){var n,c=P(t,e.zespInfo.DevType);if(c){var r=F.find((function(e){return e.clusterId==c.clusterId})),a={id:c.clusterId,reportKey:c};if(!r)return console.debug("Report key '".concat(t,"' with unregistered cluster '").concat(c.clusterId,"' received")),a;var o=null===(n=e.zespInfo.Report[t].role)||void 0===n?void 0:n.split("&");return o&&o.length>0?Object(T.a)(Object(T.a)({},a),L(o,r,t,e.zespInfo.DevType)):r.attributes&&r.attributes[c.attributeId]||a}console.warn("Cannot get report key details for '".concat(e.zespInfo.IEEE,"' device"))}(t)})).filter((function(e){return void 0!==e}))},L=function(e,t,n,c){var r=P(n,c);if(r){var a=e[0],o=e.length>1?e[1]:null,s=t.attributes&&(t.attributes["".concat(r.attributeId,":").concat(a)]||t.attributes[a])||{id:a};return o&&(s.zespRoleSettings=JSON.parse(o)),s}},B=Object(j.b)({name:"devices",initialState:{devices:[]},reducers:{setDevices:function(e,t){e.devices=t.payload},updateReport:function(e,t){var n=e.devices.find((function(e){return e.zespInfo.IEEE===t.payload.ieee}));n?n.zespInfo.Report[t.payload.reportKey]=Object(T.a)(Object(T.a)({},n.zespInfo.Report[t.payload.reportKey]),t.payload.update):console.warn("Device '".concat(t.payload.ieee,"' not found to update"))},updateRootReports:function(e,t){var n=e.devices.find((function(e){return"ZESP_Root"===e.zespInfo.ModelId}));n?n.zespInfo.Report=Object(T.a)(Object(T.a)({},n.zespInfo.Report),t.payload):console.warn("Root device not found to update")}}}),M=function(e,t){return e.devices.devices.find((function(e){return e.zespInfo.IEEE===t}))},A=function(e){return e.devices.devices||[]},V=B.actions,U=V.setDevices,J=V.updateReport,Z=V.updateRootReports,K=B.reducer,q=Object(j.b)({name:"zesp",initialState:{connectionStatus:"disconnected",initialized:!1},reducers:{setConnectionStatus:function(e,t){e.connectionStatus=t.payload},setInitialized:function(e,t){e.initialized=t.payload}}}),W=function(e){return e.zesp.connectionStatus},H=function(e){return e.zesp.initialized},G=q.actions,Q=G.setConnectionStatus,Y=G.setInitialized,$=q.reducer,X=function e(t){return{name:e.name,isValid:function(e){if("json"!==e.dataType)return!1;var n=e.dataParts[0];return/\/(.+)\.json/gi.exec(n)[1]===t}}},ee=function e(t){return{name:e.name,isValid:function(e){return e.dataType===t}}},te={name:"AllZespResponseValidator",isValid:function(e){return!0}},ne=n(163),ce=n(28),re=n(353),ae=n(354),oe=function(e){if(!e.config.reportKey)return console.debug("No report key in config found for ".concat(e.deviceInfo.zespInfo.IEEE," device and ").concat(e.config.id," control")),null;var t=e.config.reportKey.endpoint+e.config.reportKey.clusterId+e.config.reportKey.attributeId;return e.deviceInfo.zespInfo.Report[t]},se=function(e,t){var n,c=null===(n=e.deviceInfo.customLayout)||void 0===n?void 0:n.find((function(e){return e.id===t}));return[c,c&&c.reportKey?e.deviceInfo.zespInfo.Report[c.reportKey.endpoint+c.reportKey.clusterId+c.reportKey.attributeId]:void 0]},ie=function(e){var t=Object(c.useContext)(Nt).zespSend,n=oe(e);return Object(x.jsxs)(k.a,{children:[Object(x.jsx)(ke,{children:"Light power:"}),Object(x.jsx)(_e,{children:Object(x.jsxs)(re.a,{children:[Object(x.jsx)(ae.a,{variant:"1"===(null===n||void 0===n?void 0:n.val.toString())?"primary":"secondary",onClick:function(){t({data:e.config.arguments.commandOn,isBinary:!0})},children:"ON"}),Object(x.jsx)(ae.a,{variant:"1"===(null===n||void 0===n?void 0:n.val.toString())?"secondary":"primary",onClick:function(){t({data:e.config.arguments.commandOff,isBinary:!0})},children:"OFF"})]})})]})},le=n(164),de=n(54),ue=function(e){var t=Object(c.useContext)(Nt).zespSend,n=oe(e),r=(null===n||void 0===n?void 0:n.val)?Number(n.val):(e.config.arguments.max-e.config.arguments.min)/2+e.config.arguments.min,a=Object(c.useState)(r),o=Object(s.a)(a,2),i=o[0],l=o[1],d={min:e.config.arguments.min,max:e.config.arguments.max},u=function(t){return Math.max(Math.min(e.config.arguments.max,t),e.config.arguments.min)};return Object(x.jsxs)(k.a,{children:[Object(x.jsx)(ke,{children:"Level:"}),Object(x.jsxs)(_e,{children:[Object(x.jsx)(le.a,Object(T.a)({style:{width:"80px"},className:"me-2",type:"number",value:i,onChange:function(n){return function(n){var c=u(n);l(c);var r=e.config.arguments.command.replace("{value}",c.toString(16));t({data:r})}(Number(n.target.value))}},d)),Object(x.jsx)(de.a,Object(T.a)({value:i,onChange:function(e){return l(Number(e.target.value))},onMouseUp:function(){var n=u(i),c=e.config.arguments.command.replace("{value}",n.toString(16));t({data:c})}},d))]})]})},be=n(93);function je(e,t){var n=function(){if("undefined"===typeof window)return t;try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(c){return console.warn("Error reading localStorage key \u201c".concat(e,"\u201d:"),c),t}},r=Object(c.useState)(n),a=Object(s.a)(r,2),o=a[0],i=a[1];return Object(c.useEffect)((function(){i(n())}),[]),Object(c.useEffect)((function(){var e=function(){i(n())};return window.addEventListener("storage",e),window.addEventListener("local-storage",e),function(){window.removeEventListener("storage",e),window.removeEventListener("local-storage",e)}}),[]),[o,function(t){"undefined"==typeof window&&console.warn("Tried setting localStorage key \u201c".concat(e,"\u201d even though environment is not a client"));try{var n=t instanceof Function?t(o):t;window.localStorage.setItem(e,JSON.stringify(n)),i(n),window.dispatchEvent(new Event("local-storage"))}catch(c){console.warn("Error setting localStorage key \u201c".concat(e,"\u201d:"),c)}}]}var me=function(e){var t=Object(c.useContext)(Nt).zespSend,n=oe(e),r=(null===n||void 0===n?void 0:n.val)?null===n||void 0===n?void 0:n.val.split(":").map((function(e){return Number(e)})):[255,255,255];3!==r.length&&(console.warn("Incorrect RGB value stored to reportd: ".concat(null===n||void 0===n?void 0:n.val)),r=[255,255,255]);var a=Object(c.useState)({r:r[0],g:r[1],b:r[2]}),o=Object(s.a)(a,2),i=o[0],l=o[1],d=je("colorPicker",1),u=Object(s.a)(d,2),b=u[0],j=u[1],m=function(n){l(n);var c=pe(n),r=Object(s.a)(c,2),a=r[0],o=r[1],i=e.config.arguments.command.replace("{x}",a.toString(16));i=i.replace("{y}",o.toString(16)),t({data:i})},p=function(e){return Object(x.jsx)("button",{className:"btn btn-outline-secondary me-1 btn-xs ".concat(b==e?"active":""),type:"button",onClick:function(){return j(e)},children:e})};return Object(x.jsxs)(k.a,{children:[Object(x.jsx)(ke,{className:"user-select-none",children:Object(x.jsxs)("div",{children:[Object(x.jsx)("div",{children:"Light color:"}),Object(x.jsxs)("div",{children:[p(1),p(2),p(3)]})]})}),Object(x.jsx)(_e,{children:Object(x.jsxs)("div",{className:"flex-grow-1",children:[1===b&&Object(x.jsx)(be.c,{color:i,onChange:function(e){return l(e.rgb)},onChangeComplete:function(){var n=pe(i),c=Object(s.a)(n,2),r=c[0],a=c[1],o=e.config.arguments.command.replace("{x}",r.toString(16));o=o.replace("{y}",a.toString(16)),t({data:o})},width:"270px"}),2===b&&Object(x.jsx)(be.b,{color:i,onChange:function(e){return m(e.rgb)},triangle:"hide",width:"214px"}),3===b&&Object(x.jsx)(be.a,{color:i,onChange:function(e){return m(e.rgb)}})]})})]})},pe=function(e){var t=e.b>.04045?Math.pow((e.b+.055)/1.055,2.4):e.b/12.92,n=e.g>.04045?Math.pow((e.g+.055)/1.055,2.4):e.g/12.92,c=e.r>.04045?Math.pow((e.r+.055)/1.055,2.4):e.r/12.92,r=.664511*t+.154324*n+.162028*c,a=.283881*t+.668433*n+.047685*c,o=88e-6*t+.07231*n+.986039*c,s=r/(r+a+o),i=a/(r+a+o);return isNaN(s)&&(s=0),isNaN(i)&&(i=0),[Number((65279*s).toFixed(0)),Number((65279*i).toFixed(0))]},fe=function(e){var t,n=Object(c.useState)(),r=Object(s.a)(n,2),a=r[0],o=r[1];return!0===e.onRefresh&&Object(c.useEffect)((function(){return o(e.classNameFrom)}),[null===(t=e.children)||void 0===t?void 0:t.toString()]),!1===e.onLoad&&Object(c.useEffect)((function(){return o(e.classNameTo)}),[]),setTimeout((function(){return o(e.classNameTo)}),e.timeOutMs||100),Object(x.jsx)("span",{className:a,children:e.children})},ve=function(e){return Object(x.jsx)(fe,{classNameFrom:"highlight-value just-added",classNameTo:"highlight-value",onRefresh:!0,onLoad:!1,children:e.children})},Oe=function(e){var t,n=Object(c.useState)(!1),r=Object(s.a)(n,2),a=r[0],o=r[1],i=JSON.stringify(e.config),l=JSON.stringify(oe(e)),d=oe(e);if(!d)return Object(x.jsx)(he,{id:e.config.id,reportData:l,configData:i});var u=d.label||e.config.label||e.config.id||"Unknown data",b=d.parsed&&d.parsed.toString().trim()===d.val.toString().trim()&&d.parsed||d.parsed&&d.val&&"".concat(d.parsed," (").concat(d.val,")")||d.val||"No data",j=null===(t=d.role)||void 0===t?void 0:t.split("&"),m=j&&j.length>1&&JSON.parse(j[1]),p=m&&m.unit_of_measurement||"";return Object(x.jsxs)(k.a,{children:[Object(x.jsxs)(ke,{children:[u,":"]}),Object(x.jsxs)(_e,{children:[Object(x.jsxs)(ve,{children:[b," ",p]}),Object(x.jsx)("a",{onClick:function(e){e.preventDefault(),o(!a)},href:"#",className:"value-info",title:"Unrecognized data, click to show details",children:Object(x.jsx)("i",{className:"bi bi-info-circle-fill ms-2 text-secondary"})})]}),Object(x.jsxs)("div",{className:"alert alert-info flex-column col-12 ".concat(a?"":"d-none"),children:[Object(x.jsx)("div",{children:i}),l&&Object(x.jsx)("div",{className:"mt-2",children:l})]})]})},he=function(e){return Object(x.jsxs)(k.a,{children:[Object(x.jsx)(ke,{children:e.id}),Object(x.jsx)(_e,{children:Object(x.jsxs)("div",{className:"alert alert-info",children:[Object(x.jsx)("div",{children:e.configData}),e.reportData&&Object(x.jsx)("div",{className:"mt-2",children:e.reportData})]})})]})},ge=function(e){var t=oe(e),n=(null===t||void 0===t?void 0:t.val)?parseInt(t.val,16).toString():null;return Object(x.jsxs)(k.a,{children:[Object(x.jsx)(ke,{children:"Illuminance:"}),Object(x.jsxs)(_e,{children:[n&&Object(x.jsx)(ve,{children:n}),!n&&Object(x.jsx)("span",{className:"alert alert-warning small py-2 m-0",children:"No data"})]})]})},xe=function(e){var t=Object(c.useContext)(Nt).zespSend,n={min:e.config.arguments.min,max:e.config.arguments.max},r=oe(e),a=(null===r||void 0===r?void 0:r.parsed)?Number(r.parsed):(n.max-n.min)/2+n.min,o=Object(c.useState)(a),i=Object(s.a)(o,2),l=i[0],d=i[1],u=function(t){return Math.max(Math.min(e.config.arguments.max,t),e.config.arguments.min)},b=function(n){var c=ye(e.config.arguments.command,n,e);t({data:c})},j=(null===r||void 0===r?void 0:r.label)||e.config.label||"Level";return Object(x.jsxs)(k.a,{children:[Object(x.jsxs)(ke,{children:[j,":"]}),Object(x.jsxs)(_e,{children:[Object(x.jsx)(le.a,Object(T.a)({style:{width:"100px"},className:"me-2 text-center",type:"number",value:l,onChange:function(e){return function(e){var t=u(e);d(t),b(t)}(Number(e.target.value))}},n)),Object(x.jsx)(de.a,Object(T.a)({value:l,onChange:function(e){return d(Number(e.target.value))},onMouseUp:function(){var e=u(l);b(e)}},n))]})]})},ye=function(e,t,n){return e.replace("{device}",n.deviceInfo.zespInfo.Device).replace("{value}",t.toString(16)).replace("{value:dec}",t.toString())},we=function(e){var t=Object(c.useContext)(Nt).zespSend,n=oe(e),r=se(e,"player_control_root"),a=Object(s.a)(r,2),o=a[0],i=a[1];if(!n)return Object(c.useEffect)((function(){w.b.error("'".concat(e.config.id,"' layout settings not found"))}),[]),Object(x.jsx)(x.Fragment,{});if(!i)return Object(c.useEffect)((function(){w.b.error("'player_control_root' layout settings not found")}),[]),Object(x.jsx)(x.Fragment,{});var l=Object(c.useState)(n.val||""),d=Object(s.a)(l,2),u=d[0],b=d[1],j=Object(c.useState)(i.val||"OFF"),m=Object(s.a)(j,2),p=m[0],f=m[1];return Object(x.jsxs)(k.a,{children:[Object(x.jsx)(ke,{children:"Radio stream:"}),Object(x.jsx)(_e,{children:Object(x.jsxs)("div",{className:"input-group",children:[Object(x.jsx)("input",{className:"form-control",list:"datalistOptions",placeholder:"Click to see dropdown suggestions",value:u,onChange:function(e){var t=e.target.value;b(t)}}),Object(x.jsx)("button",{className:"btn btn-outline-secondary ".concat("ON"!==p?"active":""),type:"button",onClick:function(){f("OFF"),b(""),o?t({data:o.arguments.commandOff}):console.warn("No configured OFF command for 'player_control_root' operation found in layout")},children:Object(x.jsx)("i",{className:"bi-stop"})}),Object(x.jsx)("button",{className:"btn btn-outline-secondary rounded-end ".concat("ON"===p?"active":""),type:"button",onClick:function(){u&&0!==u.length?(f("ON"),o?t({data:o.arguments.commandOn.replace("{value}",u)}):console.warn("No configured ON command for 'player_control_root' operation found in layout")):w.b.error("Please select source first",{icon:"\ud83c\udfb5"})},children:Object(x.jsx)("i",{className:"bi-play"})}),Object(x.jsx)("datalist",{id:"datalistOptions",children:["http://chanson.hostingradio.ru:8041/chanson128.mp3","http://dorognoe.hostingradio.ru:8000/radio?type=.mp3","http://stream3.radiostyle.ru:8001/biker-fm","http://air.radiorecord.ru:8102/sd90_320","http://stream.hitroe.com/stream","http://air.radiorecord.ru:8102/tm_320","http://eu.radioboss.fm:8024/stream","http://listen.181fm.com/181-thebox_128k.mp3?","http://stream.live.vc.bbcmedia.co.uk/bbc_radio_one"].map((function(e,t){return Object(x.jsx)("option",{value:e},t)}))})]})})]})},Ne=function(e){var t,n,c,r=oe(e);if(!r)return Object(x.jsx)("div",{className:"alert alert-warning",children:"Report missed"});var a=Number((null===(t=e.config.zespRoleSettings.payload_on)||void 0===t?void 0:t.toString())||"0"),o=Number((null===(n=r.parsed)||void 0===n?void 0:n.toString())||(null===(c=r.val)||void 0===c?void 0:c.toString())||"1")===a;return Object(x.jsxs)(k.a,{children:[Object(x.jsxs)(ke,{children:[r.label||"State",":"]}),Object(x.jsx)(_e,{children:Object(x.jsx)(ve,{children:o?"ON":"OFF"})})]})},Se=function(e){var t=oe(e);if(!t)return Object(x.jsx)("div",{className:"alert alert-warning",children:"Report missed"});var n=t.parsed||t.val,c=e.config.zespRoleSettings.unit_of_measurement||"";return Object(x.jsxs)(k.a,{children:[Object(x.jsxs)(ke,{children:[t.label||"Value",":"]}),Object(x.jsx)(_e,{children:Object(x.jsx)(ve,{children:n?"".concat(n," ").concat(c):"No data"})})]})},Ie=function(e){var t=Object(c.useContext)(Nt).zespSend,n=oe(e),r=(null===n||void 0===n?void 0:n.label)||e.config.label||"Power";return Object(x.jsxs)(k.a,{children:[Object(x.jsxs)(ke,{children:[r,":"]}),Object(x.jsx)(_e,{children:Object(x.jsxs)(re.a,{children:[Object(x.jsx)(ae.a,{variant:"1"===(null===n||void 0===n?void 0:n.parsed.toString())?"primary":"secondary",onClick:function(){var n=e.config.arguments.commandOn.replace("{device}",e.deviceInfo.zespInfo.Device);t({data:n,isBinary:!0})},children:"ON"}),Object(x.jsx)(ae.a,{variant:"secondary",onClick:function(){var n=e.config.arguments.commandToggle.replace("{device}",e.deviceInfo.zespInfo.Device);t({data:n,isBinary:!0})},children:"Toggle"}),Object(x.jsx)(ae.a,{variant:"0"===(null===n||void 0===n?void 0:n.parsed.toString())?"primary":"secondary",onClick:function(){var n=e.config.arguments.commandOff.replace("{device}",e.deviceInfo.zespInfo.Device);t({data:n,isBinary:!0})},children:"OFF"})]})})]})},ke=function(e){return Object(x.jsx)(C.a,{md:"4",children:e.children})},_e=function(e){return Object(x.jsx)(C.a,{children:e.children})},Ce=function(e){var t=[],n=[];e.settings.forEach((function(r){var a=function(e,t){var n={config:e,deviceInfo:t};switch(e.id){case"on_off_root":return{type:"regular",element:Object(x.jsx)(ie,Object(T.a)(Object(T.a)({},n),{},{config:n.config}))};case"level_root":return{type:"regular",element:Object(x.jsx)(ue,Object(T.a)(Object(T.a)({},n),{},{config:n.config}))};case"rgb_root":return{type:"regular",element:Object(x.jsx)(me,Object(T.a)(Object(T.a)({},n),{},{config:n.config}))};case"player_src_root":return{type:"regular",element:Object(x.jsx)(we,Object(T.a)(Object(T.a)({},n),{},{config:n.config}))};case"player_control_root":return{type:"skip",element:Object(x.jsx)(c.Fragment,{})};case"level_control":return{type:"regular",element:Object(x.jsx)(xe,Object(T.a)(Object(T.a)({},n),{},{config:n.config}))};case"illuminance_sensor":return{type:"regular",element:Object(x.jsx)(ge,Object(T.a)(Object(T.a)({},n),{},{config:n.config}))};case"binary_sensor":return{type:"regular",element:Object(x.jsx)(Ne,Object(T.a)(Object(T.a)({},n),{},{config:n.config}))};case"sensor":return{type:"regular",element:Object(x.jsx)(Se,Object(T.a)(Object(T.a)({},n),{},{config:n.config}))};case"on_off_toggle":return{type:"regular",element:Object(x.jsx)(Ie,Object(T.a)(Object(T.a)({},n),{},{config:n.config}))};default:return{type:"unknown",element:Object(x.jsx)(Oe,Object(T.a)({},n))}}}(r,e.device);"skip"!==a.type&&("unknown"===a.type?n.push(a.element):t.push(a.element))}));var r=Object(c.useState)(0===t.length),a=Object(s.a)(r,2),o=a[0],i=a[1];return Object(x.jsxs)("div",{className:"default-layout",children:[t.length>0&&Object(x.jsx)("div",{className:"elements",children:t.map((function(e,t){return Object(x.jsx)("div",{className:"device-control-group",children:e},t)}))}),n.length>0&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)("button",{onClick:function(){i(!o)},className:"show-unknown-btn btn btn-outline-info",children:["Unknown reports (",n.length,")"]}),Object(x.jsx)("div",{className:"elements unknown ".concat(o?"show":"hide"),children:n.map((function(e,t){return Object(x.jsx)("div",{className:"device-control-group",children:e},t)}))})]})]})},ze=(n(323),["0100060000","0104060000"]),Ee=["010000FF02"],Fe=n(324),Te=[2.7,3.1],Re=function(e){var t=De(ze,e);if(!t)return{iconClassName:Fe.default.icons.onFalse,valueClassName:"status-unknown",valueTitle:"Unknown"};var n=t.parsed||t.val,c=t.role&&t.role.split("&"),r=c&&c.length>1?JSON.parse(c[1]):void 0,a=r&&r.payload_on?n===r.payload_on:"1"===n||"01"===n,o=r&&r.device_class||"default",s=Object(T.a)(Object(T.a)({},Fe.default),Fe[o]);return{iconClassName:a?"".concat(s.icons.onTrue," ").concat(s.styles.onTrue):"".concat(s.icons.onFalse," ").concat(s.styles.onFalse),valueClassName:"status ".concat(a?s.styles.onTrue:s.styles.onFalse),valueTitle:a?s.titles.onTrue:s.titles.onFalse}},Pe=function(e){var t,n=De(Ee,e);if(!n)return{stateClassName:"??",valueTitle:"-",valuePercents:0};var c=null===(t=n.role)||void 0===t?void 0:t.split("&"),r=c&&c.length>1?JSON.parse(c[1]):void 0,a=r&&r.unit_of_measurement||"",o=Number(n.parsed||n.val)||void 0,s=void 0;if(o)if("%"===a)s=Number(o);else{var i=Number(o)||void 0;i&&(i=Math.min(Te[1],Math.max(Te[0],i)),s=Math.round(100*(1-(Te[1]-i)/(Te[1]-Te[0]))))}else s=void 0;var l=r&&r.device_class||"default",d=Object(T.a)(Object(T.a)({},Fe.default),Fe[l]),u="".concat(o||"??"," ").concat(a);return{stateClassName:s?s<=50?d.styles.onFalse:d.styles.onTrue:"status-unknown",valuePercents:s||0,valueTitle:u}},De=function(e,t){var n,c=Object(ce.a)(e);try{for(c.s();!(n=c.n()).done;){var r=n.value,a=t.device.zespInfo.Report[r];if(a)return a}}catch(o){c.e(o)}finally{c.f()}},Le={default:Ce,binarySensorLayout:function(e){var t=Re(e),n=Pe(e);return Object(x.jsxs)("div",{className:"row custom-binary-layout",children:[Object(x.jsx)("div",{className:"col col-5 left",children:Object(x.jsx)("i",{className:"bi ".concat(t.iconClassName)})}),Object(x.jsxs)("div",{className:"col right flex-column justify-content-center",children:[Object(x.jsxs)("div",{className:"text-center",children:[Object(x.jsx)("div",{children:"Current status:"}),Object(x.jsx)("div",{className:t.valueClassName,children:t.valueTitle})]}),Object(x.jsxs)("div",{className:"text-center mt-3 w-100",children:[Object(x.jsxs)("div",{children:["Battery Level: ",Object(x.jsx)("span",{className:"status ".concat(n.stateClassName),children:n.valueTitle})]}),Object(x.jsx)("div",{className:"progress mt-3",children:Object(x.jsx)("div",{className:"progress-bar ".concat(n.stateClassName),role:"progressbar",style:{width:"".concat(n.valuePercents,"%")}})}),Object(x.jsx)("div",{className:"battery-icon",children:Object(x.jsx)("i",{className:"bi bi-battery-half ".concat(n.stateClassName)})})]})]})]})},bleBeacon:function(e){var t,n,r="1"===(null===(t=e.device.zespInfo.Report.ble_InRange)||void 0===t?void 0:t.parsed),a=null===(n=e.device.zespInfo.Report.ble_signal_level)||void 0===n?void 0:n.parsed,o=Math.max(e.device.zespInfo.Report.ble_InRange.time,e.device.zespInfo.Report.ble_signal_level.time),i=new Date(o),l=function(){return Math.round((Date.now()-o)/1e3)},d=Object(c.useState)(l()),u=Object(s.a)(d,2),b=u[0],j=u[1];Object(c.useEffect)((function(){var e=setInterval((function(){j(l())}),1e3);return function(){clearInterval(e)}}),[o]);var m=b<300?"status-primary":"status-unknown",p=r?"status-primary":"status-unknown";return Object(x.jsxs)("div",{className:"row custom-layout",children:[Object(x.jsxs)("div",{className:"col col-5 left flex-column position-relative",children:[Object(x.jsx)("i",{className:"bi bi-wifi ".concat(p)}),Object(x.jsx)("div",{className:"icon-description ".concat(p),children:r?"In range":"Out of range"})]}),Object(x.jsxs)("div",{className:"col right flex-column justify-content-center",children:[Object(x.jsxs)("div",{className:"text-center",children:[Object(x.jsx)("div",{children:"Signal level:"}),Object(x.jsx)("div",{className:"status ".concat(p),children:Object(x.jsx)(ve,{children:a})})]}),Object(x.jsxs)("div",{className:"text-center mt-3",children:[Object(x.jsx)("div",{children:"Last update:"}),Object(x.jsxs)("div",{className:"status ".concat(m),children:[i.toLocaleDateString()," ",i.toLocaleTimeString()]}),Object(x.jsx)("div",{className:"small text-muted opacity-50",children:b<60?"".concat(b," seconds ago"):b/60<60?"".concat(Math.round(b/60)," minutes ago"):"".concat(Math.round(b/60/60)," hours ago")})]})]})]})}},Be=[function(e){var t=Me.getReport(ze,e),n=Me.getReport(Ee,e);if(t&&n&&Me.roleDeviceClassIs(["battery"],n)&&Me.roleDeviceClassIs(["door","motion"],t))return console.debug("Auto detected layout 'binarySensorLayout' for '".concat(e.IEEE,"'")),"binarySensorLayout"},function(e){if("BED"===e.DevType&&"beacon"===e.class){var t=Me.getReport(["ble_InRange"],e),n=Me.getReport(["ble_signal_level"],e);if(t&&n)return"bleBeacon"}}],Me={autoDetect:function(e){var t,n=Object(ce.a)(Be);try{for(n.s();!(t=n.n()).done;){var c=(0,t.value)(e);if(c)return c}}catch(r){n.e(r)}finally{n.f()}},roleDeviceClassIs:function(e,t){var n=t.role&&t.role.split("&");if(n.length<2)return!1;var c=JSON.parse(n[1]).device_class;return!!c&&e.indexOf(c)>=0},getReport:function(e,t){var n,c=Object(ce.a)(e);try{for(c.s();!(n=c.n()).done;){var r=n.value,a=t.Report[r];if(a)return a}}catch(o){c.e(o)}finally{c.f()}}},Ae={getDevicesListAsync:function(e){return new Promise((function(t,n){e.zespRequestAsync({data:"getDeviceList",responseValidator:ee("alldev")}).then((function(e){var n=Ve(e);t({devices:n,zespVersion:e.dataParts.length>1?e.dataParts[1]:void 0})})).catch((function(e){return n(e)}))}))}},Ve=function(e){var t=e.dataParts[0],n=[];return Object.assign(n,JSON.parse(t)),n.map(Je)},Ue=function(e){var t=ne.find((function(t){return t.modelIds.findIndex((function(t){return t===e}))>=0}))||{};return{settings:t,controls:(null===t||void 0===t?void 0:t.controls)&&n(325)("./".concat(t.controls))||[]}},Je=function(e){var t=Ue(e.ModelId),n=t.settings,c=t.controls;c.forEach((function(t){if(t.reportKey){var n=t.reportKey.endpoint+t.reportKey.clusterId+t.reportKey.attributeId;e.Report[n]||(e.Report[n]={})}}));var r=n.layout||Me.autoDetect(e);return{zespInfo:e,settings:Object(T.a)(Object(T.a)({},n),{layout:r}),customLayout:c}},Ze=Ae,Ke={zespFirmwareUpdateInfo:void 0,zespFirmwareInstalledVersion:"-",zespSkipVersion:void 0},qe=Object(j.b)({name:"zespFirmwareUpdate",initialState:Ke,reducers:{setZespFirmwareUpdate:function(e,t){e.zespFirmwareUpdateInfo=t.payload},setZespFirmwareInstalledVersion:function(e,t){e.zespFirmwareInstalledVersion=t.payload}}}),We=function(e){return e.zespFirmware.zespFirmwareUpdateInfo},He=function(e){return e.zespFirmware.zespFirmwareInstalledVersion},Ge=qe.actions,Qe=Ge.setZespFirmwareUpdate,Ye=Ge.setZespFirmwareInstalledVersion,$e=qe.reducer,Xe=function(e){return new Promise((function(t,n){e.zespRequestAsync({data:"get_Mi_lamp",responseValidator:ee("Mi_lamp")}).then((function(e){var c=et(e);c?t(c):n("Cannot update root device information")})).catch((function(e){return n(e)}))}))},et=function(e){var t,n,c,r,a,o,s,i=Ue("ZESP_Root").controls;if(0==i.length)return{};var l=JSON.parse(e.dataParts[0]),d={},u=null===(t=i.find((function(e){return"on_off_root"===e.id})))||void 0===t?void 0:t.reportKey;u?d[u.endpoint+u.clusterId+u.attributeId]={val:l.on.toString()}:console.warn("Root device report 'on_off_root' not found");var b=null===(n=i.find((function(e){return"level_root"===e.id})))||void 0===n?void 0:n.reportKey;b?d[b.endpoint+b.clusterId+b.attributeId]={val:l.level.toString()}:console.warn("Root device report 'level_root' not found");var j=null===(c=i.find((function(e){return"rgb_root"===e.id})))||void 0===c?void 0:c.reportKey;j?d[j.endpoint+j.clusterId+j.attributeId]={val:"".concat(l.B,":").concat(l.G,":").concat(l.R)}:console.warn("Root device report 'rgb_root' not found");var m=null===(r=i.find((function(e){return"level_control"===e.id})))||void 0===r?void 0:r.reportKey;m?d[m.endpoint+m.clusterId+m.attributeId]={val:l.sound.volume.toString()}:console.warn("Root device report 'level_control' not found");var p=null===(a=i.find((function(e){return"player_src_root"===e.id})))||void 0===a?void 0:a.reportKey;p?d[p.endpoint+p.clusterId+p.attributeId]={val:null===(o=l.sound.current_path)||void 0===o?void 0:o.toString()}:console.warn("Root device report 'player_src_root' not found");var f=null===(s=i.find((function(e){return"player_control_root"===e.id})))||void 0===s?void 0:s.reportKey;return f?d[f.endpoint+f.clusterId+f.attributeId]={val:l.sound.play.toString()}:console.warn("Root device report 'player_control_root' not found"),d};var tt=function(e){var t=e.zespRequestAsync,n=e.zespSend,c=function(e,t){var c="/".concat(e,".json"),r=JSON.stringify(t);n({data:"SaveJson|".concat(c,"|").concat(r)})};return{getAsync:function(){return new Promise((function(e,n){t({data:"loadConfig",responseValidator:ee("jsconfig")}).then((function(e){return function(e){var t=JSON.parse(e),n={};return Object.assign(n,t),n}(e.dataParts[0])})).then((function(t){return e(t)})).catch((function(e){return n(e)}))}))},setAsync:function(e){var n=["SaveJson","/jsconfig.txt",JSON.stringify(e)].join("|");return new Promise((function(e,c){t({data:n,responseValidator:ee("ZD_RSP")}).then((function(t){"ok"===t.dataParts[1].toLocaleLowerCase()?e():c("Settings was not saved: ".concat(t.response))})).catch((function(e){return c(e)}))}))},getCustomAsync:function(e){return t({data:"LoadJson|/".concat(e,".json"),responseValidator:X(e)}).then((function(e){if(e.dataParts.length<1)throw new Error("Unexpected JSON file response from ZESP");var t=e.dataParts[1];if(t&&0!==t.length&&"null"!==t.trim().toLocaleLowerCase())return JSON.parse(t)}))},setCustom:c,setUiSettings:function(e){c("zesp_ui",e)}}},nt=function(e){return e.zespRequestAsync({data:"loadfwlist",responseValidator:ee("rsploadfwlist"),timeoutSeconds:15}).then((function(e){if(e.dataParts.length<2)throw Error("Unexpected zesp firmware information response");var t=JSON.parse(e.dataParts[0]),n=e.dataParts[1];if(!t||0===t.length)throw Error("Unexpected zesp firmware udpates response");if(!n||0===n.length)throw Error("Unexpected zesp current version response");return{currentVersion:n,updatesInformation:t[0]}}))},ct={},rt={zespSettings:void 0,uiSettings:void 0},at=Object(j.b)({name:"settings",initialState:rt,reducers:{setZespSettings:function(e,t){e.zespSettings=t.payload},setUiSettings:function(e,t){e.uiSettings=t.payload}}}),ot=function(e){return e.settings.zespSettings},st=function(e){return e.settings.uiSettings},it=at.actions,lt=it.setZespSettings,dt=it.setUiSettings,ut=at.reducer,bt=function(e,t){e.subscribe(ee("rep"),(function(e){return jt(e,t)}))},jt=function(e,t){if(e.dataParts.length<2)return console.warn("Unknown format of updated received"),void console.warn(e.response);var n=e.dataParts[1],c=JSON.parse(e.dataParts[0]);t(n,c.EndPoint+c.ClusterId+c.AttribId,{parsed:c.parsed,val:c.Data,time:c.time})},mt=function(e,t){var n=Object(c.useRef)({});return{connectAsync:function(n){return t.connectAsync(n,(function(t){return e(Q(t))}),!1)},getDevices:function(){return Ze.getDevicesListAsync(t).then((function(t){e(U(t.devices)),t.zespVersion&&e(Ye(t.zespVersion))}))},getRoot:function(){return Xe(t).then((function(t){e(Z(t)),console.debug("Root device reports updated")}))},readUiSettings:function(){return tt(t).getCustomAsync("zesp_ui").then((function(t){var c=t||ct;e(dt(c)),n.current=c}))},readFirmwareUpdates:function(){var c=n.current;if(!c)throw new Error("Read UI settings before firmware checking");return c.firmwareUpdate&&c.firmwareLastCheck&&Date.now()-c.firmwareLastCheck<864e5?(e(Qe(c.firmwareUpdate)),console.debug("Firmware information read from settings"),Promise.resolve()):(nt(t).then((function(c){e(Ye(c.currentVersion)),e(Qe(c.updatesInformation)),n.current=Object(T.a)(Object(T.a)({},n.current),{firmwareUpdate:c.updatesInformation,firmwareLastCheck:Date.now()}),tt(t).setCustom("zesp_ui",n.current),e(dt(n.current)),console.debug("Firmware updates information loaded")})).catch((function(e){console.warn("Cannot read Firmware update information"),console.warn(e)})),Promise.resolve())},subscribeReportUpdates:function(){return bt(t,(function(t,n,c){return e(J({ieee:t,reportKey:n,update:c}))})),Promise.resolve()}}},pt=n(169),ft={ConnectionStartTimeout:100,RestartConnectionTimeout:5e3,DefaultRequestTimeoutSeconds:5,WatcherIntervalSeconds:15},vt=n(40),Ot=n(51),ht=n(55),gt=n(174),xt="zesp-data-received",yt=function(e){Object(Ot.a)(n,e);var t=Object(ht.a)(n);function n(e,c,r){var a;return Object(vt.a)(this,n),(a=t.call(this,xt)).dataType=void 0,a.response=void 0,a.dataParts=void 0,a.dataType=e,a.dataParts=c,a.response=r,a}return n}(Object(gt.a)(Event)),wt=function(){var e,t=new EventTarget,n=void 0,c=Date.now(),r=void 0,a=function(e,n){c=Date.now();var r=n.data.replace(/\|(?=([^"]*"[^"]*")*[^"]*$)/gi,"\0").split("\0");if(0!=r.length){var a=r.shift();/\/(.+)\.json/gi.exec(a)&&(r.unshift(a),a="json");var o=new yt(a,r,n.data);t.dispatchEvent(o)}else console.warn("Received empty message from zesp")},o=function e(t){return r&&(console.debug("Stop old watcher"),clearInterval(r)),console.debug("Start watcher"),r=setInterval((function(){var a,o;1===(null===(a=n)||void 0===a||null===(o=a.underlyingWebsocket)||void 0===o?void 0:o.readyState)&&((Date.now()-c)/1e3>ft.WatcherIntervalSeconds&&(c=Date.now()+1e3*ft.DefaultRequestTimeoutSeconds,r&&clearInterval(r),i({data:"LoadJson|/ping.json",responseValidator:te}).then((function(){return e(t)})).catch((function(){return t("reconnect")}))))}),5e3),Promise.resolve()},s=function(e){if(n){var t=!0===e.isBinary?function(e){var t,n=null===(t=e.replaceAll(" ","").match(/[\da-f]{2}/gi))||void 0===t?void 0:t.map((function(e){return parseInt(e,16)}));return new Uint8Array(n)}(e.data):e.data;n.send(t)}else console.warn("WebSocket client is not initialized yet")},i=function(e){return new Promise((function(n,c){(!e.timeoutSeconds||e.timeoutSeconds<=0)&&(e.timeoutSeconds=ft.DefaultRequestTimeoutSeconds),!0!==e.isBinary&&(e.isBinary=!1);var r=!1,a=e.responseValidator,o=function e(c){var o=c;a.isValid(o)&&(r=!0,t.removeEventListener(xt,e),n(o))};try{t.addEventListener(xt,o),s({data:e.data,isBinary:e.isBinary}),setTimeout((function(){r||(t.removeEventListener(xt,o),console.warn("zesp response did not received (timeout: ".concat(e.timeoutSeconds," seconds)")),c("timeout"))}),1e3*e.timeoutSeconds)}catch(i){c("exception: ".concat(i))}}))};return{connectAsync:function(t,c,r){return e=t,new Promise((function(t,s){if(console.debug("Start WS connection..."),!r){var i,l,d,u;if(0===(null===(i=n)||void 0===i||null===(l=i.underlyingWebsocket)||void 0===l?void 0:l.readyState))return void s("Already connecting");if(1===(null===(d=n)||void 0===d||null===(u=d.underlyingWebsocket)||void 0===u?void 0:u.readyState))return console.debug("ZESP already connected, skip connection"),void t()}!function(){if(n)try{return n.close(1e3),!0}catch(e){}}(),function(t){return new Promise((function(c,r){var o="https:"===document.location.protocol?"wss":"ws",s="".concat(o,"://").concat(e.address,":81");console.debug("Create connection to ".concat(s)),n=new pt.WebsocketBuilder(s).onOpen((function(){console.debug("ZESP connected"),t("connected"),c()})).onClose((function(){console.debug("ZESP connection closed"),t("closed"),r("ZESP connection closed")})).onError((function(){return r("ZESP connection error")})).onMessage(a).build()}))}(c).then((function(){return o(c)})).then(t).catch(s)}))},zespSend:s,zespRequestAsync:i,subscribe:function(e,n){var c=function(t){var c=t;e.isValid(c)&&n(c)};return t.addEventListener(xt,c),c},unsubscribe:function(e){return t.removeEventListener(xt,e)},getServerAddress:function(){var t;return null===(t=e)||void 0===t?void 0:t.address}}},Nt=r.a.createContext(wt()),St=function(e){var t=e.server,n=e.children,r=Object(b.b)(),a=Object(b.c)(W),o=Object(c.useState)(Object(c.useContext)(Nt)),i=Object(s.a)(o,2),l=i[0],d=i[1],u=Object(c.useRef)(void 0);Object(c.useEffect)((function(){"reconnect"===a&&(d(wt()),r(Q("disconnected"))),console.log("ZESP agent status: ".concat(a))}),[a]);var j=mt(r,l),m=j.connectAsync,p=j.getDevices,f=j.getRoot,v=j.readUiSettings,O=j.readFirmwareUpdates,h=j.subscribeReportUpdates;return"connected"===a?Object(x.jsx)(Nt.Provider,{value:l,children:n}):("closed"===a&&(u.current&&(clearTimeout(u.current),u.current=void 0),u.current=setTimeout((function(){"closed"===a?r(Q("reconnect")):console.debug("Cancel restarting, cause status: ".concat(a))}),ft.RestartConnectionTimeout)),"disconnected"!==a||(r(Q("connecting")),m(t).then(p).then(f).then(v).then(O).then(h).then((function(){return r(Y(!0))})).catch((function(e){return console.error(e)})).finally((function(){d(l),console.debug("ZESP initialization completed")}))),Object(x.jsx)(c.Fragment,{}))},It=function(e){var t=Object(E.a)("pages.devices").t,n=e.devices;return Object(x.jsxs)("div",{className:"group border-top pt-4",children:[Object(x.jsxs)("div",{className:"title h5 pb-3",children:[Object(x.jsx)("span",{children:t("groups.all")}),n.length>1&&Object(x.jsx)("span",{className:"badge bg-secondary ms-2",children:n.length})]}),Object(x.jsx)(k.a,{className:"items",children:n.map((function(e,t){return Object(x.jsx)(z,{device:e},t)}))})]})},kt=function(e,t){return"ZESP_Root"===e.zespInfo.ModelId?-1:"ZESP_Root"===t.zespInfo.ModelId?1:e.zespInfo.ModelId<t.zespInfo.ModelId?-1:e.zespInfo.ModelId>t.zespInfo.ModelId?1:0},_t=function(e,t){var n=e.zespInfo.Name&&e.zespInfo.Name.length>0?e.zespInfo.Name:e.zespInfo.ModelId,c=Ct(e,t),r=zt(e.zespInfo.Report,e.zespInfo.DevType);return{title:n,ieee:e.zespInfo.IEEE,image:c,tags:r}},Ct=function(e,t){var n;if(null===(n=e.settings)||void 0===n?void 0:n.image)return"".concat(".","/device-images/").concat(e.settings.image);if(e.zespInfo.Img)return"http://".concat(t,":8081/").concat(e.zespInfo.Img);var c=e.zespInfo.ModelId;return"http://".concat(t,":8081/img/").concat(c,".jpg")},zt=function(e,t){for(var n=[],c=function(){var e=a[r],c=P(e,t);if(!c)return console.warn("Cannot read report '".concat(e,"' details for '").concat(t,"' device type")),"continue";var o=F.find((function(e){return e.clusterId===c.clusterId}));n.push((null===o||void 0===o?void 0:o.name)||c.clusterId)},r=0,a=Object.keys(e);r<a.length;r++)c();return n.filter((function(e,t){return n.indexOf(e)==t})).sort((function(e,t){return e>t?1:-1}))},Et=function(){var e=Object(c.useContext)(Nt).getServerAddress,t=Object(b.c)(A,(function(e,t){return e.length===t.length}));if(0==t.length)return Object(x.jsx)("div",{children:"No devices found..."});console.debug("Building list of devices to show...");var n=e()||"/",r=Object(S.a)(t).sort(kt).map((function(e){return _t(e,n)}));return console.debug("devices page updated..."),Object(x.jsx)(N,{children:Object(x.jsx)("div",{className:"devices",children:Object(x.jsx)(I.a,{children:Object(x.jsx)(I.a.Body,{children:Object(x.jsx)(It,{devices:r})})})})})},Ft=n(355),Tt=n(358),Rt=n(172),Pt=function(e,t,n,c){return new Promise((function(r,a){t||a("Settings not loaded"),n(O(!0));var o=Object(T.a)(Object(T.a)({},t),e);c(o).then((function(){n(lt(o)),r(),w.b.success("Settings updated")})).catch((function(e){w.b.error("Cannot save: ".concat(e)),a(e)})).finally((function(){return n(O(!1))}))}))},Dt=function(){var e=Object(b.b)(),t=Object(c.useContext)(Nt),n=Object(b.c)(ot),r=tt(t).getAsync;return Object(c.useEffect)((function(){e(O(!0)),r().then((function(t){e(lt(t))})).catch((function(e){alert(e)})).finally((function(){return e(O(!1))}))}),[]),n?Object(x.jsx)(N,{children:Object(x.jsx)(Ft.a,{className:"p-0",children:Object(x.jsxs)(Tt.a,{variant:"pills",children:[Object(x.jsx)(Tt.a.Item,{children:Object(x.jsx)(i.b,{className:"nav-link",to:"/setup",exact:!0,children:"Wifi client"})}),Object(x.jsx)(Tt.a.Item,{children:Object(x.jsx)(i.b,{className:"nav-link",to:"/setup/zigbee",children:"Zigbee"})}),Object(x.jsx)(Tt.a.Item,{children:Object(x.jsx)(i.b,{className:"nav-link",to:"/setup/mqtt",children:"MQTT client"})}),Object(x.jsx)(Tt.a.Item,{children:Object(x.jsx)(i.b,{className:"nav-link",to:"/setup/telegram",children:"Telegram bot"})}),Object(x.jsx)(Tt.a.Item,{children:Object(x.jsx)(i.b,{className:"nav-link",to:"/setup/z2m",children:"Z2M client"})}),Object(x.jsx)(Tt.a.Item,{children:Object(x.jsx)(i.b,{className:"nav-link",to:"/setup/firmware",children:"Firmware manager"})}),Object(x.jsx)(Tt.a.Item,{className:"ms-auto",children:Object(x.jsxs)(i.b,{className:"nav-link",to:"/setup/zesp-ui",children:[Object(x.jsx)(Rt.a,{style:{marginTop:"-3px"}})," ZESP:UI"]})})]})})}):Object(x.jsx)(c.Fragment,{})},Lt=(n(341),function(e){var t=e.device.zespInfo.Name||e.device.zespInfo.ModelId,n=e.groups.length>1?"with-tabs":"",c=e.groups.length>1?Object(x.jsx)("ul",{className:"nav nav-tabs",children:e.groups.map((function(n,c){return Object(x.jsx)("li",{className:"nav-item",children:Object(x.jsx)("button",{type:"button",className:"btn btn-light nav-link ".concat(e.activeGroupName===n.name?"active":""),onClick:function(){return e.setActiveGroupName(n.name)},children:"main"===n.name?t:n.name})},c)}))}):Object(x.jsx)("div",{children:t});return Object(x.jsxs)(d.a.Header,{className:n,children:[Object(x.jsx)("div",{children:c}),Object(x.jsxs)("div",{className:"text-end modal-right-buttons",children:[e.onDetailsClicked&&Object(x.jsx)("button",{type:"button",className:"btn",onClick:e.onDetailsClicked,children:Object(x.jsx)("i",{className:"bi bi-three-dots-vertical"})}),Object(x.jsx)("span",{className:"border-end ms-2 me-3"}),Object(x.jsx)("button",{type:"button",className:"btn-close me-1","aria-label":"Close",onClick:e.onCloseClicked})]})]})}),Bt=function(e){var t,n=e.groups.find((function(t){return t.name===e.activeGroupName}));if(!n)return Object(x.jsxs)("div",{children:["Group '",e.activeGroupName,"' not found."]});var c={device:e.device,settings:n.settings},r=(null===(t=e.device.settings)||void 0===t?void 0:t.layout)||"default",a=Le[r]||Ce;return Object(x.jsx)(d.a.Body,{className:"text-start device-dialog p-4",children:Object(x.jsx)(a,Object(T.a)({},c))})},Mt=function(){var e=Object(l.g)();return Object(c.useEffect)((function(){e.push("/devices"),w.b.error("Device information not found")}),[]),Object(x.jsx)(x.Fragment,{})},At=function(){var e=Object(l.h)().ieee,t=Object(c.useState)(!0),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(l.g)(),i=Object(b.c)((function(t){return M(t,e)}),(function(e,t){if(!e||!t)return!1;var n=Object.keys(e.zespInfo.Report),c=Object.keys(t.zespInfo.Report);if(n.length!=c.length)return!1;for(var r=0,a=n;r<a.length;r++){var o=a[r];if(e.zespInfo.Report[o]!==t.zespInfo.Report[o])return!1}return!0}));if(!i)return Object(x.jsx)(Mt,{});var u=R(i);if(!u||0===u.length)return console.warn("No controls found for '".concat(i.zespInfo.IEEE,"' device")),Object(x.jsx)(Mt,{});var j=Object(c.useState)(u[0].name),m=Object(s.a)(j,2),p=m[0],f=m[1],v=function(){return a(!1)};return Object(x.jsxs)(d.a,{show:r,onHide:v,onExited:function(){return setTimeout((function(){return o.push("/devices")}),100)},children:[Object(x.jsx)(Lt,{groups:u,device:i,activeGroupName:p,setActiveGroupName:f,onCloseClicked:v,onDetailsClicked:function(){console.log(i),w.b.success("Check console for logs",{icon:"\ud83d\udc7d"})}}),Object(x.jsx)(Bt,{groups:u,device:i,activeGroupName:p})]})},Vt=n(6),Ut=n(359),Jt=n(36),Zt=n.n(Jt),Kt={handleSubmit:function(e,t){e.preventDefault();var n,c={},r=Object(ce.a)(Zt()(e.target).find("input"));try{for(r.s();!(n=r.n()).done;){var a=n.value,o=Zt()(a).prop("id");if(null==o)return;"checkbox"===Zt()(a).prop("type")?!0===Zt()(a).prop("checked")?c[o]=Zt()(a).attr("checked_value")||"true":c[o]=Zt()(a).attr("unchecked_value")||"false":c[o]=Zt()(a).val()}}catch(s){r.e(s)}finally{r.f()}t(c)}},qt=["onSubmit"],Wt=function(e){var t=e.onSubmit,n=Object(Vt.a)(e,qt);return Object(x.jsx)(Ut.a,Object(T.a)(Object(T.a)({onSubmit:function(e){return Kt.handleSubmit(e,t)}},n),{},{children:e.children}))},Ht=["getDeviceList","get_Mi_lamp","LoadJson|/location.json","LoadJson|/groups.json","LoadJson|/zesp_ui.json"],Gt=["01 0000 01 0100","01 0000 01 0000"],Qt=function(){var e=Object(c.useContext)(Nt),t=e.zespSend,n=e.subscribe,r=e.unsubscribe,a=Object(c.useState)([]),o=Object(s.a)(a,2),i=o[0],l=o[1],d=Object(c.useState)(""),u=Object(s.a)(d,2),b=u[0],j=u[1],m=Object(c.useState)(!1),p=Object(s.a)(m,2),f=p[0],v=p[1],O=Object(c.useState)(!0),h=Object(s.a)(O,2),g=h[0],y=h[1],w=Object(c.useRef)(i),k=Object(c.useRef)(f),_=Object(c.useRef)(g),C=function(e){if(!k.current&&(!_.current||!e.startsWith("rep|")&&!e.startsWith("ArBle|"))){var t=[e.substr(0,500)].concat(Object(S.a)(w.current)),n=t.length-15;n>0&&t.splice(t.length-n,n),w.current=t,l(t)}},z=function(e){var t=e.target.innerText;j(t)},E=function(e){t({data:e||b,isBinary:!0})};return Object(c.useEffect)((function(){var e=n(te,(function(e){var t=e.response;C(t)}));return function(){return r(e)}}),[]),Object(x.jsxs)(N,{children:[Object(x.jsx)(Wt,{onSubmit:function(e){e.messageToSend&&(C(">".concat(e.messageToSend)),t({data:e.messageToSend}))},children:Object(x.jsxs)(I.a,{children:[Object(x.jsx)(I.a.Header,{children:"WebSocket tester (FOR DEVELOPMENT ONLY)"}),Object(x.jsxs)(I.a.Body,{children:[Object(x.jsxs)("div",{className:"row mb-2",children:[Object(x.jsx)("label",{className:"col-md-3 col-lg-2",children:"Message to send"}),Object(x.jsx)("div",{className:"col",children:Object(x.jsx)("input",{type:"text",className:"form-control",id:"messageToSend",value:b,onChange:function(e){return j(e.target.value)}})})]}),Object(x.jsxs)("div",{className:"row",children:[Object(x.jsx)("div",{className:"col-md-3 col-lg-2"}),Object(x.jsxs)("div",{className:"col",children:[Object(x.jsx)("div",{children:Ht.map((function(e,t){return Object(x.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-primary me-1",onClick:z,children:e},t)}))}),Object(x.jsx)("div",{className:"mt-1",children:Gt.map((function(e,t){return Object(x.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-secondary me-1",onClick:function(){j(e),E(e)},children:e},t)}))})]})]})]}),Object(x.jsxs)(I.a.Footer,{children:[Object(x.jsx)(ae.a,{variant:"primary",type:"submit",children:"Send message"}),Object(x.jsx)(ae.a,{variant:"secondary",type:"button",onClick:function(){return E()},className:"ms-2",children:"Send binary"})]})]})}),Object(x.jsxs)(I.a,{className:"mt-4",children:[Object(x.jsxs)(I.a.Header,{children:[Object(x.jsxs)("span",{children:["Communication log ",Object(x.jsx)("span",{className:"badge bg-secondary small",children:i.length})]}),Object(x.jsx)("button",{className:"btn btn-outline-secondary ms-3 btn-sm",onClick:function(){w.current=[],l([])},children:"Clear log"}),Object(x.jsx)("button",{className:"btn btn-outline-secondary ms-3 btn-sm",onClick:function(){return function(){var e=!k.current;k.current=e,v(e)}()},children:f?"Start logs":"Pause logs"}),Object(x.jsx)("button",{className:"btn btn-outline-".concat(g?"secondary":"info"," ms-3 btn-sm float-end"),onClick:function(){return function(){var e=!_.current;_.current=e,y(e)}()},children:g?"REPs disabled":"REPs enabled"})]}),Object(x.jsx)(I.a.Body,{children:i.map((function(e,t){return e.startsWith(">")?Object(x.jsx)("div",{className:"px-2 mb-3 py-1 m-1 bg-success bg-opacity-25 rounded",children:e.substr(1)},t):Object(x.jsx)("div",{className:"border-start mb-3 border-3 border-warning p-0 d-flex flex-wrap",children:e.split("|").map((function(e,t){return Object(x.jsx)("span",{className:"bg-warning bg-opacity-25 m-1 px-2 rounded",children:e},t)}))},t)}))})]})]})},Yt=function(e){var t=e.controlId,n=e.label,c=e.placeholder,r=e.defaultValue,a=e.type,o={placeholder:c,type:void 0===a?"text":a};return r&&(o=Object(T.a)(Object(T.a)({},o),{defaultValue:r.toString()})),Object(x.jsxs)(Ut.a.Group,{as:k.a,className:"mb-3",controlId:t,children:[Object(x.jsx)(Ut.a.Label,{column:!0,md:"3",lg:"2",children:n}),Object(x.jsx)(C.a,{children:Object(x.jsx)(Ut.a.Control,Object(T.a)({},o))})]})},$t=function(e){var t=e.controlId,n=e.label,c=e.defaultChecked,r=e.checkedValue,a=void 0===r?"true":r,o=e.uncheckedValue,s="true"===c||"1"===c||1===c||!0===c||!1,i={checked_value:a,unchecked_value:void 0===o?"false":o};return c&&(i=Object(T.a)(Object(T.a)({},i),{defaultChecked:s})),Object(x.jsx)(Ut.a.Group,{controlId:t,className:"d-inline-block",children:Object(x.jsxs)(Ut.a.Label,{className:"d-flex",children:[Object(x.jsx)(Ut.a.Check,Object(T.a)({className:"pe-2"},i)),Object(x.jsx)("span",{children:n})]})})},Xt=function(){var e,t=Object(b.b)(),n=Object(c.useContext)(Nt),r=tt(n),a=Object(b.c)(ot),o=Object(E.a)(["pages.setup-mqtt","common"]).t;if(!a)return Object(x.jsx)("div",{children:"No settings found..."});var s=a.MQTT;return Object(x.jsx)(N,{children:Object(x.jsx)(I.a,{children:Object(x.jsxs)(Wt,{onSubmit:function(e){return Pt({MQTT:e},a,t,r.setAsync)},children:[Object(x.jsxs)(I.a.Body,{children:[Object(x.jsx)(Yt,{controlId:"mqttup",defaultValue:s.mqttup,label:o("topic.label"),placeholder:o("topic.placeholder")}),Object(x.jsx)(Yt,{controlId:"mqtt",defaultValue:s.mqtt,label:o("server.label"),placeholder:o("server.placeholder")}),Object(x.jsx)(Yt,{controlId:"mqttPort",defaultValue:null===(e=s.mqttPort)||void 0===e?void 0:e.toString(),label:o("port.label"),placeholder:o("port.placeholder")}),Object(x.jsx)(Yt,{controlId:"mqttLogin",defaultValue:s.mqttLogin,label:o("login.label"),placeholder:o("login.placeholder")}),Object(x.jsx)(Yt,{type:"password",controlId:"mqttPassw",defaultValue:s.mqttPassw,label:o("password.label"),placeholder:o("password.placeholder")}),Object(x.jsxs)(k.a,{children:[Object(x.jsx)(C.a,{md:"3",lg:"2"}),Object(x.jsxs)(C.a,{className:"space-between-4",children:[Object(x.jsx)($t,{controlId:"mqttEnable",defaultChecked:s.mqttEnable,label:o("is_enabled.label"),checkedValue:1,uncheckedValue:0}),Object(x.jsx)($t,{controlId:"Home_Assistant",defaultChecked:s.Home_Assistant,label:o("is_ha_enabled.label"),checkedValue:1,uncheckedValue:0})]})]})]}),Object(x.jsx)(I.a.Footer,{children:Object(x.jsx)(ae.a,{variant:"primary",type:"submit",children:o("common:save_button")})})]})})})},en=function(){return Object(x.jsx)(N,{children:Object(x.jsx)("div",{className:"px-4 py-5 bg-light rounded-3",children:Object(x.jsxs)("div",{className:"container-fluid",children:[Object(x.jsx)("h1",{className:"display-5 fw-bold",children:"Not implemented yet!"}),Object(x.jsxs)("p",{className:"col-md-8 fs-4",children:["Hello, my dear friend! Just imagine how awesome this feature can be and share it with developers ~_~ ",Object(x.jsx)("br",{}),Object(x.jsx)("br",{}),"Or you can even implement it yourself, everything you need is just to jump to source codes, made some magic, test it and that's it!"]}),Object(x.jsx)("hr",{className:"my-4"}),Object(x.jsxs)("p",{children:["This feature is under contruction. You can find latest verion on ",Object(x.jsx)("a",{href:"#",children:"github project page"})," or just click this big blue button bellow."]}),Object(x.jsx)("a",{href:"#",target:"_blank",rel:"noreferrer",className:"btn btn-primary btn-lg",type:"button",children:"Learn more"})]})})})},tn=function(){var e=Object(b.b)(),t=Object(c.useContext)(Nt),n=tt(t),r=Object(b.c)(ot),a=Object(E.a)(["pages.setup-wifi","common"]).t;if(!r)return Object(x.jsx)(c.Fragment,{});var o=r.Wifi;return Object(x.jsx)(c.Fragment,{children:Object(x.jsx)(N,{children:Object(x.jsx)(Wt,{onSubmit:function(t){return Pt({Wifi:t},r,e,n.setAsync)},children:Object(x.jsxs)(I.a,{children:[Object(x.jsxs)(I.a.Body,{children:[Object(x.jsx)(Yt,{controlId:"ssid",defaultValue:null===o||void 0===o?void 0:o.ssid,label:a("ssid.label"),placeholder:a("ssid.placeholder")}),Object(x.jsx)(Yt,{type:"password",controlId:"pass",defaultValue:null===o||void 0===o?void 0:o.pass,label:a("pass.label"),placeholder:a("pass.placeholder")}),Object(x.jsx)(Yt,{controlId:"ip",defaultValue:null===o||void 0===o?void 0:o.ip,label:a("ip.label"),placeholder:a("ip.placeholder")}),Object(x.jsx)(Yt,{controlId:"mask",defaultValue:null===o||void 0===o?void 0:o.mask,label:a("mask.label"),placeholder:a("mask.placeholder")}),Object(x.jsx)(Yt,{controlId:"gw",defaultValue:null===o||void 0===o?void 0:o.gw,label:a("gw.label"),placeholder:a("gw.placeholder")})]}),Object(x.jsx)(I.a.Footer,{children:Object(x.jsx)(ae.a,{variant:"primary",type:"submit",children:a("common:save_button")})})]})})})})},nn=function(){var e=Object(b.c)(H),t=Object(b.b)();return e?(setTimeout((function(){return t(O(!1))}),300),Object(x.jsxs)(c.Fragment,{children:[Object(x.jsx)(l.b,{exact:!0,path:"/",children:Object(x.jsx)(l.a,{to:"/devices"})}),Object(x.jsx)(l.b,{path:"/devices",component:Et}),Object(x.jsx)(l.b,{path:"/devices/:ieee",component:At}),Object(x.jsx)(l.b,{path:"/setup",component:Dt}),Object(x.jsx)(l.b,{exact:!0,path:"/setup",component:tn}),Object(x.jsx)(l.b,{path:"/setup/mqtt",component:Xt}),Object(x.jsx)(l.b,{path:"/setup/zigbee",component:en}),Object(x.jsx)(l.b,{path:"/setup/telegram",component:en}),Object(x.jsx)(l.b,{path:"/setup/z2m",component:en}),Object(x.jsx)(l.b,{path:"/setup/zesp-ui",component:en}),Object(x.jsx)(l.b,{path:"/setup/firmware",component:en}),Object(x.jsx)(l.b,{path:"/socket-test",component:Qt})]})):(setTimeout((function(){return t(O(!0))}),0),Object(x.jsx)(c.Fragment,{}))},cn=(n(117),function(e){var t=Object(E.a)("pages.welcome").t,n=e.servers.map((function(e,t){return{server:e,index:t}})).sort((function(e,t){return e.server.name>t.server.name?1:-1}));return Object(x.jsx)("div",{className:"container welcome-page h-100",children:Object(x.jsx)(N,{className:"fullscreen",children:Object(x.jsxs)(I.a,{className:"text-start",children:[Object(x.jsx)(I.a.Header,{children:t("list.title")}),Object(x.jsxs)(I.a.Body,{children:[0==e.servers.length&&Object(x.jsx)("div",{children:t("list.add_message")}),e.servers.length>0&&Object(x.jsx)("nav",{className:"servers-list",children:n.map((function(t,n){return Object(x.jsxs)("div",{className:"item",children:[Object(x.jsxs)(i.b,{className:"server-button",to:"/",onClick:function(n){e.openServerAction(t.index),n.preventDefault()},activeClassName:"none",children:[Object(x.jsx)("i",{className:"bi bi-caret-right-fill"})," ",t.server.name]}),Object(x.jsx)("button",{type:"button",onClick:function(){return e.openEditAction(t.server)},className:"edit-button",children:Object(x.jsx)("i",{className:"bi bi-pencil-fill"})})]},"item-".concat(n))}))})]}),Object(x.jsx)(I.a.Footer,{className:"text-right",children:Object(x.jsx)("button",{type:"button",onClick:e.openAddServer,className:"btn btn-primary",children:t("list.add_button")})})]})})})}),rn=n(173),an=n(362),on=n(356),sn=function(e){var t,n,r=Object(E.a)("pages.welcome").t,a=Object(c.useState)(!1),o=Object(s.a)(a,2),i=o[0],l=o[1],d=Object(x.jsxs)(rn.a,{id:"popover-basic",children:[Object(x.jsx)(rn.a.Header,{as:"h3",children:r("edit.delete_title")}),Object(x.jsx)(rn.a.Body,{children:Object(x.jsx)("span",{dangerouslySetInnerHTML:{__html:r("edit.delete_message")}})})]});return Object(x.jsx)("div",{className:"container welcome-page h-100",children:Object(x.jsx)(N,{children:Object(x.jsx)(Wt,{onSubmit:function(t){return e.editServer?e.updateAction(t):e.addAction(t),Promise.resolve()},children:Object(x.jsxs)(I.a,{className:"text-start",children:[Object(x.jsxs)(I.a.Header,{className:"d-flex justify-content-between",children:[Object(x.jsx)("span",{className:"modal-title",children:r("edit.title")}),Object(x.jsx)("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:e.closeAction})]}),Object(x.jsxs)(I.a.Body,{children:[Object(x.jsx)(le.a,{className:"mb-2",id:"name",defaultValue:null===(t=e.editServer)||void 0===t?void 0:t.name,placeholder:r("edit.name_input_placeholder")}),Object(x.jsxs)(an.a,{children:[Object(x.jsxs)(an.a.Text,{id:"basic-addon3",children:["https:"===document.location.protocol?"wss":"ws","://"]}),Object(x.jsx)(le.a,{id:"address",defaultValue:null===(n=e.editServer)||void 0===n?void 0:n.address,"aria-describedby":"basic-addon3",placeholder:r("edit.address_input_placeholder")})]})]}),e.editServer&&Object(x.jsxs)(I.a.Footer,{className:"d-flex justify-content-between",children:[Object(x.jsx)("div",{children:Object(x.jsx)(on.a,{trigger:"click",placement:"top",overlay:d,rootClose:!0,onToggle:l,children:Object(x.jsx)("button",{onClick:function(){i&&e.deleteAction()},type:"button",className:"btn btn-outline-danger",children:r("edit.delete_button")})})}),Object(x.jsx)("button",{type:"submit",className:"btn btn-primary",children:r("edit.save_button")})]}),!e.editServer&&Object(x.jsx)(I.a.Footer,{className:"text-right",children:Object(x.jsx)("button",{type:"submit",className:"btn btn-primary",children:r("edit.add_button")})})]})})})})},ln=function(e){var t=Object(c.useState)("welcome"),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(c.useState)(),i=Object(s.a)(o,2),l=i[0],d=i[1],u=je("servers",[]),b=Object(s.a)(u,2),j=b[0],m=b[1],p=function(){d(void 0),a("welcome")};return"edit"===r?Object(x.jsx)(sn,{editServer:l,addAction:function(e){j.push(e),m(j),p()},updateAction:function(e){var t=j.indexOf(l);j[t]=e,m(j),console.log(j),p()},closeAction:p,deleteAction:function(){m(j.filter((function(e){return e!==l}))),p()}}):Object(x.jsx)(cn,{servers:j,openAddServer:function(){d(void 0),a("edit")},openEditAction:function(e){d(e),a("edit")},openServerAction:function(t){return e.setServerIndex(t)}})},dn=(n(342),function(){var e=Object(b.c)(He);return Object(x.jsx)("footer",{className:"app-footer my-3",children:Object(x.jsxs)("div",{className:"d-flex justify-content-center",children:[Object(x.jsx)("div",{children:Object(x.jsxs)("a",{href:"https://github.com/NickRimmer/zesp-ui",target:"_blank",rel:"noreferrer",children:["ZESP UI",Object(x.jsx)("i",{className:"bi bi-github ms-2"})]})}),Object(x.jsx)("div",{className:"mx-3 border-start opacity-25"}),Object(x.jsxs)("div",{children:["UI ",Object(x.jsx)("span",{className:"highlight",children:"0.0.1 alfa"})]}),Object(x.jsx)("div",{className:"mx-3 border-start opacity-25"}),Object(x.jsxs)("div",{children:[Object(x.jsx)("a",{href:"https://t.me/zesp32",target:"_blank",rel:"noreferrer",children:"ZESP"})," ",Object(x.jsx)("span",{className:"highlight",children:e})]})]})})}),un=(n(343),n(344),function(e){var t=e.children,n=e.show,r=e.title,a=e.setShow,o=e.footer,i=Object(c.useState)(n),l=Object(s.a)(i,2),u=l[0],b=l[1];Object(c.useEffect)((function(){n&&b(!0)}),[n]);var j=function(){return a(!1)};return u?Object(x.jsxs)(d.a,{show:n,onExited:function(){return b(!1)},onHide:j,children:[Object(x.jsxs)(d.a.Header,{children:[Object(x.jsx)("div",{children:r}),Object(x.jsx)("div",{className:"text-end modal-right-buttons",children:Object(x.jsx)("button",{type:"button",className:"btn-close me-1","aria-label":"Close",onClick:j})})]}),Object(x.jsx)(d.a.Body,{className:"text-start",children:t}),o&&Object(x.jsx)(d.a.Footer,{children:o})]}):Object(x.jsx)(c.Fragment,{})}),bn=function(){var e=Object(c.useState)(!1),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(c.useContext)(Nt).zespSend,o=Object(b.b)(),i=Object(x.jsx)("span",{className:"nav-link clickable",onClick:function(){return r(!0)},children:Object(x.jsx)("i",{className:"bi bi-power"})}),l=Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(ae.a,{onClick:function(){o(h({show:!0,message:"Restarting, please wait..."})),r(!1),a({data:"RebootESP"})},children:"Restart ZESP"}),Object(x.jsx)(ae.a,{onClick:function(){o(h({show:!0,message:"Shutting down..."})),r(!1),setTimeout((function(){return document.location.href="/"}),2e3),a({data:"Shutdown"})},variant:"secondary",children:"Shutdown"})]});return Object(x.jsxs)(x.Fragment,{children:[i,Object(x.jsxs)(un,{title:"Power management",show:n,setShow:r,footer:l,children:[Object(x.jsx)("div",{className:"mb-3",children:"Restart of ZESP service can take a few minutes. This page will be reloaded automatically when restart completed."}),Object(x.jsx)("div",{children:"To shutdown, just click Shutdown button. But this is way with one direction, make sure you know what are you doing."})]})]})},jn=function(){var e=Object(E.a)("nav").t;return Object(x.jsxs)("nav",{className:"nav nav-masthead justify-content-center pe-2",children:[Object(x.jsx)(i.b,{className:"nav-link",to:"/devices",children:e("devices")}),!1,Object(x.jsx)(i.b,{className:"nav-link",to:"/setup",children:e("setup")}),Object(x.jsx)("div",{className:"border-start mx-3 opacity-25"}),Object(x.jsx)(bn,{})]})},mn=function(e){var t=e.onClosed,n=e.zespFirmwareUpdate,r=e.zespFirmwareCurrentVersion,a=Object(c.useState)(!0),o=Object(s.a)(a,2),i=o[0],l=o[1],u=Object(b.b)(),j=Object(c.useContext)(Nt),m=tt(j),p=Object(b.c)(st),f=n.ver||"unknown",v=function(){return l(!1)},O=Object(T.a)(Object(T.a)(Object(T.a)({},{"Current version":r}),{"New version":f}),Object(T.a)(Object(T.a)({},n),{ver:void 0}));return Object(x.jsxs)(d.a,{show:i,onExited:t,onHide:v,children:[Object(x.jsxs)(d.a.Header,{children:[Object(x.jsx)("div",{children:"New version of ZESP Firmware"}),Object(x.jsx)("div",{className:"text-end modal-right-buttons",children:Object(x.jsx)("button",{type:"button",className:"btn-close me-1","aria-label":"Close",onClick:v})})]}),Object(x.jsx)(d.a.Body,{className:"text-start",children:Object(x.jsx)("div",{className:"rows-striped",children:Object.keys(O).map((function(e,t){return O[e]&&O[e].trim().length>0&&Object(x.jsxs)(k.a,{children:[Object(x.jsx)(C.a,{xs:4,className:"py-2 text-capitalize text-muted text-end",children:e}),Object(x.jsx)(C.a,{className:"py-2 text-dark",children:O[e]})]},t)}))})}),Object(x.jsxs)(d.a.Footer,{children:[Object(x.jsx)("button",{className:"btn btn-primary",onClick:function(){w.b.success("Not implemented yet...",{icon:Object(x.jsx)("i",{className:"bi bi-cone-striped text-warning"})})},children:"Download and Update"}),Object(x.jsx)("button",{className:"btn btn-secondary",onClick:function(){var e=Object(T.a)(Object(T.a)({},p||{}),{firmwareSkipUpdate:f});u(dt(e)),m.setUiSettings(e),w.b.success("Notification for this version disabled",{icon:Object(x.jsx)("i",{className:"bi bi-bell-slash-fill text-success"})})},children:"Skip this version"})]})]})},pn=function(){var e=Object(b.c)(We),t=Object(b.c)(He),n=Object(b.c)(st),r=Object(c.useState)(!1),a=Object(s.a)(r,2),o=a[0],i=a[1];if(!e||e.ver===t||(null===n||void 0===n?void 0:n.firmwareSkipUpdate)===e.ver)return Object(x.jsx)(c.Fragment,{});var l="".concat(t," to ").concat(e.ver," update");return Object(x.jsxs)("div",{children:[Object(x.jsx)("span",{onClick:function(){i(!0)},className:"badge bg-info ms-3 notification-updates clickable",title:l,children:Object(x.jsx)("i",{className:"bi bi-cloud-arrow-down-fill"})}),o&&Object(x.jsx)(mn,{onClosed:function(){return i(!1)},zespFirmwareUpdate:e,zespFirmwareCurrentVersion:t})]})},fn=function(){return Object(x.jsxs)("header",{className:"app-header",children:[Object(x.jsx)("a",{href:"/",children:Object(x.jsx)("h3",{className:"title",children:"ZESP:UI"})}),Object(x.jsxs)("div",{className:"d-flex flex-row align-items-center",children:[Object(x.jsx)(jn,{}),Object(x.jsx)(pn,{})]})]})},vn=function(){var e=Object(c.useState)(null),t=Object(s.a)(e,2),n=t[0],r=t[1],a=window.localStorage.getItem("servers"),o=a&&JSON.parse(a)||[],i=null===n||o.length<=n?null:o[n];return i?Object(x.jsx)(On,{server:i}):Object(x.jsx)(ln,{setServerIndex:r})},On=function(e){return Object(x.jsx)(St,{server:e.server,children:Object(x.jsxs)("div",{className:"container-md d-flex w-100 h-100 p-3 mx-auto flex-column",children:[Object(x.jsx)(fn,{}),Object(x.jsx)("main",{role:"main",className:"text-start d-flex flex-grow-1 flex-column",children:Object(x.jsx)(nn,{})}),Object(x.jsx)(dn,{})]})})},hn=function(){return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(i.a,{children:Object(x.jsx)(l.d,{children:Object(x.jsx)(vn,{})})}),Object(x.jsx)(y,{}),Object(x.jsx)(w.a,{})]})},gn=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,363)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),c(e),r(e),a(e),o(e)}))},xn=Object(j.a)({reducer:{zesp:$,devices:K,spinner:g,settings:ut,zespFirmware:$e}});o.a.render(Object(x.jsx)(r.a.StrictMode,{children:Object(x.jsx)(b.a,{store:xn,children:Object(x.jsx)(hn,{})})}),document.getElementById("root")),gn()},85:function(e){e.exports=JSON.parse('[{"clusterId":"0000","name":"Basic"},{"clusterId":"0006","name":"On/Off","attributes":{"0000:light":{"id":"on_off_toggle","arguments":{"commandOn":"01 {device} 01 01","commandOff":"01 {device} 01 00","commandToggle":"01 {device} 01 02"}}}},{"clusterId":"0008","name":"Level","attributes":{"0000:light":{"id":"level_control","arguments":{"command":"MoveToLevel|{device}|1|01|1|{value}|0001|0","min":0,"max":255}}}},{"clusterId":"0106","name":"Illuminance"},{"clusterId":"0300","name":"Color","attributes":{"0007:light":{"id":"level_control","arguments":{"command":"MoveToColorTemp|{device}|1|01|{value}|0001","min":100,"max":600}}}},{"clusterId":"0406","name":"Occupancy"},{"clusterId":"BBBB","name":"Custom"},{"clusterId":"ble_InRange","name":"In range"},{"clusterId":"ble_signal_level","name":"Signal level"}]')},98:function(e,t,n){"use strict";n.r(t);var c=n(94),r=n(58),a=["en"],o=["common","nav","pages.setup-mqtt","pages.setup-wifi","pages.welcome","pages.devices"];c.a.use(r.e).init({fallbackLng:a[0],lng:a[0],resources:function(){for(var e={},t=0,c=a;t<c.length;t++){var r=c[t];e[r]={};for(var s=0,i=o;s<i.length;s++){var l=i[s],d="./locales/".concat(r,"/").concat(l.replace(".","/"),".json");try{e[r][l]=n(202)(""+d),console.debug("".concat(d," (ok)"))}catch(u){console.debug("".concat(d," (error)"))}}}return e}(),ns:o,defaultNS:"common"}),c.a.languages=a,t.default=c.a}},[[345,1,2]]]);
//# sourceMappingURL=main.47e99c38.chunk.js.map