(this["webpackJsonpzesp-ui-app"]=this["webpackJsonpzesp-ui-app"]||[]).push([[0],{103:function(e,t,n){},104:function(e,t,n){window.$=window.jQuery=n(22),console.debug=function(){console.log("Debug logs are disabled")}},126:function(e,t,n){var c={"./config":69,"./config.js":69,"./locales/en/common":76,"./locales/en/common.json":76,"./locales/en/nav":77,"./locales/en/nav.json":77,"./locales/en/pages/devices":78,"./locales/en/pages/devices.json":78,"./locales/en/pages/setup-mqtt":79,"./locales/en/pages/setup-mqtt.json":79,"./locales/en/pages/setup-wifi":80,"./locales/en/pages/setup-wifi.json":80,"./locales/en/pages/welcome":81,"./locales/en/pages/welcome.json":81};function s(e){var t=a(e);return n(t)}function a(e){if(!n.o(c,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return c[e]}s.keys=function(){return Object.keys(c)},s.resolve=a,e.exports=s,s.id=126},127:function(e,t,n){},128:function(e,t,n){},129:function(e,t,n){},143:function(e,t,n){},152:function(e,t,n){},153:function(e,t,n){},156:function(e,t,n){"use strict";n.r(t);var c,s,a,r,o=n(0),i=n.n(o),l=n(20),d=n.n(l),u=(n(103),n(104),n(105),n(69),n(2)),b=n(6),j=n(11),p=n(10),m=(n(127),n(128),n(170)),h=(n(129),n(1)),f=function(){var e=Object(m.a)("nav").t;return Object(h.jsxs)("nav",{className:"nav nav-masthead justify-content-center",children:[Object(h.jsx)(j.b,{className:"nav-link",to:"/",exact:!0,children:e("home")}),Object(h.jsx)(j.b,{className:"nav-link",to:"/devices",children:e("devices")}),!1,Object(h.jsx)(j.b,{className:"nav-link",to:"/setup",children:e("setup")})]})},v=n(22),O=n.n(v),g=(n(143),n(161)),x=Object(o.createContext)({state:{},setState:{}}),w=function(e){var t=e.children,n=e.value,c=void 0===n?{}:n;Object.assign(c,{spinnerLoadingShow:!1,zespConnected:!1,appInitialized:!1,zespSettings:void 0,selectedServerIndex:null,devices:[]});var s=Object(o.useState)(c),a=Object(b.a)(s,2),r=a[0],i=a[1];return Object(h.jsx)(x.Provider,{value:{state:r,setState:i},children:t})},y=function(){var e=Object(o.useContext)(x);if(!e)throw new Error("useGlobalState must be used within a GlobalStateContext");return e},S=function(){return y().state.spinnerLoadingShow?(setTimeout((function(){return O()(".loading-overlay").removeClass("hidden")}),0),Object(h.jsx)("div",{className:"loading-overlay hidden",children:Object(h.jsx)(g.a,{animation:"border",variant:"light"})})):Object(h.jsx)(o.Fragment,{})},N=n(90),_={ConnectionStartTimeout:500,VerifyConnectionTimeout:5e3,DefaultRequestTimeoutSeconds:5},I=n(29),k=n(38),C=n(41),E=n(98),T="zesp-data-received",A=function(e){Object(k.a)(n,e);var t=Object(C.a)(n);function n(e,c,s){var a;return Object(I.a)(this,n),(a=t.call(this,T)).dataType=void 0,a.response=void 0,a.dataParts=void 0,a.dataType=e,a.dataParts=c,a.response=s,a}return n}(Object(E.a)(Event));!function(e){e[e.Restart=1012]="Restart"}(c||(c={}));var z,P,L,V,q=new EventTarget,Z={connectAsync:function(e,t){return new Promise((function(n,c){return a&&r?(console.warn("ZespConnector already initialized"),void n(L.ZespConnector)):(a=e,r=t,setTimeout((function(){return Z.reconnectAsync(!0).then((function(){return n(L.ZespConnector)})).catch((function(e){a.setState((function(e){return Object(u.a)(Object(u.a)({},e),{zespConnected:!1})})),c(e)}))}),_.ConnectionStartTimeout),z=setInterval((function(){return Z.reconnectAsync(!1).then((function(){return n(L.ZespConnector)})).catch((function(e){console.warn("Reconnection is failed: ".concat(e)),a.setState((function(e){return Object(u.a)(Object(u.a)({},e),{zespConnected:!1})})),c(e)}))}),_.VerifyConnectionTimeout),Z)}))},disconnect:function(){z&&(clearInterval(z),z=null),r=null,a.setState((function(e){return Object(u.a)(Object(u.a)({},e),{zespConnected:!1})}));try{var e,t,n,c,o,i,l;if(3===(null===(e=s)||void 0===e||null===(t=e.underlyingWebsocket)||void 0===t?void 0:t.readyState)||null==(null===(n=s)||void 0===n||null===(c=n.underlyingWebsocket)||void 0===c?void 0:c.readyState))return void console.debug("zesp connection already closed");if(1===(null===(o=s)||void 0===o||null===(i=o.underlyingWebsocket)||void 0===i?void 0:i.readyState))return console.debug("zesp connection closing..."),void s.close(1e3);null===(l=s)||void 0===l||l.close(1e3)}catch(d){}},reconnectAsync:function(e){return new Promise((function(t,n){var o,i,l,d;if(a||n("ZespConnector is not initialized yet"),r||n("Server configuration missed"),0!==(null===(o=s)||void 0===o||null===(i=o.underlyingWebsocket)||void 0===i?void 0:i.readyState))if(1!==(null===(l=s)||void 0===l||null===(d=l.underlyingWebsocket)||void 0===d?void 0:d.readyState)||e){console.debug("Start ws connection...");try{s.close(c.Restart)}catch(j){}a.setState((function(e){return Object(u.a)(Object(u.a)({},e),{zespConnected:!1})}));var b="https:"===document.location.protocol?"wss":"ws";s=new N.WebsocketBuilder("".concat(b,"://").concat(r.address,":81")).onOpen((function(){M(),t()})).onClose(D).onError((function(){F(),n("zesp connection error")})).onMessage(J).build()}else t();else n("Already connecting")}))},send:function(e){if(!a)throw new Error("ZespConnector is not initialized yet");s.send(e)},requestAsync:function(e){var t=e.data,n=e.responseValidator,c=e.timeoutSeconds;return new Promise((function(e,s){(!c||c<=0)&&(c=_.DefaultRequestTimeoutSeconds);var a=!1,r=n,o=function t(n){var c=n;r.isValid(c)&&(a=!0,q.removeEventListener(T,t),e(c))};try{q.addEventListener(T,o),Z.send(t),setTimeout((function(){a||(q.removeEventListener(T,o),console.warn("zesp response did not received (timeout: ".concat(c," seconds)")),s("timeout"))}),1e3*c)}catch(i){s("exception: ".concat(i))}}))},request:function(e){return new Promise((function(t,n){Z.requestAsync(e).then((function(n){e.onSuccess?e.onSuccess(n):console.debug("zesp request completed (".concat(e.responseValidator.name,")")),t(L.ZespConnector)})).catch((function(t){var c="".concat(t," (").concat(e.responseValidator.name,"; ").concat(e.data,")");e.onError?e.onError(c):console.warn("zesp request failed: ".concat(c)),n(c)}))}))},subscribe:function(e,t){var n=function(n){var c=n;e.isValid(c)&&t(c)};return q.addEventListener(T,n),n},unsubscribe:function(e){return q.removeEventListener(T,e)},getGlobalState:function(){return a}},M=function(){console.debug("Zesp connection opened"),a.setState((function(e){return Object(u.a)(Object(u.a)({},e),{zespConnected:!0})}))},D=function(){console.debug("Zesp connection closed"),a.setState((function(e){return Object(u.a)(Object(u.a)({},e),{zespConnected:!1})}))},F=function(){console.debug("Zesp connection error happened )=")},J=function(e,t){var n=t.data.replace(/\|(?=([^"]*"[^"]*")*[^"]*$)/gi,"\0").split("\0");if(0!=n.length){var c=n.shift();/\/(.+)\.json/gi.exec(c)&&(n.unshift(c),c="json");var s=new A(c,n,t.data);q.dispatchEvent(s)}else console.warn("Received empty message from zesp")},B=Z,R={init:function(e){P?console.warn("Loader spinner already initialized"):P=e},show:function(){return W(!0)},hide:function(){return W(!1)}},W=function(e){return P.setState((function(t){return Object(u.a)(Object(u.a)({},t),{spinnerLoadingShow:e})}))};(V=L||(L={})).ZespConnector=B,V.ZespConnectorPromise=new Promise((function(e){return e(L.ZespConnector)})),V.Spinner=R;var H=function e(t){return{name:e.name,isValid:function(e){if("json"!==e.dataType)return!1;var n=e.dataParts[0];return/\/(.+)\.json/gi.exec(n)[1]===t}}},Q=function e(t){return{name:e.name,isValid:function(e){return e.dataType===t}}},G={name:"AllZespResponseValidator",isValid:function(e){return!0}},U=n(91),Y=n(92),$={requestData:function(e){return e.request({data:"getDeviceList",responseValidator:Q("alldev"),onSuccess:function(t){return K(t,e.getGlobalState())}})}},K=function(e,t){var n=e.dataParts[0],c=[];Object.assign(c,JSON.parse(n));for(var s=function(){var e=r[a];e.templateInfo=Y.find((function(t){return t.modelIds.findIndex((function(t){return t===e.ModelId}))>=0}));for(var t=0,n=Object.keys(e.Report);t<n.length;t++){var c=n[t];e.Report[c].reportIdInfo={p1:c.substr(0,2),deviceId:c.substr(2,4),command:c.substr(6),name:X(c.substr(2,4))}}},a=0,r=c;a<r.length;a++)s();t.setState((function(e){return Object(u.a)(Object(u.a)({},e),{devices:c})}))},X=function(e){var t=U[e];return null!==t&&void 0!==t?t:"unknown"},ee=$,te=!1;function ne(e){console.log("groups received")}function ce(e){console.log("locations received")}function se(e){console.log("MI Lamp data received")}function ae(e){console.log("Device update received: ".concat(e.dataParts[1]))}var re={initAsync:function(e){return new Promise((function(e,t){if(te)return console.warn("zesp service already initialized"),void e();te=!0,console.debug("Load initial data from zesp..."),L.ZespConnectorPromise.then((function(e){return e.request({data:"LoadJson|/groups.json",responseValidator:H("groups"),onSuccess:ne})})).then((function(e){return e.request({data:"LoadJson|/location.json",responseValidator:H("location"),onSuccess:ce})})).then((function(e){return e.request({data:"get_Mi_lamp",responseValidator:Q("Mi_lamp"),onSuccess:se})})).then(ee.requestData).then((function(e){return e.subscribe(Q("rep"),ae)})).then((function(){return e()})).catch((function(e){console.error("Cannot complete zesp service initialization: ".concat(e)),t(e)}))}))},ping:function(){return e="ping",L.ZespConnector.send(e);var e}},oe={getAsync:function(){return new Promise((function(e,t){L.ZespConnector.requestAsync({data:"loadConfig",responseValidator:Q("jsconfig")}).then((function(e){return function(e){var t=JSON.parse(e),n={};return Object.assign(n,t),n}(e.dataParts[0])})).then((function(t){return e(t)})).catch((function(e){return t(e)}))}))},setAsync:function(e){var t=["SaveJson","/jsconfig.txt",JSON.stringify(e)].join("|");return new Promise((function(e,n){L.ZespConnector.requestAsync({data:t,responseValidator:Q("ZD_RSP")}).then((function(t){"ok"===t.dataParts[1].toLocaleLowerCase()?e():n("Settings was not saved: ".concat(t.response))})).catch((function(e){return n(e)}))}))}},ie=n(52),le=function(e){return Object(h.jsx)("div",{className:"cover text-center d-flex content-light align-self-center flex-grow-1 align-items-center",children:Object(h.jsx)("div",{className:"",children:e.children})})},de=(n(152),function(e){var t=Object(o.useState)("show-transition hidden"),n=Object(b.a)(t,2),c=n[0],s=n[1];return setTimeout((function(){return s("show-transition")}),0),Object(h.jsx)("div",{className:c,children:e.children})}),ue=function(){return Object(h.jsx)(le,{children:Object(h.jsxs)(de,{children:[Object(h.jsx)("h1",{className:"cover-heading",children:"Quite soon, here will be useful info"}),Object(h.jsx)("p",{className:"lead",children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam ultricies ipsum porttitor, aliquet enim eu, congue nulla. Nulla luctus ante sit amet sodales convallis. Aliquam lectus nisl, semper eget aliquam et, malesuada ut orci."}),Object(h.jsx)("p",{className:"lead",children:Object(h.jsx)("a",{href:"https://t.me/zesp32",target:"_blank",rel:"noreferrer",className:"btn btn-lg btn-secondary",children:"Get more"})})]})})},be=(n(153),n(169)),je=function(e){var t,n=(t=e.device).templateInfo?t.templateInfo.image:"zigbee.png",c="/device-images/".concat(n);return Object(h.jsx)("div",{className:"item-image",style:{backgroundImage:"url(".concat(c,")")}})};var pe=function(e){for(var t=e.device.Name&&e.device.Name.length>0?e.device.Name:e.device.ModelId,n="/devices/".concat(e.device.IEEE,"-").concat(e.device.Device),c=[],s=0,a=Object.keys(e.device.Report);s<a.length;s++){var r=a[s];c.push(e.device.Report[r].reportIdInfo.name)}return c=c.filter((function(e,t){return"unknown"!==e&&c.indexOf(e)==t})).sort((function(e,t){return e>t?1:-1})),Object(h.jsx)(j.b,{className:"item p-3 border rounded",to:n,children:Object(h.jsxs)("div",{className:"d-flex",children:[Object(h.jsx)("div",{children:Object(h.jsx)(je,{device:e.device})}),Object(h.jsxs)("div",{className:"ps-2",children:[Object(h.jsx)("div",{className:"title",children:t}),Object(h.jsxs)("div",{className:"ieee text-muted small",children:[Object(h.jsx)("span",{className:"badge bg-info me-1",children:e.device.Device}),e.device.IEEE]}),c.length>0&&Object(h.jsx)("div",{className:"badges small",children:c.map((function(e,t){return Object(h.jsx)("span",{className:"badge bg-secondary",children:e},t)}))})]})]})})},me=function(e){return 0==e.devices.length?Object(h.jsx)(o.Fragment,{}):Object(h.jsxs)("div",{className:"group border-top pt-4",children:[Object(h.jsxs)("div",{className:"title h5 pb-3",children:[e.title," ",Object(h.jsx)("span",{className:"badge bg-secondary",children:e.devices.length})]}),Object(h.jsx)("div",{className:"items d-flex flex-wrap",children:e.devices.map((function(e,t){return Object(h.jsx)(pe,{device:e},t)}))})]})},he=function(){var e=y(),t=Object(m.a)("pages.devices").t;if(!e.state.devices||0==e.state.devices.length)return Object(h.jsx)("div",{children:"No devices found..."});var n=e.state.devices,c=n.findIndex((function(e){return"0000"===e.Device})),s=n[c],a=(n=n.filter((function(e){return e!=s}))).filter((function(e){var t;return"light"===(null===(t=e.templateInfo)||void 0===t?void 0:t.group)})),r=n.filter((function(e){var t;return"sensor"===(null===(t=e.templateInfo)||void 0===t?void 0:t.group)})),o=n.filter((function(e){var t;return"switch"===(null===(t=e.templateInfo)||void 0===t?void 0:t.group)})),i=n.filter((function(e){return!a.includes(e)&&!r.includes(e)&&!o.includes(e)}));return Object(h.jsx)(de,{children:Object(h.jsx)("div",{className:"devices",children:Object(h.jsx)(be.a,{children:Object(h.jsxs)(be.a.Body,{children:[Object(h.jsxs)("div",{className:"group",children:[Object(h.jsx)("div",{className:"title h5 pb-3",children:t("groups.hub")}),Object(h.jsx)("div",{className:"items d-flex flex-wrap",children:Object(h.jsx)(pe,{device:s})})]}),Object(h.jsx)(me,{title:t("groups.lights"),devices:a}),Object(h.jsx)(me,{title:t("groups.sensors"),devices:r}),Object(h.jsx)(me,{title:t("groups.switches"),devices:o}),Object(h.jsx)(me,{title:t("groups.other"),devices:i})]})})})})},fe=n(162),ve=n(167),Oe=n(96),ge=function(e,t,n){var c=Object(u.a)(Object(u.a)({},t.state.zespSettings),e),s=oe.setAsync(c).then((function(){return t.setState((function(e){return Object(u.a)(Object(u.a)({},e),{},{zespSettings:c})}))}));return ie.b.promise(s,{loading:n("common:saving_progress"),success:n("common:saving_success"),error:n("common:saving_error")}),s},xe=function(){var e=y();return Object(o.useEffect)((function(){L.Spinner.show(),oe.getAsync().then((function(t){e.setState((function(e){return Object(u.a)(Object(u.a)({},e),{zespSettings:t})})),L.Spinner.hide()})).catch((function(e){alert(e)}))}),[]),e.state.zespSettings?Object(h.jsxs)(de,{children:[Object(h.jsx)("div",{className:"aaa",children:"..."}),Object(h.jsx)(fe.a,{className:"p-0",children:Object(h.jsxs)(ve.a,{variant:"pills",children:[Object(h.jsx)(ve.a.Item,{children:Object(h.jsx)(j.b,{className:"nav-link",to:"/setup",exact:!0,children:"Wifi client"})}),Object(h.jsx)(ve.a.Item,{children:Object(h.jsx)(j.b,{className:"nav-link",to:"/setup/zigbee",children:"Zigbee settings"})}),Object(h.jsx)(ve.a.Item,{children:Object(h.jsx)(j.b,{className:"nav-link",to:"/setup/mqtt",children:"MQTT client"})}),Object(h.jsx)(ve.a.Item,{children:Object(h.jsx)(j.b,{className:"nav-link",to:"/setup/telegram",children:"Telegram bot"})}),Object(h.jsx)(ve.a.Item,{children:Object(h.jsx)(j.b,{className:"nav-link",to:"/setup/z2m",children:"Zigbee2MQTT client"})}),Object(h.jsx)(ve.a.Item,{className:"ms-auto",children:Object(h.jsxs)(j.b,{className:"nav-link",to:"/setup/zesp-ui",children:[Object(h.jsx)(Oe.a,{style:{marginTop:"-3px"}})," ZESP:UI"]})})]})})]}):Object(h.jsx)(o.Fragment,{})},we=n(166),ye=function(){var e=Object(p.g)(),t=e.ieee,n=e.device,c=Object(o.useState)(!0),s=Object(b.a)(c,2),a=s[0],r=s[1],i=Object(p.f)(),l=function(){return r(!1)};return Object(h.jsxs)(we.a,{show:a,onHide:l,onExited:function(){return setTimeout((function(){return i.push("/devices")}),100)},children:[Object(h.jsx)(we.a.Header,{closeButton:!0,children:"Not implemented yet"}),Object(h.jsxs)(we.a.Body,{children:[Object(h.jsxs)("p",{children:["Device: ",Object(h.jsxs)("span",{className:"badge bg-info",children:[t," (",n,")"]})]}),Object(h.jsxs)("p",{children:["Hello, my dear friend! Just imagine how awesome this feature can be and share it with developers ~_~ ",Object(h.jsx)("br",{}),"Or you can even implement it yourself, everything you need is just to jump to source codes, made some magic, test it and that's it!"]}),Object(h.jsx)("p",{children:Object(h.jsx)(j.b,{to:"/devices",onClick:function(e){e.preventDefault(),l()},children:"Go back for now"})})]})]})},Se=n(27),Ne=n(163),_e=n(3),Ie=n(168),ke=n(42),Ce={handleSubmit:function(e,t){e.preventDefault();var n,c={},s=Object(ke.a)(O()(e.target).find("input"));try{for(s.s();!(n=s.n()).done;){var a=n.value,r=O()(a).prop("id");if(null==r)return;"checkbox"===O()(a).prop("type")?!0===O()(a).prop("checked")?c[r]=O()(a).attr("checked_value")||"true":c[r]=O()(a).attr("unchecked_value")||"false":c[r]=O()(a).val()}}catch(o){s.e(o)}finally{s.f()}t(c)}},Ee=["onSubmit"],Te=function(e){var t=e.onSubmit,n=Object(_e.a)(e,Ee);return Object(h.jsx)(Ie.a,Object(u.a)(Object(u.a)({onSubmit:function(e){return Ce.handleSubmit(e,t)}},n),{},{children:e.children}))},Ae=["getDeviceList","get_Mi_lamp","LoadJson|/location.json","LoadJson|/groups.json"],ze=["01 0000 01 0100","01 0000 01 0000"],Pe=function(){var e=Object(o.useState)([]),t=Object(b.a)(e,2),n=t[0],c=t[1],s=Object(o.useState)(""),a=Object(b.a)(s,2),r=a[0],i=a[1],l=Object(o.useRef)(n),d=function(e){var t=[e.substr(0,250)].concat(Object(Se.a)(l.current)),n=t.length-15;n>0&&t.splice(t.length-n,n),l.current=t,c(t)},u=function(e){var t=e.target.innerText;i(t)},j=function(e){var t,n=(e||r).replaceAll(" ",""),c=null===(t=n.match(/[\da-f]{2}/gi))||void 0===t?void 0:t.map((function(e){return parseInt(e,16)})),s=new Uint8Array(c);d(">bin: ".concat(n," (").concat(s,")")),L.ZespConnector.send(s)};return Object(o.useEffect)((function(){var e=L.ZespConnector.subscribe(G,(function(e){var t=e.response;d(t)}));return function(){return L.ZespConnector.unsubscribe(e)}}),[]),Object(h.jsxs)(de,{children:[Object(h.jsx)(Te,{onSubmit:function(e){e.messageToSend&&(d(">".concat(e.messageToSend)),L.ZespConnector.send(e.messageToSend))},children:Object(h.jsxs)(be.a,{children:[Object(h.jsx)(be.a.Header,{children:"WebSocket tester (FOR DEVELOPMENT ONLY)"}),Object(h.jsxs)(be.a.Body,{children:[Object(h.jsxs)("div",{className:"row mb-2",children:[Object(h.jsx)("label",{className:"col-md-3 col-lg-2",children:"Message to send"}),Object(h.jsx)("div",{className:"col",children:Object(h.jsx)("input",{type:"text",className:"form-control",id:"messageToSend",value:r,onChange:function(e){return i(e.target.value)}})})]}),Object(h.jsxs)("div",{className:"row",children:[Object(h.jsx)("div",{className:"col-md-3 col-lg-2"}),Object(h.jsxs)("div",{className:"col",children:[Object(h.jsx)("div",{children:Ae.map((function(e,t){return Object(h.jsx)("button",{type:"submit",className:"btn btn-sm btn-outline-primary me-1",onClick:u,children:e},t)}))}),Object(h.jsx)("div",{className:"mt-1",children:ze.map((function(e,t){return Object(h.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-secondary me-1",onClick:function(){i(e),j(e)},children:e},t)}))})]})]})]}),Object(h.jsxs)(be.a.Footer,{children:[Object(h.jsx)(Ne.a,{variant:"primary",type:"submit",children:"Send message"}),Object(h.jsx)(Ne.a,{variant:"secondary",type:"button",onClick:function(){return j()},className:"ms-2",children:"Send binary"})]})]})}),Object(h.jsxs)(be.a,{className:"mt-4",children:[Object(h.jsxs)(be.a.Header,{children:[Object(h.jsxs)("span",{children:["Communication log ",Object(h.jsx)("span",{className:"badge bg-secondary small",children:n.length})]}),Object(h.jsx)("button",{className:"btn btn-outline-secondary ms-3 btn-sm",onClick:function(){l.current=[],c([])},children:"Clear log"})]}),Object(h.jsx)(be.a.Body,{children:n.map((function(e,t){return e.startsWith(">")?Object(h.jsx)("div",{className:"px-2 mb-3 py-1 m-1 bg-success bg-opacity-25 rounded",children:e.substr(1)},t):Object(h.jsx)("div",{className:"border-start mb-3 border-3 border-warning p-0 d-flex flex-wrap",children:e.split("|").map((function(e,t){return Object(h.jsx)("span",{className:"bg-warning bg-opacity-25 m-1 px-2 rounded",children:e},t)}))},t)}))})]})]})},Le=n(164),Ve=n(95),qe=function(e){var t=e.controlId,n=e.label,c=e.placeholder,s=e.defaultValue,a=e.type,r={placeholder:c,type:void 0===a?"text":a};return s&&(r=Object(u.a)(Object(u.a)({},r),{defaultValue:s.toString()})),Object(h.jsxs)(Ie.a.Group,{as:Le.a,className:"mb-3",controlId:t,children:[Object(h.jsx)(Ie.a.Label,{column:!0,md:"3",lg:"2",children:n}),Object(h.jsx)(Ve.a,{children:Object(h.jsx)(Ie.a.Control,Object(u.a)({},r))})]})},Ze=function(e){var t=e.controlId,n=e.label,c=e.defaultChecked,s=e.checkedValue,a=void 0===s?"true":s,r=e.uncheckedValue,o="true"===c||"1"===c||1===c||!0===c||!1,i={checked_value:a,unchecked_value:void 0===r?"false":r};return c&&(i=Object(u.a)(Object(u.a)({},i),{defaultChecked:o})),Object(h.jsx)(Ie.a.Group,{controlId:t,className:"d-inline-block",children:Object(h.jsxs)(Ie.a.Label,{className:"d-flex",children:[Object(h.jsx)(Ie.a.Check,Object(u.a)({className:"pe-2"},i)),Object(h.jsx)("span",{children:n})]})})},Me=function(){var e,t,n=y(),c=Object(m.a)(["pages.setup-mqtt","common"]).t,s=null===(e=n.state.zespSettings)||void 0===e?void 0:e.MQTT;if(!s)return Object(h.jsx)(o.Fragment,{});return Object(h.jsx)(de,{children:Object(h.jsx)(be.a,{children:Object(h.jsxs)(Te,{onSubmit:function(e){return ge({MQTT:e},n,c)},children:[Object(h.jsxs)(be.a.Body,{children:[Object(h.jsx)(qe,{controlId:"mqttup",defaultValue:s.mqttup,label:c("topic.label"),placeholder:c("topic.placeholder")}),Object(h.jsx)(qe,{controlId:"mqtt",defaultValue:s.mqtt,label:c("server.label"),placeholder:c("server.placeholder")}),Object(h.jsx)(qe,{controlId:"mqttPort",defaultValue:null===(t=s.mqttPort)||void 0===t?void 0:t.toString(),label:c("port.label"),placeholder:c("port.placeholder")}),Object(h.jsx)(qe,{controlId:"mqttLogin",defaultValue:s.mqttLogin,label:c("login.label"),placeholder:c("login.placeholder")}),Object(h.jsx)(qe,{type:"password",controlId:"mqttPassw",defaultValue:s.mqttPassw,label:c("password.label"),placeholder:c("password.placeholder")}),Object(h.jsxs)(Le.a,{children:[Object(h.jsx)(Ve.a,{md:"3",lg:"2"}),Object(h.jsxs)(Ve.a,{className:"space-between-4",children:[Object(h.jsx)(Ze,{controlId:"mqttEnable",defaultChecked:s.mqttEnable,label:c("is_enabled.label"),checkedValue:1,uncheckedValue:0}),Object(h.jsx)(Ze,{controlId:"Home_Assistant",defaultChecked:s.Home_Assistant,label:c("is_ha_enabled.label"),checkedValue:1,uncheckedValue:0})]})]})]}),Object(h.jsx)(be.a.Footer,{children:Object(h.jsx)(Ne.a,{variant:"primary",type:"submit",children:c("common:save_button")})})]})})})},De=function(){return Object(h.jsx)(de,{children:Object(h.jsx)("div",{className:"px-4 py-5 bg-light rounded-3",children:Object(h.jsxs)("div",{className:"container-fluid",children:[Object(h.jsx)("h1",{className:"display-5 fw-bold",children:"Not implemented yet!"}),Object(h.jsxs)("p",{className:"col-md-8 fs-4",children:["Hello, my dear friend! Just imagine how awesome this feature can be and share it with developers ~_~ ",Object(h.jsx)("br",{}),Object(h.jsx)("br",{}),"Or you can even implement it yourself, everything you need is just to jump to source codes, made some magic, test it and that's it!"]}),Object(h.jsx)("hr",{className:"my-4"}),Object(h.jsxs)("p",{children:["This feature is under contruction. You can find latest verion on ",Object(h.jsx)("a",{href:"#",children:"github project page"})," or just click this big blue button bellow."]}),Object(h.jsx)("a",{href:"#",target:"_blank",rel:"noreferrer",className:"btn btn-primary btn-lg",type:"button",children:"Learn more"})]})})})},Fe=function(){var e,t=y(),n=Object(m.a)(["pages.setup-wifi","common"]).t,c=null===(e=t.state.zespSettings)||void 0===e?void 0:e.Wifi;if(!c)return Object(h.jsx)(o.Fragment,{});return Object(h.jsx)(o.Fragment,{children:Object(h.jsx)(de,{children:Object(h.jsx)(Te,{onSubmit:function(e){return ge({Wifi:e},t,n)},children:Object(h.jsxs)(be.a,{children:[Object(h.jsxs)(be.a.Body,{children:[Object(h.jsx)(qe,{controlId:"ssid",defaultValue:null===c||void 0===c?void 0:c.ssid,label:n("ssid.label"),placeholder:n("ssid.placeholder")}),Object(h.jsx)(qe,{type:"password",controlId:"pass",defaultValue:null===c||void 0===c?void 0:c.pass,label:n("pass.label"),placeholder:n("pass.placeholder")}),Object(h.jsx)(qe,{controlId:"ip",defaultValue:null===c||void 0===c?void 0:c.ip,label:n("ip.label"),placeholder:n("ip.placeholder")}),Object(h.jsx)(qe,{controlId:"mask",defaultValue:null===c||void 0===c?void 0:c.mask,label:n("mask.label"),placeholder:n("mask.placeholder")}),Object(h.jsx)(qe,{controlId:"gw",defaultValue:null===c||void 0===c?void 0:c.gw,label:n("gw.label"),placeholder:n("gw.placeholder")})]}),Object(h.jsx)(be.a.Footer,{children:Object(h.jsx)(Ne.a,{variant:"primary",type:"submit",children:n("common:save_button")})})]})})})})},Je=function(){return Object(h.jsxs)(o.Fragment,{children:[Object(h.jsx)(p.a,{exact:!0,path:"/",component:ue}),Object(h.jsx)(p.a,{path:"/devices",component:he}),Object(h.jsx)(p.a,{path:"/devices/:ieee-:device",component:ye}),Object(h.jsx)(p.a,{path:"/setup",component:xe}),Object(h.jsx)(p.a,{exact:!0,path:"/setup",component:Fe}),Object(h.jsx)(p.a,{path:"/setup/mqtt",component:Me}),Object(h.jsx)(p.a,{path:"/setup/zigbee",component:De}),Object(h.jsx)(p.a,{path:"/setup/telegram",component:De}),Object(h.jsx)(p.a,{path:"/setup/z2m",component:De}),Object(h.jsx)(p.a,{path:"/setup/zesp-ui",component:De}),Object(h.jsx)(p.a,{path:"/socket-test",component:Pe})]})},Be=(n(70),function(e){var t=Object(m.a)("pages.welcome").t,n=e.servers.map((function(e,t){return{server:e,index:t}})).sort((function(e,t){return e.server.name>t.server.name?1:-1}));return Object(h.jsx)("div",{className:"container welcome-page h-100",children:Object(h.jsx)(de,{children:Object(h.jsxs)(be.a,{className:"text-start",children:[Object(h.jsx)(be.a.Header,{children:t("list.title")}),Object(h.jsxs)(be.a.Body,{children:[0==e.servers.length&&Object(h.jsx)("div",{children:t("list.add_message")}),e.servers.length>0&&Object(h.jsx)("nav",{className:"servers-list",children:n.map((function(t,n){return Object(h.jsxs)("div",{className:"item",children:[Object(h.jsxs)(j.b,{className:"server-button",to:"/",onClick:function(n){e.openServerAction(t.index),n.preventDefault()},activeClassName:"none",children:[Object(h.jsx)("i",{className:"bi bi-caret-right-fill"})," ",t.server.name]}),Object(h.jsx)("button",{type:"button",onClick:function(){return e.openEditAction(t.server)},className:"edit-button",children:Object(h.jsx)("i",{className:"bi bi-pencil-fill"})})]},"item-".concat(n))}))})]}),Object(h.jsx)(be.a.Footer,{className:"text-right",children:Object(h.jsx)("button",{type:"button",onClick:e.openAddServer,className:"btn btn-primary",children:t("list.add_button")})})]})})})}),Re=n(97),We=n(94),He=n(171),Qe=n(165),Ge=function(e){var t,n,c=Object(m.a)("pages.welcome").t,s=Object(o.useState)(!1),a=Object(b.a)(s,2),r=a[0],i=a[1],l=Object(h.jsxs)(Re.a,{id:"popover-basic",children:[Object(h.jsx)(Re.a.Header,{as:"h3",children:c("edit.delete_title")}),Object(h.jsx)(Re.a.Body,{children:Object(h.jsx)("span",{dangerouslySetInnerHTML:{__html:c("edit.delete_message")}})})]});return Object(h.jsx)("div",{className:"container welcome-page h-100",children:Object(h.jsx)(de,{children:Object(h.jsx)(Te,{onSubmit:function(t){return e.editServer?e.updateAction(t):e.addAction(t),Promise.resolve()},children:Object(h.jsxs)(be.a,{className:"text-start",children:[Object(h.jsxs)(be.a.Header,{className:"d-flex justify-content-between",children:[Object(h.jsx)("span",{className:"modal-title",children:c("edit.title")}),Object(h.jsx)("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:e.closeAction})]}),Object(h.jsxs)(be.a.Body,{children:[Object(h.jsx)(We.a,{className:"mb-2",id:"name",defaultValue:null===(t=e.editServer)||void 0===t?void 0:t.name,placeholder:c("edit.name_input_placeholder")}),Object(h.jsxs)(He.a,{children:[Object(h.jsxs)(He.a.Text,{id:"basic-addon3",children:["https:"===document.location.protocol?"wss":"ws","://"]}),Object(h.jsx)(We.a,{id:"address",defaultValue:null===(n=e.editServer)||void 0===n?void 0:n.address,"aria-describedby":"basic-addon3",placeholder:c("edit.address_input_placeholder")})]})]}),e.editServer&&Object(h.jsxs)(be.a.Footer,{className:"d-flex justify-content-between",children:[Object(h.jsx)("div",{children:Object(h.jsx)(Qe.a,{trigger:"click",placement:"top",overlay:l,rootClose:!0,onToggle:i,children:Object(h.jsx)("button",{onClick:function(){r&&e.deleteAction()},type:"button",className:"btn btn-outline-danger",children:c("edit.delete_button")})})}),Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",children:c("edit.save_button")})]}),!e.editServer&&Object(h.jsx)(be.a.Footer,{className:"text-right",children:Object(h.jsx)("button",{type:"submit",className:"btn btn-primary",children:c("edit.add_button")})})]})})})})};function Ue(e,t){var n=function(){if("undefined"===typeof window)return t;try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(c){return console.warn("Error reading localStorage key \u201c".concat(e,"\u201d:"),c),t}},c=Object(o.useState)(n),s=Object(b.a)(c,2),a=s[0],r=s[1];return Object(o.useEffect)((function(){r(n())}),[]),Object(o.useEffect)((function(){var e=function(){r(n())};return window.addEventListener("storage",e),window.addEventListener("local-storage",e),function(){window.removeEventListener("storage",e),window.removeEventListener("local-storage",e)}}),[]),[a,function(t){"undefined"==typeof window&&console.warn("Tried setting localStorage key \u201c".concat(e,"\u201d even though environment is not a client"));try{var n=t instanceof Function?t(a):t;window.localStorage.setItem(e,JSON.stringify(n)),r(n),window.dispatchEvent(new Event("local-storage"))}catch(c){console.warn("Error setting localStorage key \u201c".concat(e,"\u201d:"),c)}}]}var Ye=function(){var e=y(),t=Object(o.useState)("welcome"),n=Object(b.a)(t,2),c=n[0],s=n[1],a=Object(o.useState)(),r=Object(b.a)(a,2),i=r[0],l=r[1],d=Ue("servers",[]),j=Object(b.a)(d,2),p=j[0],m=j[1],f=function(){l(void 0),s("welcome")};return"edit"===c?Object(h.jsx)(Ge,{editServer:i,addAction:function(e){p.push(e),m(p),f()},updateAction:function(e){var t=p.indexOf(i);p[t]=e,m(p),console.log(p),f()},closeAction:f,deleteAction:function(){m(p.filter((function(e){return e!==i}))),f()}}):Object(h.jsx)(Be,{servers:p,openAddServer:function(){l(void 0),s("edit")},openEditAction:function(e){l(e),s("edit")},openServerAction:function(t){e.setState((function(e){return Object(u.a)(Object(u.a)({},e),{selectedServerIndex:t})}))}})},$e=function(){var e=y(),t=Ue("servers",[]),n=Object(b.a)(t,1)[0],c=null===e.state.selectedServerIndex||n.length<=e.state.selectedServerIndex?null:n[e.state.selectedServerIndex];return c?Object(h.jsx)(Ke,{server:c}):Object(h.jsx)(Ye,{})},Ke=function(e){var t=y();return Object(o.useEffect)((function(){L.Spinner.init(t),L.Spinner.show(),L.ZespConnectorPromise.then((function(n){return n.connectAsync(t,e.server)})).then((function(){return re.initAsync(t)})).then((function(){t.setState((function(e){return Object(u.a)(Object(u.a)({},e),{appInitialized:!0})})),L.Spinner.hide()})).catch((function(n){t.setState((function(e){return Object(u.a)(Object(u.a)({},e),{appInitialized:!1,selectedServerIndex:null})})),L.ZespConnector.disconnect(),L.Spinner.hide(),ie.b.error("Ooops, cannot connect to the server (".concat(e.server.address,"). ").concat(n))}))}),[]),t.state.appInitialized?Object(h.jsxs)("div",{className:"container-md d-flex w-100 h-100 p-3 mx-auto flex-column",children:[Object(h.jsxs)("header",{className:"masthead",children:[Object(h.jsx)("a",{href:"/",children:Object(h.jsx)("h3",{className:"masthead-brand",children:"ZESP:UI"})}),Object(h.jsx)(f,{})]}),Object(h.jsx)("main",{role:"main",className:"text-start d-flex flex-grow-1 flex-column",children:Object(h.jsx)(Je,{})}),Object(h.jsx)("footer",{className:"mastfoot mt-3",children:Object(h.jsxs)("p",{children:["ZESP UI application, by ",Object(h.jsx)("a",{href:"https://t.me/NickRimmer",target:"_blank",rel:"noreferrer",children:"@NickRimmer"}),". (0.0.0 version, ",Object(h.jsx)("span",{children:"dev build"}),")"]})})]}):Object(h.jsx)(o.Fragment,{})},Xe=function(){return Object(h.jsx)(j.a,{children:Object(h.jsx)(p.c,{children:Object(h.jsxs)(w,{children:[Object(h.jsx)($e,{}),Object(h.jsx)(S,{}),Object(h.jsx)(ie.a,{})]})})})},et=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,172)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),c(e),s(e),a(e),r(e)}))};d.a.render(Object(h.jsx)(i.a.StrictMode,{children:Object(h.jsx)(Xe,{})}),document.getElementById("root")),et()},69:function(e,t,n){"use strict";n.r(t);var c=n(65),s=n(45),a=["en"],r=["common","nav","pages.setup-mqtt","pages.setup-wifi","pages.welcome","pages.devices"];c.a.use(s.e).init({fallbackLng:a[0],lng:a[0],resources:function(){for(var e={},t=0,c=a;t<c.length;t++){var s=c[t];e[s]={};for(var o=0,i=r;o<i.length;o++){var l=i[o],d="./locales/".concat(s,"/").concat(l.replace(".","/"),".json");try{e[s][l]=n(126)(""+d),console.debug("".concat(d," (ok)"))}catch(u){console.debug("".concat(d," (error)"))}}}return e}(),ns:r,defaultNS:"common"}),c.a.languages=a,t.default=c.a},70:function(e,t,n){},76:function(e){e.exports=JSON.parse('{"save_button":"Save changes","saving_success":"Saving successful","saving_error":"Oops... we cannot complete it )=","saving_progress":"Saving in progress..."}')},77:function(e){e.exports=JSON.parse('{"home":"Home","devices":"Devices","setup":"Settings"}')},78:function(e){e.exports=JSON.parse('{"groups":{"hub":"Hub devices","sensors":"Sensors or monitoring systems","switches":"Switches","lights":"Lights, bulbs","other":"Other or unknown devices"}}')},79:function(e){e.exports=JSON.parse('{"topic":{"label":"Topic name","placeholder":"Enter MQTT topic name (e.g. zesp32)"},"server":{"label":"Server address","placeholder":"Enter MQTT server address (e.g. 192.168.1.1)"},"port":{"label":"Server port","placeholder":"Enter MQTT server port (e.g. 1883)"},"login":{"label":"MQTT Login","placeholder":"Enter MQTT user login (e.g. mqtt)"},"password":{"label":"MQTT Password","placeholder":"Enter MQTT user password (e.g. pa$vv0rd)"},"is_enabled":{"label":"Client is enabled"},"is_ha_enabled":{"label":"Home Assistant"}}')},80:function(e){e.exports=JSON.parse('{"ssid":{"label":"WIFI SSID","placeholder":"Enter SSID of your wifi AP (e.g. MySecretWifi)"},"pass":{"label":"WIFI Password","placeholder":"Enter your connection password (e.g. super-duper-password)"},"ip":{"label":"Local address","placeholder":"Enter static IP address and port of device with ZESP (e.g. 192.168.1.2:8082)"},"mask":{"label":"Local mask address","placeholder":"Enter device network mask (e.g. 255.255.255.0)"},"gw":{"label":"Gateway address","placeholder":"Enter gateway address (e.g. 192.168.1.1)"}}')},81:function(e){e.exports=JSON.parse('{"list":{"title":"Welcome here, stranger!","add_button":"Add a new server","add_message":"There is no servers added. Please, click this big blue button bellow to add your awesome server."},"edit":{"title":"Connection settings","delete_button":"Delete","delete_title":"Delete confirmation","delete_message":"Are you <strong>sure</strong> you want to delete it?<br/>Just asking, no pressure... if you want to continue, smash <span class=\'badge bg-danger\'>Delete</span> button bellow one more time.","save_button":"Save changes","add_button":"Add server","name_input_placeholder":"Enter display name (e.g. My hub4fun)","address_input_placeholder":"Your server address (e.g. 192.168.1.1)"}}')},91:function(e){e.exports=JSON.parse('{"1000":"Zll_Commissioning","0000":"Basic","0001":"Power_cfg","0002":"Device_Temperature_cfg","0003":"Identify","0004":"Groups","0005":"Scenes","0006":"On_Off","0007":"On_Off_Switch_cfg","0008":"Level_Control","0009":"Alarms","000A":"Time","000F":"Binary_Input","0016":"Partition","001A":"Power_Profile","001B":"En50523_Appliance_Control","0020":"Poll_Control","0021":"Green_Power","0100":"Shade_cfg","0101":"Door_Lock","0102":"Window_Covering","0200":"Pump_cfg_And_Control","0201":"Thermostat","0202":"Fan_Control","0204":"Thermostat_User_Interface_cfg","0300":"Color_Control","0400":"Illuminance_Measurement","0401":"Illuminance_Level_Sensing","0402":"Temperature_Measurement","0403":"Pressure_Measurement","0404":"Flow_Measurement","0405":"Relative_Humidity_Measurement","0406":"Occupancy_Sensing","0500":"Ias_Zone","0501":"Ias_Ace","0502":"Ias_Wd","0702":"Metering","0B00":"En50523_Appliance_Identification","0B01":"Meter_Identification","0B02":"En50523_Appliance_Events_And_Alert","0B03":"Appliance_Statistics","0B04":"Electricity_Measurement","0B05":"Diagnostics"}')},92:function(e){e.exports=JSON.parse('[{"modelIds":["ZESP_Root"],"group":"root","image":"zesp.jpg","template":"ZESP_Root.json"},{"modelIds":["lumi.sensor_switch"],"group":"switch","image":"default-sensor-switch.jpg","template":"lumi.sensor_switch.json"},{"modelIds":["lumi.sensor_motion"],"group":"sensor","image":"default-sensor-motion.jpg","template":"lumi.sensor_motion.json"},{"modelIds":["lumi.sensor_magnet"],"group":"sensor","image":"default-sensor-magnet.jpg","template":"lumi.sensor_magnet.json"}]')}},[[156,1,2]]]);
//# sourceMappingURL=main.5513973e.chunk.js.map